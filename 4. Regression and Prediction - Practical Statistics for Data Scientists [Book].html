<!DOCTYPE html>
<!-- saved from url=(0085)https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html -->
<html class=" js flexbox flexboxlegacy no-touch websqldatabase indexeddb history csscolumns csstransforms localstorage sessionstorage applicationcache svg inlinesvg zoom" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope="" itemtype="http://schema.org/Book http://schema.org/ItemPage" data-offline-url="/" data-url="/library/view/practical-statistics-for/9781491952955/ch04.html" data-archive="9781491952955" data-publishers="O&#39;Reilly Media, Inc." data-htmlfile-name="ch04.html" data-epub-title="Practical Statistics for Data Scientists" data-federated-auth-enabled="true" data-env="production" data-debug="0"><link type="text/css" id="dark-mode" rel="stylesheet" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>4. Regression and Prediction - Practical Statistics for Data Scientists [Book]</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/output.2f5d8fc1cf92.css" type="text/css">
    <link href="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/2018_font_face.css">
    

    <meta property="og:title" content="Practical Statistics for Data Scientists">
    <meta itemprop="isPartOf" content="/library/view/practical-statistics-for/9781491952955/">
    <meta itemprop="name" content="4. Regression and Prediction">
    
    <meta property="og:url" itemprop="url" content="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html">
    <meta property="og:site_name" content="O’Reilly Online Learning">
    <meta property="og:image" itemprop="thumbnailUrl" content="https://www.oreilly.com/library/cover/9781491952955/">
    
    <meta property="og:image:secure_url" itemprop="thumbnailUrl" content="https://learning.oreilly.com/library/cover/9781491952955/360h/">
    <meta property="og:description" itemprop="description" name="description" content=" Chapter 4. Regression and Prediction Perhaps the most common goal in statistics is to answer the question: Is the variable X (or more likely, X 1 , ... , X …  - Selection from Practical Statistics for Data Scientists [Book]">
    
    <meta itemprop="inLanguage" content="en">
    
    <meta itemprop="publisher" content="O&#39;Reilly Media, Inc.">
    
    <meta property="og:type" content="article">
    <meta property="og:book:isbn" itemprop="isbn" content="9781491952962">
    
    <meta property="og:book:author" itemprop="author" content="Peter Bruce">
    <meta property="og:book:author" itemprop="author" content="Andrew Bruce">
    
    
    
    
    <meta property="og:image:width" content="400">
    <meta property="og:image:height" content="400">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@OReillyMedia">

<!-- Start Visual Website Optimizer Asynchronous Code -->
<script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/cool-2.1.15.min.js.download"></script><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/ec.js.download"></script><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/munchkin.js.download"></script><script id="twitter-wjs" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/widgets.js.download"></script><script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/443792972845831" async=""></script><script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/1732687426968531" async=""></script><script async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/fbevents.js.download"></script><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/f.txt"></script><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/analytics.js.download"></script><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/bat.js.download"></script><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/f.txt"></script><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/insight.min.js.download"></script><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/f.txt"></script><script async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/gtm.js.download"></script><script type="text/javascript">
var _vwo_code=(function(){
var account_id=291788,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
/* DO NOT EDIT BELOW THIS LINE */
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
</script><script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/j.php" type="text/javascript"></script>
<!-- End Visual Website Optimizer Asynchronous Code -->

    <link class="t-canonical-link" rel="canonical" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html">

    <link rel="shortcut icon" href="https://www.oreilly.com/favicon.ico" type="image/vnd.microsoft.icon">
    <link rel="apple-touch-icon" href="https://www.oreilly.com/library/view/static/images/apple-touch-icon.png">
    

  
    <style type="text/css" title="ibis-book">
    @charset "utf-8";#sbo-rt-content html,#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content span,#sbo-rt-content applet,#sbo-rt-content object,#sbo-rt-content iframe,#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p,#sbo-rt-content blockquote,#sbo-rt-content pre,#sbo-rt-content a,#sbo-rt-content abbr,#sbo-rt-content acronym,#sbo-rt-content address,#sbo-rt-content big,#sbo-rt-content cite,#sbo-rt-content code,#sbo-rt-content del,#sbo-rt-content dfn,#sbo-rt-content em,#sbo-rt-content img,#sbo-rt-content ins,#sbo-rt-content kbd,#sbo-rt-content q,#sbo-rt-content s,#sbo-rt-content samp,#sbo-rt-content small,#sbo-rt-content strike,#sbo-rt-content strong,#sbo-rt-content sub,#sbo-rt-content sup,#sbo-rt-content tt,#sbo-rt-content var,#sbo-rt-content b,#sbo-rt-content u,#sbo-rt-content i,#sbo-rt-content center,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content ol,#sbo-rt-content ul,#sbo-rt-content li,#sbo-rt-content fieldset,#sbo-rt-content form,#sbo-rt-content label,#sbo-rt-content legend,#sbo-rt-content table,#sbo-rt-content caption,#sbo-rt-content tdiv,#sbo-rt-content tfoot,#sbo-rt-content thead,#sbo-rt-content tr,#sbo-rt-content th,#sbo-rt-content td,#sbo-rt-content article,#sbo-rt-content aside,#sbo-rt-content canvas,#sbo-rt-content details,#sbo-rt-content embed,#sbo-rt-content figure,#sbo-rt-content figcaption,#sbo-rt-content footer,#sbo-rt-content header,#sbo-rt-content hgroup,#sbo-rt-content menu,#sbo-rt-content nav,#sbo-rt-content output,#sbo-rt-content ruby,#sbo-rt-content section,#sbo-rt-content summary,#sbo-rt-content time,#sbo-rt-content mark,#sbo-rt-content audio,#sbo-rt-content video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}#sbo-rt-content article,#sbo-rt-content aside,#sbo-rt-content details,#sbo-rt-content figcaption,#sbo-rt-content figure,#sbo-rt-content footer,#sbo-rt-content header,#sbo-rt-content hgroup,#sbo-rt-content menu,#sbo-rt-content nav,#sbo-rt-content section{display:block}#sbo-rt-content div{line-height:1}#sbo-rt-content ol,#sbo-rt-content ul{list-style:none}#sbo-rt-content blockquote,#sbo-rt-content q{quotes:none}#sbo-rt-content blockquote:before,#sbo-rt-content blockquote:after,#sbo-rt-content q:before,#sbo-rt-content q:after{content:none}#sbo-rt-content table{border-collapse:collapse;border-spacing:0}@page{margin:5px !important}#sbo-rt-content p{margin:10px 0 0;line-height:125%;text-align:left}#sbo-rt-content p.byline{text-align:left;margin:-33px auto 35px;font-style:italic;font-weight:bold}#sbo-rt-content div.preface p+p.byline{margin:1em 0 0 !important}#sbo-rt-content div.preface p.byline+p.byline{margin:0 !important}#sbo-rt-content div.sect1>p.byline{margin:-.25em 0 1em}#sbo-rt-content div.sect1>p.byline+p.byline{margin-top:-1em}#sbo-rt-content em{font-style:italic;font-family:inherit}#sbo-rt-content em strong,#sbo-rt-content strong em{font-weight:bold;font-style:italic;font-family:inherit}#sbo-rt-content strong,#sbo-rt-content span.bold{font-weight:bold}#sbo-rt-content em.replaceable{font-style:italic}#sbo-rt-content strong.userinput{font-weight:bold;font-style:normal}#sbo-rt-content span.bolditalic{font-weight:bold;font-style:italic}#sbo-rt-content a.ulink,#sbo-rt-content a.xref,#sbo-rt-content a.email,#sbo-rt-content a.link,#sbo-rt-content a{text-decoration:none;color:#8e0012}#sbo-rt-content span.lineannotation{font-style:italic;color:#a62a2a;font-family:serif}#sbo-rt-content span.underline{text-decoration:underline}#sbo-rt-content span.strikethrough{text-decoration:line-through}#sbo-rt-content span.smallcaps{font-variant:small-caps}#sbo-rt-content span.cursor{background:#000;color:#fff}#sbo-rt-content span.smaller{font-size:75%}#sbo-rt-content .boxedtext,#sbo-rt-content .keycap{border-style:solid;border-width:1px;border-color:#000;padding:1px}#sbo-rt-content span.gray50{color:#7F7F7F;}#sbo-rt-content h1,#sbo-rt-content div.toc-title,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5{-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;font-weight:bold;text-align:left;page-break-after:avoid !important;font-family:sans-serif,"DejaVuSans"}#sbo-rt-content div.toc-title{font-size:1.5em;margin-top:20px !important;margin-bottom:30px !important}#sbo-rt-content section[data-type="sect1"] h1{font-size:1.3em;color:#8e0012;margin:40px 0 8px 0}#sbo-rt-content section[data-type="sect2"] h2{font-size:1.1em;margin:30px 0 8px 0 !important}#sbo-rt-content section[data-type="sect3"] h3{font-size:1em;color:#555;margin:20px 0 8px 0 !important}#sbo-rt-content section[data-type="sect4"] h4{font-size:1em;font-weight:normal;font-style:italic;margin:15px 0 6px 0 !important}#sbo-rt-content section[data-type="chapter"]>div>h1,#sbo-rt-content section[data-type="preface"]>div>h1,#sbo-rt-content section[data-type="appendix"]>div>h1,#sbo-rt-content section[data-type="glossary"]>div>h1,#sbo-rt-content section[data-type="bibliography"]>div>h1,#sbo-rt-content section[data-type="index"]>div>h1{font-size:2em;line-height:1;margin-bottom:50px;color:#000;padding-bottom:10px;border-bottom:1px solid #000}#sbo-rt-content span.label,#sbo-rt-content span.keep-together{font-size:inherit;font-weight:inherit}#sbo-rt-content div[data-type="part"] h1{font-size:2em;text-align:center;margin-top:0 !important;margin-bottom:50px;padding:50px 0 10px 0;border-bottom:1px solid #000}#sbo-rt-content img.width-ninety{width:90%}#sbo-rt-content img{max-width:95%;margin:0 auto;padding:0}#sbo-rt-content div.figure{background-color:transparent;text-align:center !important;margin:15px 0 15px 0 !important;page-break-inside:avoid}#sbo-rt-content figure{margin:15px 0 15px 0 !important;page-break-inside:avoid}#sbo-rt-content div.figure h6,#sbo-rt-content figure h6,#sbo-rt-content figure figcaption{font-size:.9rem !important;text-align:center;font-weight:normal !important;font-style:italic;font-family:serif !important;text-transform:none !important;letter-spacing:normal !important;color:#000 !important;padding-top:10px !important;page-break-before:avoid}#sbo-rt-content div.informalfigure{text-align:center !important;padding:5px 0 !important}#sbo-rt-content div.sidebar{margin:15px 0 10px 0 !important;border:1px solid #DCDCDC;background-color:#F7F7F7;padding:15px !important;page-break-inside:avoid}#sbo-rt-content aside[data-type="sidebar"]{margin:15px 0 10px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar-title,#sbo-rt-content aside[data-type="sidebar"] h5{font-weight:bold;font-size:1em;font-family:sans-serif;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar ol,#sbo-rt-content div.sidebar ul,#sbo-rt-content aside[data-type="sidebar"] ol,#sbo-rt-content aside[data-type="sidebar"] ul{margin-left:1.25em !important}#sbo-rt-content div.sidebar div.figure p.title,#sbo-rt-content aside[data-type="sidebar"] figcaption,#sbo-rt-content div.sidebar div.informalfigure div.caption{font-size:90%;text-align:center;font-weight:normal;font-style:italic;font-family:serif !important;color:#000;padding:5px !important;page-break-before:avoid;page-break-after:avoid}#sbo-rt-content div.sidebar div.tip,#sbo-rt-content div.sidebar div[data-type="tip"],#sbo-rt-content div.sidebar div.note,#sbo-rt-content div.sidebar div[data-type="note"],#sbo-rt-content div.sidebar div.warning,#sbo-rt-content div.sidebar div[data-type="warning"],#sbo-rt-content div.sidebar div[data-type="caution"],#sbo-rt-content div.sidebar div[data-type="important"]{margin:20px auto 20px auto !important;font-size:90%;width:85%}#sbo-rt-content aside[data-type="sidebar"] p.byline{font-size:90%;font-weight:bold;font-style:italic;text-align:center;text-indent:0;margin:5px auto 6px;page-break-after:avoid}#sbo-rt-content pre{white-space:pre-wrap;font-family:"Ubuntu Mono",monospace;margin:25px 0 25px 20px;font-size:85%;display:block;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;overflow-wrap:break-word}#sbo-rt-content div.note pre.programlisting,#sbo-rt-content div.tip pre.programlisting,#sbo-rt-content div.warning pre.programlisting,#sbo-rt-content div.caution pre.programlisting,#sbo-rt-content div.important pre.programlisting{margin-bottom:0}#sbo-rt-content code{font-family:"Ubuntu Mono",monospace;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;overflow-wrap:break-word}#sbo-rt-content code strong em,#sbo-rt-content code em strong,#sbo-rt-content pre em strong,#sbo-rt-content pre strong em,#sbo-rt-content strong code em code,#sbo-rt-content em code strong code,#sbo-rt-content span.bolditalic code{font-weight:bold;font-style:italic;font-family:"Ubuntu Mono BoldItal",monospace}#sbo-rt-content code em,#sbo-rt-content em code,#sbo-rt-content pre em,#sbo-rt-content em.replaceable{font-family:"Ubuntu Mono Ital",monospace;font-style:italic}#sbo-rt-content code strong,#sbo-rt-content strong code,#sbo-rt-content pre strong,#sbo-rt-content strong.userinput{font-family:"Ubuntu Mono Bold",monospace;font-weight:bold}#sbo-rt-content div[data-type="example"]{margin:10px 0 15px 0 !important}#sbo-rt-content div[data-type="example"] h1,#sbo-rt-content div[data-type="example"] h2,#sbo-rt-content div[data-type="example"] h3,#sbo-rt-content div[data-type="example"] h4,#sbo-rt-content div[data-type="example"] h5,#sbo-rt-content div[data-type="example"] h6{font-style:italic;font-weight:normal;text-align:left !important;text-transform:none !important;font-family:serif !important;margin:10px 0 5px 0 !important;border-bottom:1px solid #000}#sbo-rt-content li pre.example{padding:10px 0 !important}#sbo-rt-content div[data-type="example"] pre[data-type="programlisting"],#sbo-rt-content div[data-type="example"] pre[data-type="screen"]{margin:0}#sbo-rt-content section[data-type="titlepage"]>div>h1{font-size:2em;margin:50px 0 10px 0 !important;line-height:1;text-align:center}#sbo-rt-content section[data-type="titlepage"] h2,#sbo-rt-content section[data-type="titlepage"] p.subtitle,#sbo-rt-content section[data-type="titlepage"] p[data-type="subtitle"]{font-size:1.3em;font-weight:normal;text-align:center;margin-top:.5em;color:#555}#sbo-rt-content section[data-type="titlepage"]>div>h2[data-type="author"],#sbo-rt-content section[data-type="titlepage"] p.author{font-size:1.3em;font-family:serif !important;font-weight:bold;margin:50px 0 !important;text-align:center}#sbo-rt-content section[data-type="titlepage"] p.edition{text-align:center;text-transform:uppercase;margin-top:2em}#sbo-rt-content section[data-type="titlepage"]{text-align:center}#sbo-rt-content section[data-type="titlepage"]:after{content:url(css_assets/titlepage_footer_ebook.png);margin:0 auto;max-width:80%}#sbo-rt-content div.book div.titlepage div.publishername{margin-top:60%;margin-bottom:20px;text-align:center;font-size:1.25em}#sbo-rt-content div.book div.titlepage div.locations p{margin:0;text-align:center}#sbo-rt-content div.book div.titlepage div.locations p.cities{font-size:80%;text-align:center;margin-top:5px}#sbo-rt-content section.preface[title="Dedication"]>div.titlepage h2.title{text-align:center;text-transform:uppercase;font-size:1.5em;margin-top:50px;margin-bottom:50px}#sbo-rt-content ul.stafflist{margin:15px 0 15px 20px !important}#sbo-rt-content ul.stafflist li{list-style-type:none;padding:5px 0}#sbo-rt-content ul.printings li{list-style-type:none}#sbo-rt-content section.preface[title="Dedication"] p{font-style:italic;text-align:center}#sbo-rt-content div.colophon h1.title{font-size:1.3em;margin:0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon h2.subtitle{margin:0 !important;color:#000;font-family:serif !important;font-size:1em;font-weight:normal}#sbo-rt-content div.colophon div.author h3.author{font-size:1.1em;font-family:serif !important;margin:10px 0 0 !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h4,#sbo-rt-content div.colophon div.editor h3.editor{color:#000;font-size:.8em;margin:15px 0 0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h3.editor{font-size:.8em;margin:0 !important;font-family:serif !important;font-weight:normal}#sbo-rt-content div.colophon div.publisher{margin-top:10px}#sbo-rt-content div.colophon div.publisher p,#sbo-rt-content div.colophon div.publisher span.publishername{margin:0;font-size:.8em}#sbo-rt-content div.legalnotice p,#sbo-rt-content div.timestamp p{font-size:.8em}#sbo-rt-content div.timestamp p{margin-top:10px}#sbo-rt-content div.colophon[title="About the Author"] h1.title,#sbo-rt-content div.colophon[title="Colophon"] h1.title{font-size:1.5em;margin:0 !important;font-family:sans-serif !important}#sbo-rt-content section.chapter div.titlepage div.author{margin:10px 0 10px 0}#sbo-rt-content section.chapter div.titlepage div.author div.affiliation{font-style:italic}#sbo-rt-content div.attribution{margin:5px 0 0 50px !important}#sbo-rt-content h3.author span.orgname{display:none}#sbo-rt-content div.epigraph{margin:10px 0 10px 20px !important;page-break-inside:avoid;font-size:90%}#sbo-rt-content div.epigraph p{font-style:italic}#sbo-rt-content blockquote,#sbo-rt-content div.blockquote{margin:10px !important;page-break-inside:avoid;font-size:95%}#sbo-rt-content blockquote p,#sbo-rt-content div.blockquote p{font-style:italic;margin:.75em 0 0 !important}#sbo-rt-content blockquote div.attribution,#sbo-rt-content blockquote p[data-type="attribution"]{margin:5px 0 10px 30px !important;text-align:right;width:80%}#sbo-rt-content blockquote div.attribution p,#sbo-rt-content blockquote p[data-type="attribution"]{font-style:normal;margin-top:5px}#sbo-rt-content blockquote div.attribution p:before,#sbo-rt-content blockquote p[data-type="attribution"]:before{font-style:normal;content:"—";-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none}#sbo-rt-content p.right{text-align:right;margin:0}#sbo-rt-content div[data-type="footnotes"]{border-top:1px solid black;margin-top:2em}#sbo-rt-content sub,#sbo-rt-content sup{font-size:75%;line-height:0;position:relative}#sbo-rt-content sup{top:-.5em}#sbo-rt-content sub{bottom:-.25em}#sbo-rt-content p[data-type="footnote"]{font-size:90% !important;line-height:1.2em !important;margin-left:2.5em !important;text-indent:-2.3em !important}#sbo-rt-content p[data-type="footnote"] sup{display:inline-block !important;position:static !important;width:2em !important;text-align:right !important;font-size:100% !important;padding-right:.5em !important}#sbo-rt-content p[data-type="footnote"] a[href$="-marker"]{font-family:sans-serif !important;font-size:90% !important;color:#8e0012 !important}#sbo-rt-content p[data-type="footnote"] a[data-type="xref"]{margin:0 !important;padding:0 !important;text-indent:0 !important}#sbo-rt-content a[data-type="noteref"]{font-family:sans-serif !important;color:#8e0012;margin-left:0;padding-left:0}#sbo-rt-content div.refentry p.refname{font-size:1em;font-family:sans-serif,"DejaVuSans";font-weight:bold;margin-bottom:5px;overflow:auto;width:100%}#sbo-rt-content div.refentry{width:100%;display:block;margin-top:2em}#sbo-rt-content div.refsynopsisdiv{display:block;clear:both}#sbo-rt-content div.refentry header{page-break-inside:avoid !important;display:block;break-inside:avoid !important;padding-top:0;border-bottom:1px solid #000}#sbo-rt-content div.refsect1 h6{font-size:.9em;font-family:sans-serif,"DejaVuSans";font-weight:bold}#sbo-rt-content div.refsect1{margin-top:3em}#sbo-rt-content dt{padding-top:10px !important;padding-bottom:0 !important}#sbo-rt-content dd{margin-left:1.5em !important;margin-bottom:.25em}#sbo-rt-content dd ol,#sbo-rt-content dd ul{padding-left:1em}#sbo-rt-content dd li{margin-top:0;margin-bottom:0}#sbo-rt-content dd,#sbo-rt-content li{text-align:left}#sbo-rt-content ul,#sbo-rt-content ul>li,#sbo-rt-content ol ul,#sbo-rt-content ol ul>li,#sbo-rt-content ul ol ul,#sbo-rt-content ul ol ul>li{list-style-type:disc}#sbo-rt-content ul ul,#sbo-rt-content ul ul>li{list-style-type:square}#sbo-rt-content ul ul ul,#sbo-rt-content ul ul ul>li{list-style-type:circle}#sbo-rt-content ol,#sbo-rt-content ol>li,#sbo-rt-content ol ul ol,#sbo-rt-content ol ul ol>li,#sbo-rt-content ul ol,#sbo-rt-content ul ol>li{list-style-type:decimal}#sbo-rt-content ol ol,#sbo-rt-content ol ol>li{list-style-type:lower-alpha}#sbo-rt-content ol ol ol,#sbo-rt-content ol ol ol>li{list-style-type:lower-roman}#sbo-rt-content ol,#sbo-rt-content ul{list-style-position:outside;margin:15px 0 15px 1.25em;padding-left:2.25em}#sbo-rt-content ol li,#sbo-rt-content ul li{margin:.5em 0 .65em;line-height:125%}#sbo-rt-content div.orderedlistalpha{list-style-type:upper-alpha}#sbo-rt-content table.simplelist,#sbo-rt-content ul.simplelist{margin:15px 0 15px 20px !important}#sbo-rt-content ul.simplelist li{list-style-type:none;padding:5px 0}#sbo-rt-content table.simplelist td{border:none}#sbo-rt-content table.simplelist tr{border-bottom:none}#sbo-rt-content table.simplelist tr:nth-of-type(even){background-color:transparent}#sbo-rt-content dl.calloutlist p:first-child{margin-top:-25px !important}#sbo-rt-content dl.calloutlist dd{padding-left:0;margin-top:-25px}#sbo-rt-content dl.calloutlist img,#sbo-rt-content a.co img{padding:0}#sbo-rt-content div.toc ol{margin-top:8px !important;margin-bottom:8px !important;margin-left:0 !important;padding-left:0 !important}#sbo-rt-content div.toc ol ol{margin-left:30px !important;padding-left:0 !important}#sbo-rt-content div.toc ol li{list-style-type:none}#sbo-rt-content div.toc a{color:#8e0012}#sbo-rt-content div.toc ol a{font-size:1em;font-weight:bold}#sbo-rt-content div.toc ol>li>ol a{font-weight:bold;font-size:1em}#sbo-rt-content div.toc ol>li>ol>li>ol a{text-decoration:none;font-weight:normal;font-size:1em}#sbo-rt-content div.tip,#sbo-rt-content div[data-type="tip"],#sbo-rt-content div.note,#sbo-rt-content div[data-type="note"],#sbo-rt-content div.warning,#sbo-rt-content div[data-type="warning"],#sbo-rt-content div[data-type="caution"],#sbo-rt-content div[data-type="important"]{margin:30px !important;font-size:90%;padding:10px 8px 20px 8px !important;page-break-inside:avoid}#sbo-rt-content div.tip ol,#sbo-rt-content div.tip ul,#sbo-rt-content div[data-type="tip"] ol,#sbo-rt-content div[data-type="tip"] ul,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul,#sbo-rt-content div[data-type="note"] ol,#sbo-rt-content div[data-type="note"] ul,#sbo-rt-content div.warning ol,#sbo-rt-content div.warning ul,#sbo-rt-content div[data-type="warning"] ol,#sbo-rt-content div[data-type="warning"] ul,#sbo-rt-content div[data-type="caution"] ol,#sbo-rt-content div[data-type="caution"] ul,#sbo-rt-content div[data-type="important"] ol,#sbo-rt-content div[data-type="important"] ul{margin-left:1.5em !important}#sbo-rt-content div.tip,#sbo-rt-content div[data-type="tip"],#sbo-rt-content div.note,#sbo-rt-content div[data-type="note"]{border:1px solid #BEBEBE;background-color:transparent}#sbo-rt-content div.warning,#sbo-rt-content div[data-type="warning"],#sbo-rt-content div[data-type="caution"],#sbo-rt-content div[data-type="important"]{border:1px solid #BC8F8F}#sbo-rt-content div.tip h3,#sbo-rt-content div[data-type="tip"] h6,#sbo-rt-content div[data-type="tip"] h1,#sbo-rt-content div.note h3,#sbo-rt-content div[data-type="note"] h6,#sbo-rt-content div[data-type="note"] h1,#sbo-rt-content div.warning h3,#sbo-rt-content div[data-type="warning"] h6,#sbo-rt-content div[data-type="warning"] h1,#sbo-rt-content div[data-type="caution"] h6,#sbo-rt-content div[data-type="caution"] h1,#sbo-rt-content div[data-type="important"] h1,#sbo-rt-content div[data-type="important"] h6{font-weight:bold;font-size:110%;font-family:sans-serif !important;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px !important}#sbo-rt-content div[data-type="tip"] figure h6,#sbo-rt-content div[data-type="note"] figure h6,#sbo-rt-content div[data-type="warning"] figure h6,#sbo-rt-content div[data-type="caution"] figure h6,#sbo-rt-content div[data-type="important"] figure h6{font-family:serif !important}#sbo-rt-content div.tip h3,#sbo-rt-content div[data-type="tip"] h6,#sbo-rt-content div.note h3,#sbo-rt-content div[data-type="note"] h6,#sbo-rt-content div[data-type="tip"] h1,#sbo-rt-content div[data-type="note"] h1{color:#737373}#sbo-rt-content div.warning h3,#sbo-rt-content div[data-type="warning"] h6,#sbo-rt-content div[data-type="caution"] h6,#sbo-rt-content div[data-type="important"] h6,#sbo-rt-content div[data-type="warning"] h1,#sbo-rt-content div[data-type="caution"] h1,#sbo-rt-content div[data-type="important"] h1{color:#C67171}#sbo-rt-content div.sect1[title="Safari® Books Online"] div.note,#sbo-rt-content div.safarienabled{background-color:transparent;margin:8px 0 0 !important;border:0 solid #BEBEBE;font-size:100%;padding:0 !important;page-break-inside:avoid}#sbo-rt-content div.sect1[title="Safari® Books Online"] div.note h3,#sbo-rt-content div.safarienabled h6{display:none}#sbo-rt-content div.table,#sbo-rt-content table{margin:15px 0 30px 0 !important;max-width:95%;border:none !important;background:none;display:table !important}#sbo-rt-content div.table,#sbo-rt-content div.informaltable,#sbo-rt-content table{page-break-inside:avoid}#sbo-rt-content tr,#sbo-rt-content tr td{border-bottom:1px solid #c3c3c3}#sbo-rt-content thead td,#sbo-rt-content thead th{border-bottom:#9d9d9d 1px solid !important;border-top:#9d9d9d 1px solid !important}#sbo-rt-content tr:nth-of-type(even){background-color:#f1f6fc}#sbo-rt-content thead{font-family:sans-serif;font-weight:bold}#sbo-rt-content td,#sbo-rt-content th{display:table-cell;padding:.3em;text-align:left;vertical-align:middle;font-size:80%}#sbo-rt-content div.informaltable table{margin:10px auto !important}#sbo-rt-content div.informaltable table tr{border-bottom:none}#sbo-rt-content div.informaltable table tr:nth-of-type(even){background-color:transparent}#sbo-rt-content div.informaltable td,#sbo-rt-content div.informaltable th{border:#9d9d9d 1px solid}#sbo-rt-content div.table-title,#sbo-rt-content table caption{font-weight:normal;font-style:italic;font-family:serif;font-size:1em;margin:10px 0 10px 0 !important;padding:0;page-break-after:avoid;text-align:left !important}#sbo-rt-content table code{font-size:smaller}#sbo-rt-content table.border tbody>tr:last-child>td{border-bottom:transparent}#sbo-rt-content div.equation,#sbo-rt-content div[data-type="equation"]{margin:10px 0 15px 0 !important}#sbo-rt-content div.equation-title,#sbo-rt-content div[data-type="equation"] h5{font-style:italic;font-weight:normal;font-family:serif !important;font-size:90%;margin:20px 0 10px 0 !important;page-break-after:avoid}#sbo-rt-content div.equation-contents{margin-left:20px}#sbo-rt-content div[data-type="equation"] math{font-size:calc(.35em + 1vw)}#sbo-rt-content span.inlinemediaobject{height:.85em;display:inline-block;margin-bottom:.2em}#sbo-rt-content span.inlinemediaobject img{margin:0;height:.85em}#sbo-rt-content div.informalequation{margin:20px 0 20px 20px;width:75%}#sbo-rt-content div.informalequation img{width:75%}#sbo-rt-content div.index{text-indent:0}#sbo-rt-content div.index h3{padding:.25em;margin-top:1em !important;background-color:#F0F0F0}#sbo-rt-content div.index li{line-height:130%;list-style-type:none}#sbo-rt-content div.index a.indexterm{color:#8e0012 !important}#sbo-rt-content div.index ul{margin-left:0 !important;padding-left:0 !important}#sbo-rt-content div.index ul ul{margin-left:1em !important;margin-top:0 !important}#sbo-rt-content code.boolean,#sbo-rt-content .navy{color:rgb(0,0,128);}#sbo-rt-content code.character,#sbo-rt-content .olive{color:rgb(128,128,0);}#sbo-rt-content code.comment,#sbo-rt-content .blue{color:rgb(0,0,255);}#sbo-rt-content code.conditional,#sbo-rt-content .limegreen{color:rgb(50,205,50);}#sbo-rt-content code.constant,#sbo-rt-content .darkorange{color:rgb(255,140,0);}#sbo-rt-content code.debug,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.define,#sbo-rt-content .darkgoldenrod,#sbo-rt-content .gold{color:rgb(184,134,11);}#sbo-rt-content code.delimiter,#sbo-rt-content .dimgray{color:rgb(105,105,105);}#sbo-rt-content code.error,#sbo-rt-content .red{color:rgb(255,0,0);}#sbo-rt-content code.exception,#sbo-rt-content .salmon{color:rgb(250,128,11);}#sbo-rt-content code.float,#sbo-rt-content .steelblue{color:rgb(70,130,180);}#sbo-rt-content pre code.function,#sbo-rt-content .green{color:rgb(0,128,0);}#sbo-rt-content code.identifier,#sbo-rt-content .royalblue{color:rgb(65,105,225);}#sbo-rt-content code.ignore,#sbo-rt-content .gray{color:rgb(128,128,128);}#sbo-rt-content code.include,#sbo-rt-content .purple{color:rgb(128,0,128);}#sbo-rt-content code.keyword,#sbo-rt-content .sienna{color:rgb(160,82,45);}#sbo-rt-content code.label,#sbo-rt-content .deeppink{color:rgb(255,20,147);}#sbo-rt-content code.macro,#sbo-rt-content .orangered{color:rgb(255,69,0);}#sbo-rt-content code.number,#sbo-rt-content .brown{color:rgb(165,42,42);}#sbo-rt-content code.operator,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.preCondit,#sbo-rt-content .teal{color:rgb(0,128,128);}#sbo-rt-content code.preProc,#sbo-rt-content .fuschia{color:rgb(255,0,255);}#sbo-rt-content code.repeat,#sbo-rt-content .indigo{color:rgb(75,0,130);}#sbo-rt-content code.special,#sbo-rt-content .saddlebrown{color:rgb(139,69,19);}#sbo-rt-content code.specialchar,#sbo-rt-content .magenta{color:rgb(255,0,255);}#sbo-rt-content code.specialcomment,#sbo-rt-content .seagreen{color:rgb(46,139,87);}#sbo-rt-content code.statement,#sbo-rt-content .forestgreen{color:rgb(34,139,34);}#sbo-rt-content code.storageclass,#sbo-rt-content .plum{color:rgb(221,160,221);}#sbo-rt-content code.string,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.structure,#sbo-rt-content .chocolate{color:rgb(210,106,30);}#sbo-rt-content code.tag,#sbo-rt-content .darkcyan{color:rgb(0,139,139);}#sbo-rt-content code.todo,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.type,#sbo-rt-content .mediumslateblue{color:rgb(123,104,238);}#sbo-rt-content code.typedef,#sbo-rt-content .darkgreen{color:rgb(0,100,0);}#sbo-rt-content code.underlined{text-decoration:underline;}#sbo-rt-content pre code.hll{background-color:#ffc}#sbo-rt-content pre code.c{color:#09F;font-style:italic}#sbo-rt-content pre code.err{color:#A00}#sbo-rt-content pre code.k{color:#069;font-weight:bold}#sbo-rt-content pre code.o{color:#555}#sbo-rt-content pre code.cm{color:#35586C;font-style:italic}#sbo-rt-content pre code.cp{color:#099}#sbo-rt-content pre code.c1{color:#35586C;font-style:italic}#sbo-rt-content pre code.cs{color:#35586C;font-weight:bold;font-style:italic}#sbo-rt-content pre code.gd{background-color:#FCC}#sbo-rt-content pre code.ge{font-style:italic}#sbo-rt-content pre code.gr{color:#F00}#sbo-rt-content pre code.gh{color:#030;font-weight:bold}#sbo-rt-content pre code.gi{background-color:#CFC}#sbo-rt-content pre code.go{color:#000}#sbo-rt-content pre code.gp{color:#009;font-weight:bold}#sbo-rt-content pre code.gs{font-weight:bold}#sbo-rt-content pre code.gu{color:#030;font-weight:bold}#sbo-rt-content pre code.gt{color:#9C6}#sbo-rt-content pre code.kc{color:#069;font-weight:bold}#sbo-rt-content pre code.kd{color:#069;font-weight:bold}#sbo-rt-content pre code.kn{color:#069;font-weight:bold}#sbo-rt-content pre code.kp{color:#069}#sbo-rt-content pre code.kr{color:#069;font-weight:bold}#sbo-rt-content pre code.kt{color:#078;font-weight:bold}#sbo-rt-content pre code.m{color:#F60}#sbo-rt-content pre code.s{color:#C30}#sbo-rt-content pre code.na{color:#309}#sbo-rt-content pre code.nb{color:#366}#sbo-rt-content pre code.nc{color:#0A8;font-weight:bold}#sbo-rt-content pre code.no{color:#360}#sbo-rt-content pre code.nd{color:#99F}#sbo-rt-content pre code.ni{color:#999;font-weight:bold}#sbo-rt-content pre code.ne{color:#C00;font-weight:bold}#sbo-rt-content pre code.nf{color:#C0F}#sbo-rt-content pre code.nl{color:#99F}#sbo-rt-content pre code.nn{color:#0CF;font-weight:bold}#sbo-rt-content pre code.nt{color:#309;font-weight:bold}#sbo-rt-content pre code.nv{color:#033}#sbo-rt-content pre code.ow{color:#000;font-weight:bold}#sbo-rt-content pre code.w{color:#bbb}#sbo-rt-content pre code.mf{color:#F60}#sbo-rt-content pre code.mh{color:#F60}#sbo-rt-content pre code.mi{color:#F60}#sbo-rt-content pre code.mo{color:#F60}#sbo-rt-content pre code.sb{color:#C30}#sbo-rt-content pre code.sc{color:#C30}#sbo-rt-content pre code.sd{color:#C30;font-style:italic}#sbo-rt-content pre code.s2{color:#C30}#sbo-rt-content pre code.se{color:#C30;font-weight:bold}#sbo-rt-content pre code.sh{color:#C30}#sbo-rt-content pre code.si{color:#A00}#sbo-rt-content pre code.sx{color:#C30}#sbo-rt-content pre code.sr{color:#3AA}#sbo-rt-content pre code.s1{color:#C30}#sbo-rt-content pre code.ss{color:#A60}#sbo-rt-content pre code.bp{color:#366}#sbo-rt-content pre code.vc{color:#033}#sbo-rt-content pre code.vg{color:#033}#sbo-rt-content pre code.vi{color:#033}#sbo-rt-content pre code.il{color:#F60}#sbo-rt-content pre code.g{color:#050}#sbo-rt-content pre code.l{color:#C60}#sbo-rt-content pre code.l{color:#F90}#sbo-rt-content pre code.n{color:#008}#sbo-rt-content pre code.nx{color:#008}#sbo-rt-content pre code.py{color:#96F}#sbo-rt-content pre code.p{color:#000}#sbo-rt-content pre code.x{color:#F06}#sbo-rt-content div.blockquote_sampler_toc{width:95%;margin:5px 5px 5px 10px !important}#sbo-rt-content div{font-family:serif;text-align:left}#sbo-rt-content .gray-background,#sbo-rt-content .reverse-video{background:#2E2E2E;color:#FFF}#sbo-rt-content .light-gray-background{background:#A0A0A0}#sbo-rt-content .preserve-whitespace{white-space:pre-wrap}#sbo-rt-content span.gray{color:#4C4C4C}#sbo-rt-content .width-10{width:10vw !important}#sbo-rt-content .width-20{width:20vw !important}#sbo-rt-content .width-30{width:30vw !important}#sbo-rt-content .width-40{width:40vw !important}#sbo-rt-content .width-50{width:50vw !important}#sbo-rt-content .width-60{width:60vw !important}#sbo-rt-content .width-70{width:70vw !important}#sbo-rt-content .width-80{width:80vw !important}#sbo-rt-content .width-90{width:90vw !important}#sbo-rt-content .width-full,#sbo-rt-content .width-100{width:100vw !important}
    </style><script async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/MathJax.js.download"></script>
  




<script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/munchkin.js(1).download"></script><script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/f(1).txt"></script><script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/f(2).txt"></script><script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/f(3).txt"></script><style type="text/css" id="kampyleStyle">.noOutline{outline: none !important;}.wcagOutline:focus{outline: 1px dashed #595959 !important;outline-offset: 2px !important;transition: none !important;}</style></head><style type="text/css" id="dark-mode-custom-color">
		:root{
			--bg-color:rgba(26,26,26,1);
			--text-color:rgba(110,110,110,1);
			--a-color:rgba(90,120,120,1);
			--a-visited-color:rgba(120,120,90,1);
			--a-hover-color:rgba(211,211,211,1);
			--input-border-color:rgba(211,211,211,0.2);
			--input-placeholder-color:rgba(173,216,230,1);
			--dialog-bg-color:rgba(36,36,36,0.95);
			--bg-image:linear-gradient(rgba(26,26,26,1),rgba(26,26,26,1));
		}
	</style>
<body class="js-preview-content library">


<div class="skipToMain" id="skipToMain"><a href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#maincontent"><span class="skipToMain-text">Skip to main content</span></a></div>
<header role="banner" class="global">
  <div class="global-nav">
    <div class="content">
      <nav role="navigation" aria-label="site sections">
        <a href="https://www.oreilly.com/" class="logo" title="home page" aria-current="page"><img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/oreilly_logo_mark_red.svg" onerror="this.src=&#39;https://cdn.oreillystatic.com/images/sitewide-headers/oreilly_logo_mark_red_@2x.png&#39;; this.onerror=null;" alt="O&#39;Reilly home"></a>

        <button id="mobileNavButton" class="mobileNavButton mobileNavButton--collapse mobileNavButton--3dx" type="button" aria-expanded="false" aria-controls="menuList">
          <span class="mobileNavButton-box">
            <span class="mobileNavButton-inner"></span>
          </span>
        </button>


        <ul id="menuList" class="menuList mobileHidden ">
          <li class="menuList-itemsP1">
            <ul>
              
  <li class="menuList-item menuList-signIn"><a class="t-sign-in" href="https://learning.oreilly.com/accounts/login/?next=/library/view/practical-statistics-for/9781491952955/ch04.html" onmousedown="dataLayer.push({&#39;event&#39;: &#39;eventTracker&#39;, &#39;eventCat&#39;: &#39;Outbound Links&#39;, &#39;eventAct&#39;:&#39;Oreilly&#39;, &#39;eventLbl&#39;: &#39;learning.oreilly.com/accounts/login/?next=/library/view/practical-statistics-for/9781491952955/ch04.html&#39;, &#39;eventVal&#39;: 0, &#39;nonInteraction&#39;: 0});">Sign In</a></li>


              <li class="menuList-item menuList-tryNow"><a class="menuList-cta" href="https://learning.oreilly.com/register/" onmousedown="dataLayer.push({&#39;event&#39;: &#39;eventTracker&#39;, &#39;eventCat&#39;: &#39;Outbound Links&#39;, &#39;eventAct&#39;:&#39;Oreilly&#39;, &#39;eventLbl&#39;: &#39;learning.oreilly.com/register/&#39;, &#39;eventVal&#39;: 0, &#39;nonInteraction&#39;: 0});">Try Now</a></li>
            </ul>
          </li>
          <li class="menuList-itemsP2">
            <ul>
              <li class="menuList-item menuList-itemWithSub"><a href="https://www.oreilly.com/online-learning/index.html">Online Learning</a>
                <ul class="menuList-subList">
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/individuals.html">Individuals</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/teams.html">Teams</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/enterprise.html">Enterprise</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/government.html">Government</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/academic.html">Academic</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/features.html">Features</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/custom-services.html">Custom Services</a></li>
                  <li class="menuList-subItem"><a href="https://www.oreilly.com/online-learning/pricing.html">Pricing</a></li>
                </ul>
              </li>

              <li class="menuList-item"><a href="https://www.oreilly.com/whats-new.html">What’s New</a></li>
            </ul>
          </li>
        </ul>
      </nav>
    </div>
  </div>


  <div class="global-search">
    <div class="content">
      <form id="js-search-form" class="t-navigation-form" action="https://learning.oreilly.com/search/">
        
        <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "WebSite",
          "url": "https://learning.oreilly.com",
          "potentialAction": {
            "@type": "SearchAction",
            "target": "https://learning.oreilly.com/search/?q={search_term_string}",
            "query-input": "required name=search_term_string"
          }
        }
        </script>
        <input data-search-text-focus="See everything available through O’Reilly online learning and start a free trial. Explore now." data-search-text-idle="See everything available through O’Reilly online learning and start a free trial. Explore now." id="search" type="search" name="query" placeholder="See everything available through O’Reilly online learning and start a free trial. Explore now." autocomplete="off" required="">
        <input type="submit" value="Search" class="search-submit" autocomplete="off">
      <div class="autocomplete-suggestions" style="position: absolute; display: none; z-index: 9999;"></div><div class="autocomplete-suggestions" style="position: absolute; display: none; z-index: 9999;"></div></form>
    </div>
  </div>
</header>

    
    
        <div class="sbo-menu-top">
           
            <section class="sbo-toc-container">
                <a href="https://learning.oreilly.com/library/view/practical-statistics-for/9781491952955/" class="sbo-toc-thumb" onmousedown="dataLayer.push({&#39;event&#39;: &#39;eventTracker&#39;, &#39;eventCat&#39;: &#39;Outbound Links&#39;, &#39;eventAct&#39;:&#39;Oreilly&#39;, &#39;eventLbl&#39;: &#39;learning.oreilly.com/library/view/practical-statistics-for/9781491952955/&#39;, &#39;eventVal&#39;: 0, &#39;nonInteraction&#39;: 0});">
                    <span class="sbo-title ss-list">
                        
                            <h1 class="t-title">Practical Statistics for Data Scientists by Peter Bruce, Andrew Bruce</h1>
                        
                    </span>
                </a>
            </section>
             
        </div>
    





<section id="trial-overlay">
  <div class="trial-overlay-content">
    <p>Get <em>Practical Statistics for Data Scientists</em> now with O’Reilly <span class="nowrap">online learning.</span></p>

    <p>O’Reilly members experience live online training, plus books, videos, and digital content from <span class="nowrap">200+ publishers.</span></p>

    <div class="controls">
      <a href="https://learning.oreilly.com/register/" class="button-primary" data-ga-label="Bottom CTA" onmousedown="dataLayer.push({&#39;event&#39;: &#39;eventTracker&#39;, &#39;eventCat&#39;: &#39;Outbound Links&#39;, &#39;eventAct&#39;:&#39;Oreilly&#39;, &#39;eventLbl&#39;: &#39;learning.oreilly.com/register/&#39;, &#39;eventVal&#39;: 0, &#39;nonInteraction&#39;: 0});">Start your free trial</a>
    </div>
    <a class="modal-dismiss" aria-label="modal dismiss"></a>
  </div>
</section>

<main role="main" id="maincontent">
  <div role="document" class="document">
  	
<section id="sbo-reader">
    
    

<div class="sbo-reader-content sbo-sample-reader ">
    
    <div id="sbo-rt-content" class="sbo-rt-content">
    <div id="test-content-id"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 4. Regression and Prediction"><div class="chapter" id="Regression">
<h1><span class="label">Chapter 4. </span>Regression and Prediction</h1>


<p>Perhaps the most common goal in statistics is to answer the question:
Is the variable <em>X</em> (or more likely, <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mrow>
    <msub><mi>X</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <msub><mi>X</mi> <mi>p</mi> </msub>
  </mrow>
</math>) associated with a variable <em>Y</em>, and, if so, what is the relationship and can we use it to predict <em>Y</em>?<a data-type="indexterm" data-primary="regression" id="ix_regr"></a></p>

<p>Nowhere is the nexus between statistics and data science stronger than in the realm of prediction—specifically the prediction of an outcome (target) variable based on the values of other “predictor” variables.
Another important connection is in the area of <em>anomaly detection</em>, where regression diagnostics originally intended for data analysis and improving the regression model can be used to detect unusual records.<a data-type="indexterm" data-primary="anomaly detection" id="idm45909264525432"></a>
The antecedents of correlation and linear regression date back over a century.</p>






<section data-type="sect1" data-pdf-bookmark="Simple Linear Regression"><div class="sect1" id="idm45909264524472">
<h1>Simple Linear Regression</h1>

<p id="SimpleLinearRegression">Simple linear regression models the relationship between the magnitude of one variable and that of a second—for example, as <em>X</em> increases, <em>Y</em> also increases.<a data-type="indexterm" data-primary="linear regression" id="ix_linregr"></a><a data-type="indexterm" data-primary="regression" data-secondary="simple linear regression" id="ix_regrsimlin"></a>
Or as <em>X</em> increases, <em>Y</em> decreases.<sup><a data-type="noteref" id="idm45909264518120-marker" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909264518120">1</a></sup>
Correlation is another way to measure how two variables are related: see the section <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch01.html#Correlations">“Correlation”</a>.<a data-type="indexterm" data-primary="correlation" data-secondary="regression vs." id="idm45909264516472"></a>
The difference is that while correlation measures the strength of an association between two variables,
regression quantifies the nature of the relationship.</p>
<aside data-type="sidebar" epub:type="sidebar" class="pagebreak-before"><div class="sidebar" id="idm45909264515192">
<h5>Key Terms for Simple Linear Regression</h5><dl>
<dt class="horizontal"><strong><em>Response</em></strong></dt>
<dd>
<p>The variable we are trying to predict.<a data-type="indexterm" data-primary="response" id="idm45909264511896"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>dependent variable, Y-variable, target, outcome</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Independent variable</em></strong></dt>
<dd>
<p>The variable used to predict the response.<a data-type="indexterm" data-primary="independent variables" id="idm45909264507464"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>X-variable, feature, attribute</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Record</em></strong></dt>
<dd>
<p>The vector of predictor and outcome values for a specific individual or case.<a data-type="indexterm" data-primary="records" id="idm45909264503144"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>row, case, instance, example</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Intercept</em></strong></dt>
<dd>
<p>The intercept of the regression line—that is,<a data-type="indexterm" data-primary="intercepts" id="idm45909264498664"></a> the predicted value when <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mrow>
    <mi>X</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
</math>.</p>
<dl>
<dt>Synonyms</dt>
<dd>
<p><math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>b</mi> <mn>0</mn> </msub>
</math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>β</mi> <mn>0</mn> </msub>
</math></p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Regression coefficient</em></strong></dt>
<dd>
<p>The slope of the regression line.<a data-type="indexterm" data-primary="regression coefficient" id="idm45909264488328"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>slope, <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>b</mi> <mn>1</mn> </msub>
</math>, <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>β</mi> <mn>1</mn> </msub>
</math>, parameter estimates, weights<a data-type="indexterm" data-primary="weights" id="idm45909264482616"></a><a data-type="indexterm" data-primary="slope" data-seealso="regression coefficient" id="idm45909264481912"></a></p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Fitted values</em></strong></dt>
<dd>
<p>The estimates <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>Y</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
</math> obtained from the regression line.<a data-type="indexterm" data-primary="fitted values" id="idm45909264476264"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>predicted values</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Residuals</em></strong></dt>
<dd>
<p>The difference between the observed values and the fitted values.<a data-type="indexterm" data-primary="residuals" id="idm45909264471960"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>errors</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Least squares</em></strong></dt>
<dd>
<p>The method of fitting a regression by minimizing the sum of squared residuals.<a data-type="indexterm" data-primary="least squares" id="idm45909264467656"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>ordinary least squares</p>
</dd>
</dl>
</dd>
</dl>
</div></aside>








<section data-type="sect2" data-pdf-bookmark="The Regression Equation"><div class="sect2" id="idm45909264464968">
<h2>The Regression Equation</h2>

<p>Simple linear regression estimates exactly how much <em>Y</em> will change when <em>X</em> changes by a certain amount.<a data-type="indexterm" data-primary="linear regression" data-secondary="regression equation" id="idm45909264462120"></a><a data-type="indexterm" data-primary="regression" data-secondary="simple linear regression" data-tertiary="regression equation" id="idm45909264461144"></a>
With the correlation coefficient, the variables <em>X</em> and <em>Y</em> are interchangeable.
With regression, we are trying to predict the <em>Y</em> variable from <em>X</em> using a linear relationship (i.e., a line):</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" alttext="upper Y equals b 0 plus b 1 upper X">
  <mrow>
    <mi>Y</mi>
    <mo>=</mo>
    <msub><mi>b</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mi>b</mi> <mn>1</mn> </msub>
    <mi>X</mi>
  </mrow>
</math>
</div>

<p>We read this as “Y equals b<sub>1</sub> times X, plus a constant b<sub>0</sub>.”
The symbol <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>b</mi> <mn>0</mn> </msub>
</math> is known as the <em>intercept</em> (or constant), and the symbol  <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>b</mi> <mn>1</mn> </msub>
</math> as the <em>slope</em> for <em>X</em>.  Both appear in R output as <em>coefficients</em>, though in general use the term <em>coefficient</em> is often reserved for <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>b</mi> <mn>1</mn> </msub>
</math>.<a data-type="indexterm" data-primary="coefficients" data-secondary="in simple linear regression" id="idm45909264442072"></a><a data-type="indexterm" data-primary="slope" data-secondary="in regression equation" id="idm45909264441000"></a>
The <em>Y</em> variable is known as the <em>response</em> or <em>dependent</em> variable since it depends on <em>X</em>.<a data-type="indexterm" data-primary="response" id="idm45909264438184"></a><a data-type="indexterm" data-primary="dependent variable" data-seealso="response" id="idm45909264437448"></a>
The <em>X</em> variable is known as the <em>predictor</em> or <em>independent</em> variable.
The machine learning community tends to use other terms,
calling <em>Y</em> the <em>target</em> and <em>X</em> a <em>feature</em> vector.<a data-type="indexterm" data-primary="independent variables" id="idm45909264433288"></a><a data-type="indexterm" data-primary="predictor variables" data-seealso="independent variables" id="idm45909264432552"></a></p>

<p>Consider the scatterplot in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#cotton">Figure&nbsp;4-1</a> displaying the number of years a worker was exposed to cotton dust (<code>Exposure</code>) versus a measure
of lung capacity (<code>PEFR</code> or “peak expiratory flow rate”).
How is <code>PEFR</code> related to <code>Exposure</code>?
It’s hard to tell just based on the picture.</p>

<figure class="width-50"><div id="cotton" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0401.png" alt="images/lung_scatter.png" width="1178" height="1188">
<h6><span class="label">Figure 4-1. </span>Cotton exposure versus lung capacity</h6>
</div></figure>

<p>Simple linear regression tries to find the “best” line to predict the response <code>PEFR</code> as a function of the predictor variable <code>Exposure</code>.</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" alttext="PEFR equals b 0 plus b 1 Exposure">
  <mrow>
    <mtext>PEFR</mtext>
    <mo>=</mo>
    <msub><mi>b</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mi>b</mi> <mn>1</mn> </msub>
    <mtext>Exposure</mtext>
  </mrow>
</math>
</div>

<p>The <code>lm</code> function in R can be used to fit a linear regression.</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">model</code> <code class="o">&lt;-</code> <code class="nf">lm</code><code class="p">(</code><code class="n">PEFR</code> <code class="o">~</code> <code class="n">Exposure</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">lung</code><code class="p">)</code></pre>

<p><code>lm</code> stands for <em>linear model</em> and the <code>~</code> symbol denotes that <code>PEFR</code> is predicted by <code>Exposure</code>.</p>

<p>Printing the <code>model</code> object produces the following output:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">Call</code><code class="o">:</code>
<code class="nf">lm</code><code class="p">(</code><code class="n">formula</code> <code class="o">=</code> <code class="n">PEFR</code> <code class="o">~</code> <code class="n">Exposure</code><code class="p">,</code> <code class="n">data</code> <code class="o">=</code> <code class="n">lung</code><code class="p">)</code>

<code class="n">Coefficients</code><code class="o">:</code>
<code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>     <code class="n">Exposure</code>
    <code class="m">424.583</code>       <code class="m">-4.185</code></pre>

<p>The intercept, or <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>b</mi> <mn>0</mn> </msub>
</math>, is 424.583 and can be interpreted as the predicted <code>PEFR</code> for a worker with zero years exposure.<a data-type="indexterm" data-primary="intercepts" data-secondary="in cotton exposure and lung capacity example" id="idm45909264353320"></a>
The regression coefficient, or <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>b</mi> <mn>1</mn> </msub>
</math>, can be interpreted as follows: for each additional year that a worker is exposed to cotton dust, the worker’s <code>PEFR</code> measurement is reduced by –4.185.<a data-type="indexterm" data-primary="regression coefficient" data-secondary="in cotton exposure and lung capacity example" id="idm45909264349960"></a></p>

<p>The regression line from this model is displayed in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#lung_model">Figure&nbsp;4-2</a>.</p>

<figure><div id="lung_model" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0402.png" alt="images/lung_model.png" width="345" height="348">
<h6><span class="label">Figure 4-2. </span>Slope and intercept for the regression fit to the lung data</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Fitted Values and Residuals"><div class="sect2" id="idm45909264464312">
<h2>Fitted Values and Residuals</h2>

<p>Important concepts in regression analysis are the <em>fitted</em> values and  <em>residuals</em>.<a data-type="indexterm" data-primary="fitted values" id="idm45909264343080"></a><a data-type="indexterm" data-primary="residuals" id="idm45909264342344"></a><a data-type="indexterm" data-primary="linear regression" data-secondary="fitted values and residuals" id="idm45909264341672"></a><a data-type="indexterm" data-primary="regression" data-secondary="simple linear regression" data-tertiary="fitted values and residuals" id="idm45909264340760"></a>
In general, the data doesn’t fall exactly on a line, so the regression equation should include an explicit error term <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>e</mi> <mi>i</mi> </msub>
</math>:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <msub><mi>Y</mi> <mi>i</mi> </msub>
    <mo>=</mo>
    <msub><mi>b</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mi>b</mi> <mn>1</mn> </msub>
    <msub><mi>X</mi> <mi>i</mi> </msub>
    <mo>+</mo>
    <msub><mi>e</mi> <mi>i</mi> </msub>
  </mrow>
</math>
</div>

<p>The <em>fitted</em> values, also referred to as the <em>predicted</em> values,
are typically denoted by  <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>Y</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
</math> (Y-hat).<a data-type="indexterm" data-primary="predicted values" data-seealso="fitted values" id="idm45909264300888"></a>
These are given by:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <msub><mover accent="true"><mi>Y</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
    <mo>=</mo>
    <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>1</mn> </msub>
    <msub><mi>X</mi> <mi>i</mi> </msub>
  </mrow>
</math>
</div>

<p>The notation <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>0</mn> </msub>
</math> and  <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>1</mn> </msub>
</math> indicates that the coefficients are estimated versus known.<a data-type="indexterm" data-primary="coefficients" data-secondary="in simple linear regression" data-tertiary="estimates vs. known" id="idm45909264283880"></a><a data-type="indexterm" data-primary="hat notation" id="idm45909264282568"></a></p>
<div data-type="tip" id="Hat_notation"><h1>Hat Notation: Estimates Versus Known Values</h1>
<p>The “hat” notation is used to differentiate between estimates and known values.<a data-type="indexterm" data-primary="estimates" data-secondary="indicated by hat notation" id="idm45909264280328"></a>
So the symbol <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mover accent="true"><mi>b</mi> <mo>^</mo></mover>
</math> (“b-hat”) is an estimate of the unknown parameter <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>b</mi>
</math>.
Why do statisticians differentiate between the estimate and the true value?
The estimate has uncertainty, whereas the true value is fixed.<sup><a data-type="noteref" id="idm45909264276232-marker" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909264276232">2</a></sup></p>
</div>

<p>We compute the residuals <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>e</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
</math> by subtracting the <em>predicted</em> values from<a data-type="indexterm" data-primary="residuals" data-secondary="computing" id="idm45909264271864"></a> the original data:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <msub><mover accent="true"><mi>e</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
    <mo>=</mo>
    <msub><mi>Y</mi> <mi>i</mi> </msub>
    <mo>-</mo>
    <msub><mover accent="true"><mi>Y</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
  </mrow>
</math>
</div>

<p>In R, we can obtain the fitted values and residuals using the functions <code>predict</code> and <code>residuals</code>:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">fitted</code> <code class="o">&lt;-</code> <code class="nf">predict</code><code class="p">(</code><code class="n">model</code><code class="p">)</code>
<code class="n">resid</code> <code class="o">&lt;-</code> <code class="nf">residuals</code><code class="p">(</code><code class="n">model</code><code class="p">)</code></pre>

<p><a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#residuals">Figure&nbsp;4-3</a> illustrates the residuals from the regression line fit to the lung data.
The residuals are the length of the vertical dashed lines from the data to the line.</p>

<figure class="width-50"><div id="residuals" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0403.png" alt="images/lung_residuals.png" width="1178" height="1188">
<h6><span class="label">Figure 4-3. </span>Residuals from a regression line (note the different y-axis scale from <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#lung_model">Figure&nbsp;4-2</a>, hence the apparently different slope)</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Least Squares"><div class="sect2" id="OLS">
<h2>Least Squares</h2>

<p>How is the model fit to the data?
When there is a clear relationship, you could imagine fitting the line by hand.<a data-type="indexterm" data-primary="least squares" id="idm45909264240760"></a><a data-type="indexterm" data-primary="linear regression" data-secondary="least squares" id="idm45909264240056"></a><a data-type="indexterm" data-primary="regression" data-secondary="simple linear regression" data-tertiary="least squares" id="idm45909264239112"></a>
In practice, the regression line is the estimate that minimizes the sum of squared residual values, also <a data-type="indexterm" data-primary="residual sum of squares" data-seealso="least squares" id="idm45909264237672"></a><a data-type="indexterm" data-primary="RSS (residual sum of squares)" data-seealso="least squares" id="idm45909264236728"></a>called the <em>residual sum of squares</em> or <em>RSS</em>:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mtable displaystyle="true">
    <mtr>
      <mtd columnalign="right">
        <mrow>
          <mi>R</mi>
          <mi>S</mi>
          <mi>S</mi>
        </mrow>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd columnalign="left">
        <mrow>
          <munderover><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </munderover>
          <msup><mfenced separators="" open="(" close=")"><msub><mi>Y</mi> <mi>i</mi> </msub><mo>-</mo><msub><mover accent="true"><mi>Y</mi> <mo>^</mo></mover> <mi>i</mi> </msub></mfenced> <mn>2</mn> </msup>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd></mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd columnalign="left">
        <mrow>
          <munderover><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </munderover>
          <msup><mfenced separators="" open="(" close=")"><msub><mi>Y</mi> <mi>i</mi> </msub><mo>-</mo><msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>0</mn> </msub><mo>-</mo><msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>1</mn> </msub><msub><mi>X</mi> <mi>i</mi> </msub></mfenced> <mn>2</mn> </msup>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p>The estimates <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>0</mn> </msub>
</math> and  <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>1</mn> </msub>
</math> are the values that minimize RSS.</p>

<p>The method of minimizing the sum of the squared residuals is termed <em>least squares</em> regression, or <em>ordinary least squares</em> (OLS) regression.<a data-type="indexterm" data-primary="ordinary least squares (OLS)" data-seealso="least squares" id="idm45909264179848"></a>
It is often attributed to Carl Friedrich Gauss, the German mathmetician, but was first published by the French mathmetician Adrien-Marie Legendre in 1805.
Least squares regression leads to a simple formula to compute the coefficients:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mtable displaystyle="true">
    <mtr>
      <mtd columnalign="right">
        <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>1</mn> </msub>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd columnalign="left">
        <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><mfenced separators="" open="(" close=")"><msub><mi>Y</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>Y</mi> <mo>¯</mo></mover></mfenced><mfenced separators="" open="(" close=")"><msub><mi>X</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>X</mi> <mo>¯</mo></mover></mfenced></mrow> <mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><msup><mfenced separators="" open="(" close=")"><msub><mi>X</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>X</mi> <mo>¯</mo></mover></mfenced> <mn>2</mn> </msup></mrow></mfrac>
      </mtd>
    </mtr>
    <mtr>
      <mtd columnalign="right">
        <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>0</mn> </msub>
      </mtd>
      <mtd>
        <mo>=</mo>
      </mtd>
      <mtd columnalign="left">
        <mrow>
          <mover accent="true"><mi>Y</mi> <mo>¯</mo></mover>
          <mo>-</mo>
          <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>1</mn> </msub>
          <mover accent="true"><mi>X</mi> <mo>¯</mo></mover>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</math>
</div>

<p>Historically, computational convenience is one reason for the widespread use of least squares in regression.
With the advent of big data, computational speed is still an important factor.
Least squares, like the mean (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch01.html#Median">“Median and Robust Estimates”</a>), are sensitive to outliers, although this tends to be a signicant problem only in small or moderate-sized problems.<a data-type="indexterm" data-primary="outliers" data-secondary="sensitivity of least squares to" id="idm45909264143464"></a>
See <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#regression_outliers">“Outliers”</a> for a discussion of outliers in regression.</p>
<div data-type="note" epub:type="note"><h1>Regression Terminology</h1>
<p>When analysts and researchers use the term <em>regression</em> by itself, they are typically referring to linear regression; the focus is usually on developing a linear model to explain the relationship between predictor variables and a numeric outcome variable.<a data-type="indexterm" data-primary="regression" data-secondary="different meanings of the term" id="idm45909264139464"></a>
In its formal statistical sense, regression also includes nonlinear models that yield a functional relationship between predictors and outcome variables.
In the machine learning community, the term is also occasionally used loosely to refer to the use of any predictive model that produces a predicted numeric outcome (standing in distinction from classification methods that predict a binary or categorical outcome).</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Prediction versus Explanation (Profiling)"><div class="sect2" id="idm45909264137656">
<h2>Prediction versus Explanation (Profiling)</h2>

<p>Historically, a primary use of regression was to illuminate a supposed linear relationship between predictor variables and an outcome variable.<a data-type="indexterm" data-primary="explanation vs. prediction (in regression)" id="idm45909264135992"></a><a data-type="indexterm" data-primary="linear regression" data-secondary="prediction vs. explanation" id="idm45909264135192"></a><a data-type="indexterm" data-primary="regression" data-secondary="simple linear regression" data-tertiary="prediction vs. explanation" id="idm45909264134280"></a><a data-type="indexterm" data-primary="prediction" data-secondary="explanation vs., in linear regression" id="idm45909264133032"></a><a data-type="indexterm" data-primary="profiling vs. explanation" id="idm45909264132072"></a>
The goal has been to understand a relationship and explain it using the data that the regression was fit to.
In this case, the primary focus is on the estimated slope of the regression equation, <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mover accent="true"><mi>b</mi> <mo>^</mo></mover>
</math>.
Economists want to know the relationship between consumer spending and GDP growth.
Public health officials might want to understand whether a public information campaign is effective in promoting safe sex practices.
In such cases, the focus is not on predicting individual cases, but rather on understanding the overall relationship.</p>

<p>With the advent of big data,
regression is widely used to form a model to predict individual outcomes for new data, rather than explain data in hand (i.e., a predictive model).<a data-type="indexterm" data-primary="big data" data-secondary="use of regression in" id="idm45909264128408"></a>
In this instance, the main items of interest are the fitted values <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mover accent="true"><mi>Y</mi> <mo>^</mo></mover>
</math>.
In marketing, regression can be used to predict the change in revenue in response to the size of an ad campaign.
Universities use regression to predict students’ GPA based on their SAT scores.</p>

<p>A regression model that fits the data well is set up such that changes in X lead to changes in Y.<a data-type="indexterm" data-primary="regression" data-secondary="causation and" id="idm45909264124776"></a>
However, by itself, the regression equation does not prove the direction of causation.<a data-type="indexterm" data-primary="causation, regression and" id="idm45909264123672"></a>
Conclusions about causation must come from a broader context of understanding about the relationship.
For example, a regression equation might show a definite relationship between number of clicks on a web ad and number of conversions.
It is our knowledge of the marketing process, not the regression equation, that leads us to the conclusion that clicks on the ad lead to sales, and not vice versa.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909264122264">
<h5>Key Ideas</h5>
<ul>
<li>
<p>The regression equation models the relationship between a response  variable <em>Y</em> and a predictor variable <em>X</em> as a line.</p>
</li>
<li>
<p>A regression model yields fitted values and residuals—predictions of the response and the errors of the predictions.</p>
</li>
<li>
<p>Regression models are typically fit by the method of least squares.</p>
</li>
<li>
<p>Regression is used both for prediction and explanation.</p>
</li>
</ul>
</div></aside>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Further Reading"><div class="sect2" id="idm45909264116168">
<h2>Further Reading</h2>

<p>For an in-depth treatment of prediction versus explanation, see Galit Shmueli’s article <a href="https://projecteuclid.org/euclid.ss/1294167961" onmousedown="dataLayer.push({&#39;event&#39;: &#39;eventTracker&#39;, &#39;eventCat&#39;: &#39;Outbound Links&#39;, &#39;eventAct&#39;:&#39;Non-Oreilly&#39;, &#39;eventLbl&#39;: &#39;projecteuclid.org/euclid.ss/1294167961&#39;, &#39;eventVal&#39;: 0, &#39;nonInteraction&#39;: 0});">“To Explain or to Predict”</a>.<a data-type="indexterm" data-primary="regression" data-secondary="simple linear regression" data-startref="ix_regrsimlin" id="idm45909264113944"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Multiple Linear Regression"><div class="sect1" id="MultipleLinearRegression">
<h1>Multiple Linear Regression</h1>

<p>When there are multiple predictors, the equation <a data-type="indexterm" data-primary="linear regression" data-secondary="multiple" id="ix_linregrmulti"></a><a data-type="indexterm" data-primary="regression" data-secondary="multiple linear regression" id="ix_regrlinmul"></a>is simply extended to accommodate them:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <mi>Y</mi>
    <mo>=</mo>
    <msub><mi>b</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mi>b</mi> <mn>1</mn> </msub>
    <msub><mi>X</mi> <mn>1</mn> </msub>
    <mo>+</mo>
    <msub><mi>b</mi> <mn>2</mn> </msub>
    <msub><mi>X</mi> <mn>2</mn> </msub>
    <mo>+</mo>
    <mo>...</mo>
    <mo>+</mo>
    <msub><mi>b</mi> <mi>p</mi> </msub>
    <msub><mi>X</mi> <mi>p</mi> </msub>
    <mo>+</mo>
    <mi>e</mi>
  </mrow>
</math>
</div>

<p>Instead of a line, we now have a linear model—the relationship between each coefficient and its variable (feature) is linear.<a data-type="indexterm" data-primary="multiple linear regression" data-see="linear regression" id="idm45909264092904"></a></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909264091784">
<h5>Key Terms for Multiple Linear Regression</h5><dl>
<dt class="horizontal"><strong><em>Root mean squared error</em></strong></dt>
<dd>
<p>The square root of the average squared error of the regression (this is the most widely used metric to compare regression models).<a data-type="indexterm" data-primary="root mean squared error (RMSE)" id="idm45909264088472"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>RMSE</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Residual standard error</em></strong></dt>
<dd>
<p>The same as the root mean squared error, but adjusted for degrees of freedom.<a data-type="indexterm" data-primary="residual standard error" id="idm45909264084200"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>RSE</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>R-squared</em></strong></dt>
<dd>
<p>The proportion of <a data-type="indexterm" data-primary="R-squared" id="idm45909264079896"></a>variance explained by the model, from 0 to 1.</p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>coefficient of determination, <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msup><mi>R</mi> <mn>2</mn> </msup>
</math></p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>t-statistic</em></strong></dt>
<dd>
<p>The coefficient for a predictor, divided by the standard error of the coefficient, giving a metric to compare the importance of variables in the model.<a data-type="indexterm" data-primary="t-statistic" id="idm45909264073656"></a><a data-type="indexterm" data-primary="weighted regression" id="idm45909264072952"></a> See <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch03.html#tTest">“t-Tests”</a>.</p>
</dd>
<dt class="horizontal"><strong><em>Weighted regression</em></strong></dt>
<dd>
<p>Regression with the records having different weights.</p>
</dd>
</dl>
</div></aside>

<p>All of the other concepts in simple linear regression,
such as fitting by least squares and the definition of fitted values and residuals, extend to the multiple linear regression setting.
For example, the fitted values are given by:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <msub><mover accent="true"><mi>Y</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
    <mo>=</mo>
    <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>1</mn> </msub>
    <msub><mi>X</mi> <mrow><mn>1</mn><mo>,</mo><mi>i</mi></mrow> </msub>
    <mo>+</mo>
    <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mn>2</mn> </msub>
    <msub><mi>X</mi> <mrow><mn>2</mn><mo>,</mo><mi>i</mi></mrow> </msub>
    <mo>+</mo>
    <mo>...</mo>
    <mo>+</mo>
    <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mi>p</mi> </msub>
    <msub><mi>X</mi> <mrow><mi>p</mi><mo>,</mo><mi>i</mi></mrow> </msub>
  </mrow>
</math>
</div>








<section data-type="sect2" data-pdf-bookmark="Example: King County Housing Data"><div class="sect2" id="KingCountyHousingData">
<h2>Example: King County Housing Data</h2>

<p>An example of using regression is in estimating the value of houses.
County assessors must estimate the value of a house for the purposes of assessing taxes.<a data-type="indexterm" data-primary="linear regression" data-secondary="multiple" data-tertiary="example, King County housing data" id="idm45909264045704"></a>
Real estate consumers and professionals consult popular websites such as <a href="http://zillow.com/" onmousedown="dataLayer.push({&#39;event&#39;: &#39;eventTracker&#39;, &#39;eventCat&#39;: &#39;Outbound Links&#39;, &#39;eventAct&#39;:&#39;Non-Oreilly&#39;, &#39;eventLbl&#39;: &#39;zillow.com/&#39;, &#39;eventVal&#39;: 0, &#39;nonInteraction&#39;: 0});">Zillow</a> to ascertain a fair price.
Here are a few rows of housing data from King County (Seattle), Washington, from the <code>house data.frame</code>:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">head</code><code class="p">(</code><code class="n">house</code><code class="p">[,</code> <code class="nf">c</code><code class="p">(</code><code class="s">"AdjSalePrice"</code><code class="p">,</code> <code class="s">"SqFtTotLiving"</code><code class="p">,</code> <code class="s">"SqFtLot"</code><code class="p">,</code> <code class="s">"Bathrooms"</code><code class="p">,</code>
               <code class="s">"Bedrooms"</code><code class="p">,</code> <code class="s">"BldgGrade"</code><code class="p">)])</code>
<code class="n">Source</code><code class="o">:</code> <code class="n">local</code> <code class="n">data</code> <code class="n">frame</code> <code class="p">[</code><code class="m">6</code> <code class="n">x</code> <code class="m">6</code><code class="p">]</code></pre>
<pre>  AdjSalePrice SqFtTotLiving SqFtLot Bathrooms Bedrooms BldgGrade
         (dbl)         (int)   (int)     (dbl)    (int)     (int)
1       300805          2400    9373      3.00        6         7
2      1076162          3764   20156      3.75        4        10
3       761805          2060   26036      1.75        4         8
4       442065          3200    8618      3.75        5         7
5       297065          1720    8620      1.75        4         7
6       411781           930    1012      1.50        2         8</pre>

<p>The goal is to predict the sales price from the other variables.
The <code>lm</code> handles the multiple regression case simply by including more terms on the righthand side of the equation; the argument <code>na.action=na.omit</code> causes the model to drop records that have missing values:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">house_lm</code> <code class="o">&lt;-</code> <code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code>
                 <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code><code class="p">,</code>
               <code class="n">data</code><code class="o">=</code><code class="n">house</code><code class="p">,</code> <code class="n">na.action</code><code class="o">=</code><code class="n">na.omit</code><code class="p">)</code></pre>

<p>Printing <code>house_lm</code> object produces the following output:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">house_lm</code>

<code class="n">Call</code><code class="o">:</code>
<code class="nf">lm</code><code class="p">(</code><code class="n">formula</code> <code class="o">=</code> <code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code>
    <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code><code class="p">,</code> <code class="n">data</code> <code class="o">=</code> <code class="n">house</code><code class="p">,</code> <code class="n">na.action</code> <code class="o">=</code> <code class="n">na.omit</code><code class="p">)</code>

<code class="n">Coefficients</code><code class="o">:</code>
  <code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>  <code class="n">SqFtTotLiving</code>        <code class="n">SqFtLot</code>      <code class="n">Bathrooms</code>
   <code class="m">-5.219e+05</code>      <code class="m">2.288e+02</code>     <code class="m">-6.051e-02</code>     <code class="m">-1.944e+04</code>
     <code class="n">Bedrooms</code>      <code class="n">BldgGrade</code>
   <code class="m">-4.778e+04</code>      <code class="m">1.061e+05</code></pre>

<p>The interpretation of the coefficients is as with simple linear regression:
the predicted value <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mover accent="true"><mi>Y</mi> <mo>^</mo></mover>
</math> changes by the coefficient <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>b</mi> <mi>j</mi> </msub>
</math> for each unit change in <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>X</mi> <mi>j</mi> </msub>
</math> assuming all the other variables, <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>X</mi> <mi>k</mi> </msub>
</math> for <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mrow>
    <mi>k</mi>
    <mo>≠</mo>
    <mi>j</mi>
  </mrow>
</math>,
remain the same.<a data-type="indexterm" data-primary="coefficients" data-secondary="interpretation in multiple linear regression" id="idm45909263877480"></a>
For example,
adding an extra finished square foot to a house increases the estimated value by roughly $229;
adding 1,000 finished square feet implies the value will increase by $228,800.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Assessing the Model"><div class="sect2" id="RMSE">
<h2>Assessing the Model</h2>

<p>The most important performance metric from a data science perspective is <em>root mean squared error</em>, or <em>RMSE</em>. <a data-type="indexterm" data-primary="root mean squared error (RMSE)" id="idm45909263873336"></a><a data-type="indexterm" data-primary="linear regression" data-secondary="multiple" data-tertiary="assessing the model" id="idm45909263872584"></a>
RMSE is the square root of the average squared error in the predicted <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>y</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
</math> values:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <mi>R</mi>
    <mi>M</mi>
    <mi>S</mi>
    <mi>E</mi>
    <mo>=</mo>
    <msqrt>
      <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><msup><mfenced separators="" open="(" close=")"><msub><mi>y</mi> <mi>i</mi> </msub><mo>-</mo><msub><mover accent="true"><mi>y</mi> <mo>^</mo></mover> <mi>i</mi> </msub></mfenced> <mn>2</mn> </msup></mrow> <mi>n</mi></mfrac>
    </msqrt>
  </mrow>
</math>
</div>

<p>This measures the overall accuracy of the model, and is a basis for comparing it to other models (including models fit using machine learning techniques).
Similar to RMSE is the <em>residual standard error</em>, or <em>RSE</em>.<a data-type="indexterm" data-primary="residual standard error" id="idm45909263854408"></a><a data-type="indexterm" data-primary="RSE" data-see="residual standard error" id="idm45909263853672"></a>
In this case we have <em>p</em> predictors, and the RSE is given by:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <mi>R</mi>
    <mi>S</mi>
    <mi>E</mi>
    <mo>=</mo>
    <msqrt>
      <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><msup><mfenced separators="" open="(" close=")"><msub><mi>y</mi> <mi>i</mi> </msub><mo>-</mo><msub><mover accent="true"><mi>y</mi> <mo>^</mo></mover> <mi>i</mi> </msub></mfenced> <mn>2</mn> </msup></mrow> <mfenced separators="" open="(" close=")"><mi>n</mi><mo>-</mo><mi>p</mi><mo>-</mo><mn>1</mn></mfenced></mfrac>
    </msqrt>
  </mrow>
</math>
</div>

<p>The only difference is that the denominator is the degrees of freedom, as opposed to number of records (see  <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch03.html#DOF">“Degrees of Freedom”</a>).
In practice, for linear regression, the difference between RMSE and RSE is very small, particularly for big data applications.</p>

<p>The <code>summary</code> function in R computes RSE as well as other metrics for a regression model:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">summary</code><code class="p">(</code><code class="n">house_lm</code><code class="p">)</code>

<code class="n">Call</code><code class="o">:</code>
<code class="nf">lm</code><code class="p">(</code><code class="n">formula</code> <code class="o">=</code> <code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code>
    <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code><code class="p">,</code> <code class="n">data</code> <code class="o">=</code> <code class="n">house</code><code class="p">,</code> <code class="n">na.action</code> <code class="o">=</code> <code class="n">na.omit</code><code class="p">)</code>

<code class="n">Residuals</code><code class="o">:</code>
     <code class="n">Min</code>       <code class="m">1</code><code class="n">Q</code>   <code class="n">Median</code>       <code class="m">3</code><code class="n">Q</code>      <code class="n">Max</code>
<code class="m">-1199508</code>  <code class="m">-118879</code>   <code class="m">-20982</code>    <code class="m">87414</code>  <code class="m">9472982</code>

<code class="n">Coefficients</code><code class="o">:</code>
                <code class="n">Estimate</code> <code class="n">Std.</code> <code class="n">Error</code> <code class="n">t</code> <code class="n">value</code> <code class="nf">Pr</code><code class="p">(</code><code class="o">&gt;|</code><code class="n">t</code><code class="o">|</code><code class="p">)</code>
<code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>   <code class="m">-5.219e+05</code>  <code class="m">1.565e+04</code> <code class="m">-33.349</code>  <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">SqFtTotLiving</code>  <code class="m">2.288e+02</code>  <code class="m">3.898e+00</code>  <code class="m">58.699</code>  <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">SqFtLot</code>       <code class="m">-6.051e-02</code>  <code class="m">6.118e-02</code>  <code class="m">-0.989</code>    <code class="m">0.323</code>
<code class="n">Bathrooms</code>     <code class="m">-1.944e+04</code>  <code class="m">3.625e+03</code>  <code class="m">-5.362</code> <code class="m">8.32e-08</code> <code class="o">***</code>
<code class="n">Bedrooms</code>      <code class="m">-4.778e+04</code>  <code class="m">2.489e+03</code> <code class="m">-19.194</code>  <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="n">BldgGrade</code>      <code class="m">1.061e+05</code>  <code class="m">2.396e+03</code>  <code class="m">44.287</code>  <code class="o">&lt;</code> <code class="m">2e-16</code> <code class="o">***</code>
<code class="o">---</code>
<code class="n">Signif.</code> <code class="n">codes</code><code class="o">:</code>  <code class="m">0</code> <code class="s">'***'</code> <code class="m">0.001</code> <code class="s">'**'</code> <code class="m">0.01</code> <code class="s">'*'</code> <code class="m">0.05</code> <code class="s">'.'</code> <code class="m">0.1</code> <code class="s">' '</code> <code class="m">1</code>

<code class="n">Residual</code> <code class="n">standard</code> <code class="n">error</code><code class="o">:</code> <code class="m">261200</code> <code class="n">on</code> <code class="m">22683</code> <code class="n">degrees</code> <code class="n">of</code> <code class="n">freedom</code>
<code class="n">Multiple</code> <code class="n">R</code><code class="o">-</code><code class="n">squared</code><code class="o">:</code>  <code class="m">0.5407</code><code class="p">,</code>	<code class="n">Adjusted</code> <code class="n">R</code><code class="o">-</code><code class="n">squared</code><code class="o">:</code>  <code class="m">0.5406</code>
<code class="bp">F</code><code class="o">-</code><code class="n">statistic</code><code class="o">:</code>  <code class="m">5340</code> <code class="n">on</code> <code class="m">5</code> <code class="n">and</code> <code class="m">22683</code> <code class="n">DF</code><code class="p">,</code>  <code class="n">p</code><code class="o">-</code><code class="n">value</code><code class="o">:</code> <code class="o">&lt;</code> <code class="m">2.2e-16</code></pre>

<p>Another useful metric that you will see in software output is the <em>coefficient of determination</em>, also called the <em>R-squared</em> statistic or <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msup><mi>R</mi> <mn>2</mn> </msup>
</math>.
R-squared ranges from 0 to 1 and measures the proportion of variation in the data that is accounted for in the model.<a data-type="indexterm" data-primary="R-squared" id="idm45909262358040"></a><a data-type="indexterm" data-primary="coefficient of determination" id="idm45909262357336"></a>
It is useful mainly in explanatory uses of regression where you want to assess how well the model fits the data.
The formula for <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msup><mi>R</mi> <mn>2</mn> </msup>
</math> is:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <msup><mi>R</mi> <mn>2</mn> </msup>
    <mo>=</mo>
    <mn>1</mn>
    <mo>-</mo>
    <mfrac><mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><msup><mfenced separators="" open="(" close=")"><msub><mi>y</mi> <mi>i</mi> </msub><mo>-</mo><msub><mover accent="true"><mi>y</mi> <mo>^</mo></mover> <mi>i</mi> </msub></mfenced> <mn>2</mn> </msup></mrow> <mrow><msubsup><mo>∑</mo> <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow> <mi>n</mi> </msubsup><msup><mfenced separators="" open="(" close=")"><msub><mi>y</mi> <mi>i</mi> </msub><mo>-</mo><mover accent="true"><mi>y</mi> <mo>¯</mo></mover></mfenced> <mn>2</mn> </msup></mrow></mfrac>
  </mrow>
</math>
</div>

<p>The denominator is proportional to the variance of <em>Y</em>.
The output from R also reports an <em>adjusted R-squared</em>, which adjusts for the degrees of freedom; seldom is this significantly different in multiple regression.<a data-type="indexterm" data-primary="adjusted R-squared" id="idm45909262334440"></a></p>

<p>Along with the estimated coefficients, R reports <a data-type="indexterm" data-primary="t-statistic" id="idm45909262333288"></a>the standard error of the coefficients (SE) and a <em>t-statistic</em>:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <msub><mi>t</mi> <mi>b</mi> </msub>
    <mo>=</mo>
    <mfrac><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mrow><mtext>SE</mtext><mfenced separators="" open="(" close=")"><mover accent="true"><mi>b</mi> <mo>^</mo></mover></mfenced></mrow></mfrac>
  </mrow>
</math>
</div>

<p>The t-statistic—and its mirror image, the p-value—measures the extent to which a coefficient is “statistically significant”—that is, outside the range of what a random chance arrangement of predictor and target variable might produce.<a data-type="indexterm" data-primary="p-values" data-secondary="t-statistic and" id="idm45909262323528"></a>
The higher the t-statistic (and the lower the p-value), the more significant the predictor.
Since parsimony is a valuable model feature, it is useful to have a tool like this to guide choice of variables to include as predictors (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#StepwiseRegression">“Model Selection and Stepwise Regression”</a>).</p>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>In addition to the t-statistic, R and other packages will often report a <em>p-value</em>
(<code>Pr(&gt;|t|)</code> in the R output) and <em>F-statistic</em>.<a data-type="indexterm" data-primary="F-statistic" id="idm45909262318888"></a> Data scientists do not generally get too involved with the interpretation of these statistics, nor with the issue of statistical significance.
Data scientists primarily focus on the t-statistic as a useful guide for whether to include a predictor in a model or not.
High t-statistics (which go with p-values near 0) indicate a predictor should be retained in a model, while very low t-statistics indicate a predictor could be dropped.
See <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch03.html#p-value">“P-Value”</a> for more discussion.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Cross-Validation"><div class="sect2" id="CrossValidation">
<h2>Cross-Validation</h2>

<p>Classic statistical regression metrics (<em>R<sup>2</sup></em>, F-statistics, and p-values) are all “in-sample” metrics—they are applied to the same data that was used to fit the model.<a data-type="indexterm" data-primary="linear regression" data-secondary="multiple" data-tertiary="cross-validation" id="idm45909262314072"></a><a data-type="indexterm" data-primary="cross-validation" id="idm45909262312856"></a>
Intuitively, you can see that it would make a lot of sense to set aside some of the original data, not use it to fit the model, and then apply the model to the set-aside (holdout) data to see how well it does.
Normally, you would use a majority of the data to fit the model, and use a smaller portion to test the model.</p>

<p>This idea of “out-of-sample” validation is not new, but it did not really take hold until larger data sets became more prevalent; with a small data set, analysts typically want to use all the data and fit the best possible model.</p>

<p>Using a holdout sample, though, leaves you subject to some uncertainty that arises simply from variability in the small holdout sample.
How different would the assessment be if you selected a different holdout sample?</p>

<p>Cross-validation extends the idea of a holdout sample to multiple sequential holdout samples.<a data-type="indexterm" data-primary="k-fold cross-validation" id="idm45909262309896"></a> The algorithm for basic <em>k-fold cross-validation</em> is as follows:</p>
<ol>
<li>
<p>Set aside <em>1/k</em> of the data as a holdout sample.</p>
</li>
<li>
<p>Train the model on the remaining data.</p>
</li>
<li>
<p>Apply (score) the model to the <em>1/k</em> holdout, and record needed model assessment metrics.</p>
</li>
<li>
<p>Restore the first <em>1/k</em> of the data, and set aside the next <em>1/k</em> (excluding any records that got picked the first time).</p>
</li>
<li>
<p>Repeat steps 2 and 3.</p>
</li>
<li>
<p>Repeat until each record has been used in the holdout portion.</p>
</li>
<li>
<p>Average or otherwise combine the model assessment metrics.</p>
</li>

</ol>

<p>The division of the data into the training sample and the holdout sample is also called a <em>fold</em>.<a data-type="indexterm" data-primary="folds" id="idm45909262299144"></a></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Model Selection and Stepwise Regression"><div class="sect2" id="StepwiseRegression">
<h2>Model Selection and Stepwise Regression</h2>

<p>In some problems,
many variables could be used as predictors in a regression.<a data-type="indexterm" data-primary="linear regression" data-secondary="multiple" data-tertiary="model selection and stepwise regression" id="idm45909262296344"></a>
For example, to predict house value,
additional variables such as the basement size or year built could be used.
In R, these are easy to add to the regression equation:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">house_full</code> <code class="o">&lt;-</code> <code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code>
                 <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code> <code class="o">+</code> <code class="n">PropertyType</code> <code class="o">+</code> <code class="n">NbrLivingUnits</code> <code class="o">+</code>
                 <code class="n">SqFtFinBasement</code> <code class="o">+</code> <code class="n">YrBuilt</code> <code class="o">+</code> <code class="n">YrRenovated</code> <code class="o">+</code>
                 <code class="n">NewConstruction</code><code class="p">,</code>
               <code class="n">data</code><code class="o">=</code><code class="n">house</code><code class="p">,</code> <code class="n">na.action</code><code class="o">=</code><code class="n">na.omit</code><code class="p">)</code></pre>

<p>Adding more variables, however, does not necessarily mean we have a better model.
Statisticians use the principle of <em>Occam’s razor</em> to guide<a data-type="indexterm" data-primary="Occam&#39;s razor" id="idm45909262149112"></a> the choice of a model:
all things being equal, a simpler model should be used in preference to a more complicated model.</p>

<p>Including additional variables always reduces RMSE and increases <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msup><mi>R</mi> <mn>2</mn> </msup>
</math>.
Hence, these are not appropriate to help guide the model choice.
In the 1970s,
Hirotugu Akaike,
the eminent Japanese statistician,
deveoped a metric called <em>AIC</em> (Akaike’s Information Criteria) that penalizes adding terms to a model.<a data-type="indexterm" data-primary="Akike, Hirotugu" id="idm45909262145656"></a><a data-type="indexterm" data-primary="AIC (Akaike&#39;s Information Criteria)" id="idm45909262264568"></a>
In the case of regression, AIC has the form:</p>
<ul class="simplelist">
  <li>AIC = 2<em>P</em> + <em>n</em> log(<code>RSS</code>/<em>n</em>)</li>
</ul>

<p>where <em>P</em> is the number of variables and <em>n</em> is the number of records.
The goal is to find the model that minimizes AIC;
models with <em>k</em> more extra variables are penalized by 2<em>k</em>.</p>
<div data-type="warning" epub:type="warning"><h1>AIC, BIC and Mallows Cp</h1>
<p id="AIC">The formula for AIC may seem a bit mysterious,
but in fact it is based on asymptotic results in information theory.
There are several<a data-type="indexterm" data-primary="AIC (Akaike&#39;s Information Criteria)" data-secondary="variants of" id="idm45909262256840"></a> variants to AIC:</p>

<ul>
<li>
<p>AICc: a version of AIC corrected for small sample sizes.</p>
</li>
<li>
<p>BIC or Bayesian information criteria: similar to AIC with a stronger penalty for including additional variables to the model.<a data-type="indexterm" data-primary="BIC (Bayesian information criteria)" id="idm45909262253656"></a><a data-type="indexterm" data-primary="Bayesian infomation criteria (BIC)" id="idm45909262252936"></a></p>
</li>
<li>
<p>Mallows Cp: A variant of AIC developed by Colin Mallows.<a data-type="indexterm" data-primary="Mallows Cp" id="idm45909262251416"></a></p>
</li>
</ul>

<p>Data scientists generally do not need to worry about the differences among these in-sample metrics or the underlying theory behind them.</p>
</div>

<p>How do we find the model that minimizes AIC?
One approach is to search through all possible models,
called <em>all subset regression</em>.<a data-type="indexterm" data-primary="all subset regression" id="idm45909262248600"></a>
This is computationally expensive and is not feasible for problems with large data and many variables.<a data-type="indexterm" data-primary="stepwise regression" id="idm45909262247624"></a>
An attractive alternative is to use <em>stepwise regression</em>, which  successively adds and drops predictors to find a model that lowers AIC.
The  <code>MASS</code> package by Venebles and Ripley  offers a stepwise regression function called <code>stepAIC</code>:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">library</code><code class="p">(</code><code class="n">MASS</code><code class="p">)</code>
<code class="n">step</code> <code class="o">&lt;-</code> <code class="nf">stepAIC</code><code class="p">(</code><code class="n">house_full</code><code class="p">,</code> <code class="n">direction</code><code class="o">=</code><code class="s">"both"</code><code class="p">)</code>
<code class="n">step</code>

<code class="n">Call</code><code class="o">:</code>
<code class="nf">lm</code><code class="p">(</code><code class="n">formula</code> <code class="o">=</code> <code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code> <code class="n">Bedrooms</code> <code class="o">+</code>
    <code class="n">BldgGrade</code> <code class="o">+</code> <code class="n">PropertyType</code> <code class="o">+</code> <code class="n">SqFtFinBasement</code> <code class="o">+</code> <code class="n">YrBuilt</code><code class="p">,</code> <code class="n">data</code> <code class="o">=</code> <code class="n">house0</code><code class="p">,</code>
    <code class="n">na.action</code> <code class="o">=</code> <code class="n">na.omit</code><code class="p">)</code>

<code class="n">Coefficients</code><code class="o">:</code>
              <code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>              <code class="n">SqFtTotLiving</code>
               <code class="m">6227632.22</code>                     <code class="m">186.50</code>
                <code class="n">Bathrooms</code>                   <code class="n">Bedrooms</code>
                 <code class="m">44721.72</code>                  <code class="m">-49807.18</code>
                <code class="n">BldgGrade</code>  <code class="n">PropertyTypeSingle</code> <code class="n">Family</code>
                <code class="m">139179.23</code>                   <code class="m">23328.69</code>
    <code class="n">PropertyTypeTownhouse</code>            <code class="n">SqFtFinBasement</code>
                 <code class="m">92216.25</code>                       <code class="m">9.04</code>
                  <code class="n">YrBuilt</code>
                 <code class="m">-3592.47</code></pre>

<p>The function chose a model in which several variables were dropped from <code>house_full</code>:
<code>SqFtLot</code>, <code>NbrLivingUnits</code>, <code>YrRenovated</code>, and <code>NewConstruction</code>.</p>

<p>Simpler yet are <em>forward selection</em> and <em>backward selection</em>.<a data-type="indexterm" data-primary="forward selection and backward selection" id="idm45909262062744"></a><a data-type="indexterm" data-primary="backward selection" id="idm45909262061976"></a>  In forward selection, you start with no predictors and add them one-by-one, at each step adding the predictor that has the largest contribution to <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msup><mi>R</mi> <mn>2</mn> </msup>
</math>, stopping when the contribution is no longer statistically significant.  In backward selection, or <em>backward elimination</em>, you start with the full model and take away predictors that are not statistically significant until you are left with a model in which all predictors are statistically significant.<a data-type="indexterm" data-primary="backward elimination" id="idm45909262058728"></a></p>

<p><em>Penalized regression</em> is similar in spirit to AIC.<a data-type="indexterm" data-primary="penalized regression" id="idm45909262057480"></a>
Instead of explicitly searching through a discrete set of models, the model-fitting equation incorporates a constraint that penalizes the model for too many variables (parameters).
Rather than eliminating predictor variables entirely—as with stepwise, forward, and backward selection—penalized regression applies the penalty by reducing coefficients, in some cases to near zero.
Common penalized regression methods are <em>ridge regression</em> and <em>lasso regression</em>.<a data-type="indexterm" data-primary="ridge regression" id="idm45909262055368"></a><a data-type="indexterm" data-primary="Lasso regression" id="idm45909262054632"></a></p>

<p>Stepwise regression and all subset regression are <em>in-sample</em> methods to assess and tune models.<a data-type="indexterm" data-primary="in-sample methods to assess and tune models" id="idm45909262053096"></a>
This means the model selection is possibly subject to overfitting and may not perform as well when applied to new data.
One common approach to avoid this is to use cross-validation to validate the models.
In linear regression, overfitting is typically not a major issue, due to the simple (linear) global structure imposed on the data.<a data-type="indexterm" data-primary="overfitting" data-secondary="in linear regression" id="idm45909262051816"></a>
For more sophisticated types of models, particularly iterative procedures that respond to local data structure, cross-validation is a very important tool;
see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#CrossValidation">“Cross-Validation”</a> for details.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Weighted Regression"><div class="sect2" id="WeightedRegression">
<h2>Weighted Regression</h2>

<p>Weighted regression is used by statisticians for a variety of purposes;
in particular, it is important for analysis of complex surveys.<a data-type="indexterm" data-primary="linear regression" data-secondary="multiple" data-tertiary="weighted regression" id="idm45909262047656"></a><a data-type="indexterm" data-primary="weighted regression" id="idm45909262046408"></a>
Data scientists may find weighted regression useful in two cases:</p>

<ul>
<li>
<p>Inverse-variance weighting when different observations have been measured with different precision.</p>
</li>
<li>
<p>Analysis of data in an aggregated form such that the weight variable encodes how many original observations each row in the aggregated data represents.</p>
</li>
</ul>

<p>For example, with the housing data,
older sales are less reliable than more recent sales.
Using the <code>DocumentDate</code> to determine the year of the sale, we can compute a <code>Weight</code> as the number of years since 2005 (the beginning of the data).</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">library</code><code class="p">(</code><code class="n">lubridate</code><code class="p">)</code>
<code class="n">house</code><code class="o">$</code><code class="n">Year</code> <code class="o">=</code> <code class="nf">year</code><code class="p">(</code><code class="n">house</code><code class="o">$</code><code class="n">DocumentDate</code><code class="p">)</code>
<code class="n">house</code><code class="o">$</code><code class="n">Weight</code> <code class="o">=</code> <code class="n">house</code><code class="o">$</code><code class="n">Year</code> <code class="o">-</code> <code class="m">2005</code></pre>

<p>We can compute a weighted regression with the <code>lm</code> function using the  <code>weight</code> argument.</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">house_wt</code> <code class="o">&lt;-</code> <code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code>
                 <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code><code class="p">,</code>
               <code class="n">data</code><code class="o">=</code><code class="n">house</code><code class="p">,</code> <code class="n">weight</code><code class="o">=</code><code class="n">Weight</code><code class="p">)</code>
<code class="nf">round</code><code class="p">(</code><code class="nf">cbind</code><code class="p">(</code><code class="n">house_lm</code><code class="o">=</code><code class="n">house_lm</code><code class="o">$</code><code class="n">coefficients</code><code class="p">,</code>
            <code class="n">house_wt</code><code class="o">=</code><code class="n">house_wt</code><code class="o">$</code><code class="n">coefficients</code><code class="p">),</code> <code class="n">digits</code><code class="o">=</code><code class="m">3</code><code class="p">)</code>

                   <code class="n">house_lm</code>    <code class="nf">house_wt</code>
<code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>   <code class="m">-521924.722</code> <code class="m">-584265.244</code>
<code class="n">SqFtTotLiving</code>     <code class="m">228.832</code>     <code class="m">245.017</code>
<code class="n">SqFtLot</code>            <code class="m">-0.061</code>      <code class="m">-0.292</code>
<code class="n">Bathrooms</code>      <code class="m">-19438.099</code>  <code class="m">-26079.171</code>
<code class="n">Bedrooms</code>       <code class="m">-47781.153</code>  <code class="m">-53625.404</code>
<code class="n">BldgGrade</code>      <code class="m">106117.210</code>  <code class="m">115259.026</code></pre>

<p>The coefficients in the weighted regression are slightly different from the original regression.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909261945432">
<h5>Key Ideas</h5>
<ul>
<li>
<p>Multiple linear regression models the relationship between a response  variable <em>Y</em> and multiple predictor variables <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mrow>
    <msub><mi>X</mi> <mn>1</mn> </msub>
    <mo>,</mo>
    <mo>...</mo>
    <mo>,</mo>
    <msub><mi>X</mi> <mi>p</mi> </msub>
  </mrow>
</math>.</p>
</li>
<li>
<p>The most important metrics to evaluate a model are root mean squared error (RMSE) and R-squared (<em>R</em><sup>2</sup>).</p>
</li>
<li>
<p>The standard error of the coefficients can be used to measure the reliability of a variable’s contribution to a model.</p>
</li>
<li>
<p>Stepwise regression is a way to automatically determine which variables should be included in the model.</p>
</li>
<li>
<p>Weighted regression is used to give certain records more or less weight in  fitting the equation.<a data-type="indexterm" data-primary="regression" data-secondary="multiple linear regression" data-startref="ix_regrlinmul" id="idm45909261856312"></a><a data-type="indexterm" data-primary="linear regression" data-secondary="multiple" data-startref="ix_linregrmulti" id="idm45909261855096"></a><a data-type="indexterm" data-primary="linear regression" data-startref="ix_linregr" id="idm45909261853880"></a></p>
</li>
</ul>
</div></aside>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Further Reading"><div class="sect2" id="idm45909262049336">
<h2>Further Reading</h2>

<p>An excellent treatment of cross-validation and resampling can be found in <em>An Introduction to Statistical Learning</em> by Gareth James, et al. (Springer, 2013).</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Prediction Using Regression"><div class="sect1" id="RegressionPrediction">
<h1>Prediction Using Regression</h1>

<p>The primary purpose of regression in data science is prediction.<a data-type="indexterm" data-primary="regression" data-secondary="prediction with" id="ix_regrpredict"></a><a data-type="indexterm" data-primary="prediction" data-secondary="using regression" id="ix_predictregr"></a>
This is useful to keep in mind, since regression, being an old and established statistical method, comes with baggage that is more relevant to its traditional explanatory modeling role than to prediction.</p>
<aside data-type="sidebar" epub:type="sidebar" class="pagebreak-before"><div class="sidebar" id="idm45909261846056">
<h5>Key Terms for Prediction Using Regression</h5><dl>
<dt class="horizontal"><strong><em>Prediction interval</em></strong></dt>
<dd>
<p>An uncertainty interval around an individual predicted value.<a data-type="indexterm" data-primary="prediction intervals" id="idm45909261843064"></a></p>
</dd>
<dt class="horizontal"><strong><em>Extrapolation</em></strong></dt>
<dd>
<p>Extension of a model beyond the range of the data used to fit it.<a data-type="indexterm" data-primary="extrapolation" data-secondary="definition of" id="idm45909261840552"></a></p>
</dd>
</dl>
</div></aside>








<section data-type="sect2" data-pdf-bookmark="The Dangers of Extrapolation"><div class="sect2" id="Extrapolation">
<h2>The Dangers of Extrapolation</h2>

<p>Regression models should not be used to extrapolate beyond the range of the data.<a data-type="indexterm" data-primary="extrapolation" data-secondary="dangers of" id="idm45909261837528"></a><a data-type="indexterm" data-primary="regression" data-secondary="prediction with" data-tertiary="dangers of extrapolation" id="idm45909261836552"></a><a data-type="indexterm" data-primary="prediction" data-secondary="using regression" data-tertiary="dangers of extrapolation" id="idm45909261835272"></a>
The model is valid only for predictor values for which the data has sufficient values
(even in the case that sufficient data is available, there could be other problems: see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#RegressionDiagnostics">“Testing the Assumptions: Regression Diagnostics”</a>).
As an extreme case,
suppose <code>model_lm</code> is used to predict the value of a 5,000-square-foot empty lot.
In such a case, all the predictors related to the building would have a value of 0 and the regression equation would yield an absurd prediction of –521,900 + 5,000 × –.0605 = –$522,202.
Why did this happen?
The data contains only parcels with buildings—there are no records corresponding to vacant land.
Consequently, the model has no information to tell it how to predict the sales price for vacant land.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Confidence and Prediction Intervals"><div class="sect2" id="RegressionCIs">
<h2>Confidence and Prediction Intervals</h2>

<p>Much of statistics involves understanding and measuring variability (uncertainty).<a data-type="indexterm" data-primary="regression" data-secondary="prediction with" data-tertiary="confidence and prediction intervals" id="idm45909261829544"></a><a data-type="indexterm" data-primary="prediction" data-secondary="using regression" data-tertiary="confidence and prediction intervals" id="idm45909261828280"></a>
The t-statistics and p-values reported in regression output deal with this in a formal way, which is sometimes useful for variable selection (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#RMSE">“Assessing the Model”</a>).
More useful metrics are confidence intervals, which are uncertainty intervals placed around regression coefficients and predictions.<a data-type="indexterm" data-primary="confidence intervals" id="idm45909261825816"></a>
An easy way to understand this is via the bootstrap (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch02.html#bootstrap">“The Bootstrap”</a> for more details about the general bootstrap procedure).<a data-type="indexterm" data-primary="bootstrap" data-secondary="confidence interval generation" id="idm45909261824216"></a>
The most common regression confidence intervals encountered in software output are those for regression parameters (coefficients).
Here is a bootstrap algorithm for generating confidence intervals for regression parameters (coefficients) for a data set with <em>P</em> predictors and <em>n</em> records (rows):</p>
<ol>
<li>
<p>Consider each row (including outcome variable) as a single “ticket” and place all the <em>n</em> tickets in a box.</p>
</li>
<li>
<p>Draw a ticket at random, record the values, and replace it in the box.</p>
</li>
<li>
<p>Repeat step 2 <em>n</em> times; you now have one bootstrap resample.</p>
</li>
<li>
<p>Fit a regression to the bootstrap sample, and record the estimated coefficients.</p>
</li>
<li>
<p>Repeat steps 2 through 4, say, 1,000 times.</p>
</li>
<li>
<p>You now have 1,000 bootstrap values for each coefficient; find the appropriate percentiles for each one (e.g., 5th and 95th for a 90% confidence interval).</p>
</li>

</ol>

<p>You can use the <code>Boot</code> function in R to generate actual bootstrap confidence intervals for the coefficients, or you can simply use the formula-based intervals that are a routine R output.
The conceptual meaning and interpretation are the same, and not of central importance to data scientists, because they concern the regression coefficients.  Of greater interest to data scientists are intervals around predicted <em>y</em> values (<math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>Y</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
</math>). The uncertainty around <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>Y</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
</math> comes from two sources:</p>

<ul>
<li>
<p>Uncertainty about what the relevant predictor variables and their coefficients are (see the preceding bootstrap algorithm)</p>
</li>
<li>
<p>Additional error inherent in individual data points</p>
</li>
</ul>

<p>The individual data point error can be thought of as follows: even if we knew for certain what the regression equation was (e.g., if we had a huge number of records to fit it), the <em>actual</em> outcome values for a given set of predictor values will vary.
For example, several houses—each with 8 rooms, a 6,500 square foot lot, 3 bathrooms, and a basement—might have different values.
We can model this individual error with the residuals from the fitted values.
The bootstrap algorithm for modeling both the regression model error and the individual data point error would look as follows:</p>
<ol>
<li>
<p>Take a bootstrap sample from the data (spelled out in greater detail earlier).</p>
</li>
<li>
<p>Fit the regression, and predict the new value.</p>
</li>
<li>
<p>Take a single residual at random from the original regression fit, add it to the predicted value, and record the result.</p>
</li>
<li>
<p>Repeat steps 1 through 3, say, 1,000 times.</p>
</li>
<li>
<p>Find the 2.5th and the 97.5th percentiles of the results.</p>
</li>

</ol>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909261799208">
<h5>Key Ideas</h5>
<ul>
<li>
<p>Extrapolation beyond the range of the data can lead to error.</p>
</li>
<li>
<p>Confidence intervals quantify uncertainty around regression coefficients.</p>
</li>
<li>
<p>Prediction intervals quantify uncertainty in individual predictions.</p>
</li>
<li>
<p>Most software, R included, will produce prediction and confidence intervals in default or specified output, using formulas.</p>
</li>
<li>
<p>The bootstrap can also be used; the interpretation and idea are the same.</p>
</li>
</ul>
</div></aside>
<div data-type="warning" epub:type="warning"><h1>Prediction Interval or Confidence Interval?</h1>
<p>A prediction interval pertains to uncertainty around a single value, while a confidence interval pertains to a mean or other statistic calculated from multiple values.<a data-type="indexterm" data-primary="prediction intervals" data-secondary="confidence intervals vs." id="idm45909261770280"></a>
Thus, a prediction interval will typically be much wider than a confidence interval for the same value.<a data-type="indexterm" data-primary="confidence intervals" data-secondary="prediction intervals vs." id="idm45909261769080"></a>
We model this individual value error in the bootstrap model by selecting an individual residual to tack on to the predicted value.
Which should you use?
That depends on the context and the purpose of the analysis, but, in general, data scientists are interested in specific individual predictions, so a prediction interval would be more appropriate.
Using a confidence interval when you should be using a prediction interval will greatly underestimate the uncertainty in a given predicted value.</p>
</div>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Factor Variables in Regression"><div class="sect1" id="FactorsRegression">
<h1>Factor Variables in Regression</h1>

<p><em>Factor</em> variables, also termed <em>categorical</em> variables,
take on a limited number of discrete values.<a data-type="indexterm" data-primary="regression" data-secondary="prediction with" data-startref="ix_regrpredict" id="idm45909261764648"></a><a data-type="indexterm" data-primary="prediction" data-secondary="using regression" data-startref="ix_predictregr" id="idm45909261763400"></a>
For example,  a loan purpose can be “debt consolidation,” “wedding,” “car,” and so on.<a data-type="indexterm" data-primary="categorical variables" data-seealso="factor variables" id="idm45909261761944"></a><a data-type="indexterm" data-primary="factor variables" id="ix_factorvar"></a><a data-type="indexterm" data-primary="regression" data-secondary="factor variables in" id="ix_regrfactor"></a>
The binary (yes/no) variable, also called an <em>indicator</em> variable, is a special case of a factor variable.<a data-type="indexterm" data-primary="indicator variables" id="idm45909261758264"></a>
Regression requires numerical inputs, so factor variables need to be recoded to use in the model.
The most common approach is to convert a variable
into a set of binary <em>dummy</em> variables.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909261756856">
<h5>Key Terms for Factor Variables</h5><dl>
<dt class="horizontal"><strong><em>Dummy variables</em></strong></dt>
<dd>
<p>Binary 0–1 variables derived by recoding factor data for use in regression and other models.<a data-type="indexterm" data-primary="dummy variables" id="idm45909261753688"></a></p>
</dd>
<dt class="horizontal"><strong><em>Reference coding</em></strong></dt>
<dd>
<p>The most common type of coding used by statisticians, in which one level of a factor is used as a reference and other factors are compared to that level.<a data-type="indexterm" data-primary="reference coding" id="refco_1k"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>treatment coding</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>One hot encoder</em></strong></dt>
<dd>
<p>A common type of coding used in the machine learning community in which all factors levels are retained.<a data-type="indexterm" data-primary="one hot encoder" id="idm45909261746296"></a>
While useful for certain machine learning algorithms, this approach is not appropriate for multiple linear regression.</p>
</dd>
<dt class="horizontal"><strong><em>Deviation coding</em></strong></dt>
<dd>
<p>A type of coding that compares each level against the overall mean as opposed to the reference level.<a data-type="indexterm" data-primary="deviation coding" id="idm45909261743416"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>sum contrasts</p>
</dd>
</dl>
</dd>
</dl>
</div></aside>








<section data-type="sect2" data-pdf-bookmark="Dummy Variables Representation"><div class="sect2" id="idm45909261740600">
<h2>Dummy Variables Representation</h2>

<p>In the King County housing data,  there is a factor variable for the property type; a small subset of six records is shown below.<a data-type="indexterm" data-primary="dummy variables" data-secondary="representation of factor variables in regression" id="idm45909261738680"></a><a data-type="indexterm" data-primary="factor variables" data-secondary="dummy variables representation" id="idm45909261737672"></a></p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">head</code><code class="p">(</code><code class="n">house</code><code class="p">[,</code> <code class="s">'PropertyType'</code><code class="p">])</code>
<code class="n">Source</code><code class="o">:</code> <code class="n">local</code> <code class="n">data</code> <code class="n">frame</code> <code class="p">[</code><code class="m">6</code> <code class="n">x</code> <code class="m">1</code><code class="p">]</code>

   <code class="nf">PropertyType</code>
<code class="nf">         </code><code class="p">(</code><code class="n">fctr</code><code class="p">)</code>
<code class="m">1</code>     <code class="n">Multiplex</code>
<code class="m">2</code> <code class="n">Single</code> <code class="n">Family</code>
<code class="m">3</code> <code class="n">Single</code> <code class="n">Family</code>
<code class="m">4</code> <code class="n">Single</code> <code class="n">Family</code>
<code class="m">5</code> <code class="n">Single</code> <code class="n">Family</code>
<code class="m">6</code>     <code class="n">Townhouse</code></pre>

<p>There are three possible values: <code>Multiplex</code>, <code>Single Family</code>, and <code>Townhouse</code>.
To use this factor variable, we need to convert it to a set of binary variables.
We do this by creating a binary variable for each possible value of the factor variable.
To do this in R, we use the <code>model.matrix</code> function:<sup><a data-type="noteref" id="idm45909261697000-marker" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909261697000">3</a></sup></p>

<pre data-type="programlisting" data-code-language="r"><code class="n">prop_type_dummies</code> <code class="o">&lt;-</code> <code class="nf">model.matrix</code><code class="p">(</code><code class="o">~</code><code class="n">PropertyType</code> <code class="m">-1</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">house</code><code class="p">)</code>
<code class="nf">head</code><code class="p">(</code><code class="n">prop_type_dummies</code><code class="p">)</code>
  <code class="n">PropertyTypeMultiplex</code> <code class="n">PropertyTypeSingle</code> <code class="n">Family</code> <code class="n">PropertyTypeTownhouse</code>
<code class="m">1</code>                     <code class="m">1</code>                         <code class="m">0</code>                     <code class="m">0</code>
<code class="m">2</code>                     <code class="m">0</code>                         <code class="m">1</code>                     <code class="m">0</code>
<code class="m">3</code>                     <code class="m">0</code>                         <code class="m">1</code>                     <code class="m">0</code>
<code class="m">4</code>                     <code class="m">0</code>                         <code class="m">1</code>                     <code class="m">0</code>
<code class="m">5</code>                     <code class="m">0</code>                         <code class="m">1</code>                     <code class="m">0</code>
<code class="m">6</code>                     <code class="m">0</code>                         <code class="m">0</code>                     <code class="m">1</code></pre>

<p>The function <code>model.matrix</code> converts a data frame into a matrix suitable to a linear model. The factor variable <code>PropertyType</code>, which has three distinct levels, is represented as a matrix with three columns.
In the machine learning community, this representation is referred to as <em>one hot encoding</em> (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch06.html#OneHotEncoder">“One Hot Encoder”</a>).<a data-type="indexterm" data-primary="one hot encoding" id="idm45909261608920"></a>
In certain machine learning algorithms, such as nearest neighbors and tree models,  one hot encoding is the standard way to represent factor variables (for example, see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch06.html#TreeModels">“Tree Models”</a>).</p>

<p>In the regression setting, a factor variable with <em>P</em> distinct levels is usually represented by a matrix with only <em>P</em> – 1 columns.
This is because a regression model typically includes an intercept term.
With an intercept, once you have defined the values for <span class="keep-together"><em>P</em> – 1</span> binaries,
the value for the <em>P</em>th is known and could be considered redundant.
Adding the <em>P</em>th  column will cause<a data-type="indexterm" data-primary="multicollinearity errors" id="idm45909261603816"></a> a multicollinearity error (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#Multicollinearity">“Multicollinearity”</a>).</p>

<p>The default representation in R <a data-type="indexterm" data-primary="reference coding" data-startref="refco_1k" id="idm45909261601896"></a>is to use the first factor level as a <em>reference</em> and interpret the remaining levels relative to that factor.</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code>
<code class="o">+</code>      <code class="n">Bedrooms</code> <code class="o">+</code>  <code class="n">BldgGrade</code> <code class="o">+</code> <code class="n">PropertyType</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">house</code><code class="p">)</code>

<code class="n">Call</code><code class="o">:</code>
<code class="nf">lm</code><code class="p">(</code><code class="n">formula</code> <code class="o">=</code> <code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code>
    <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code> <code class="o">+</code> <code class="n">PropertyType</code><code class="p">,</code> <code class="n">data</code> <code class="o">=</code> <code class="n">house</code><code class="p">)</code>

<code class="n">Coefficients</code><code class="o">:</code>
              <code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>              <code class="n">SqFtTotLiving</code>
               <code class="m">-4.469e+05</code>                  <code class="m">2.234e+02</code>
                  <code class="n">SqFtLot</code>                  <code class="n">Bathrooms</code>
               <code class="m">-7.041e-02</code>                 <code class="m">-1.597e+04</code>
                 <code class="n">Bedrooms</code>                  <code class="n">BldgGrade</code>
               <code class="m">-5.090e+04</code>                  <code class="m">1.094e+05</code>
<code class="n">PropertyTypeSingle</code> <code class="n">Family</code>      <code class="n">PropertyTypeTownhouse</code>
               <code class="m">-8.469e+04</code>                 <code class="m">-1.151e+05</code></pre>

<p>The output from the R regression shows two coefficients corresponding to <code>PropertyType</code>: <code>PropertyTypeSingle Family</code> and <code>PropertyTypeTownhouse</code>.
There is no coefficient of <code>Multiplex</code> since it is implicitly defined when  <code>PropertyTypeSingle Family == 0</code> and <code>PropertyTypeTownhouse == 0</code>.
The coefficients are interpreted as relative to <code>Multiplex</code>, so a home that is <code>Single Family</code> is worth almost $85,000 less, and a home that is <code>Townhouse</code> is worth over $150,000 less.<sup><a data-type="noteref" id="idm45909261494968-marker" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909261494968">4</a></sup></p>
<div data-type="warning" epub:type="warning"><h1>Different Factor Codings</h1>
<p>There are several different ways to encode factor variables, known as <em>contrast coding</em> systems.<a data-type="indexterm" data-primary="contrast coding systems" id="idm45909261491720"></a><a data-type="indexterm" data-primary="factor variables" data-secondary="different codings" id="idm45909261490984"></a>
For example, <em>deviation coding</em>, also know as <em>sum contrasts</em>, compares each level against the overall mean.<a data-type="indexterm" data-primary="sum contrasts" id="idm45909261488984"></a><a data-type="indexterm" data-primary="deviation coding" id="idm45909261488280"></a> Another contrast is <em>polynomial coding</em>, which is appropriate<a data-type="indexterm" data-primary="polynomial coding" id="idm45909261487064"></a> for ordered factors; see the section <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#OrderedFactorsRegression">“Ordered Factor Variables”</a>.
With the exception of ordered factors,
data scientists will generally not encounter any type of coding besides reference coding or one hot encoder.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Factor Variables with Many Levels"><div class="sect2" id="FactorVariablesManyLevels">
<h2>Factor Variables with Many Levels</h2>

<p>Some factor variables can produce a huge number of binary dummies—zip codes are a factor variable and there are 43,000 zip codes in the US.<a data-type="indexterm" data-primary="factor variables" data-secondary="with many levels" id="idm45909261483160"></a><a data-type="indexterm" data-primary="regression" data-secondary="factor variables in" data-tertiary="with many levels" id="idm45909261482184"></a> In such cases, it is useful to explore the data, and the relationships between predictor variables and the outcome, to determine whether useful information is contained in the categories.
If so, you must further decide whether it is useful to retain all factors, or whether the levels should be consolidated.</p>

<p>In King County, there are 82 zip codes with a house sale:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">table</code><code class="p">(</code><code class="n">house</code><code class="o">$</code><code class="n">ZipCode</code><code class="p">)</code>

 <code class="m">9800</code> <code class="m">89118</code> <code class="m">98001</code> <code class="m">98002</code> <code class="m">98003</code> <code class="m">98004</code> <code class="m">98005</code> <code class="m">98006</code> <code class="m">98007</code> <code class="m">98008</code> <code class="m">98010</code> <code class="m">98011</code>
    <code class="m">1</code>     <code class="m">1</code>   <code class="m">358</code>   <code class="m">180</code>   <code class="m">241</code>   <code class="m">293</code>   <code class="m">133</code>   <code class="m">460</code>   <code class="m">112</code>   <code class="m">291</code>    <code class="m">56</code>   <code class="m">163</code>
<code class="m">98014</code> <code class="m">98019</code> <code class="m">98022</code> <code class="m">98023</code> <code class="m">98024</code> <code class="m">98027</code> <code class="m">98028</code> <code class="m">98029</code> <code class="m">98030</code> <code class="m">98031</code> <code class="m">98032</code> <code class="m">98033</code>
   <code class="m">85</code>   <code class="m">242</code>   <code class="m">188</code>   <code class="m">455</code>    <code class="m">31</code>   <code class="m">366</code>   <code class="m">252</code>   <code class="m">475</code>   <code class="m">263</code>   <code class="m">308</code>   <code class="m">121</code>   <code class="m">517</code>
<code class="m">98034</code> <code class="m">98038</code> <code class="m">98039</code> <code class="m">98040</code> <code class="m">98042</code> <code class="m">98043</code> <code class="m">98045</code> <code class="m">98047</code> <code class="m">98050</code> <code class="m">98051</code> <code class="m">98052</code> <code class="m">98053</code>
  <code class="m">575</code>   <code class="m">788</code>    <code class="m">47</code>   <code class="m">244</code>   <code class="m">641</code>     <code class="m">1</code>   <code class="m">222</code>    <code class="m">48</code>     <code class="m">7</code>    <code class="m">32</code>   <code class="m">614</code>   <code class="m">499</code>
<code class="m">98055</code> <code class="m">98056</code> <code class="m">98057</code> <code class="m">98058</code> <code class="m">98059</code> <code class="m">98065</code> <code class="m">98068</code> <code class="m">98070</code> <code class="m">98072</code> <code class="m">98074</code> <code class="m">98075</code> <code class="m">98077</code>
  <code class="m">332</code>   <code class="m">402</code>     <code class="m">4</code>   <code class="m">420</code>   <code class="m">513</code>   <code class="m">430</code>     <code class="m">1</code>    <code class="m">89</code>   <code class="m">245</code>   <code class="m">502</code>   <code class="m">388</code>   <code class="m">204</code>
<code class="m">98092</code> <code class="m">98102</code> <code class="m">98103</code> <code class="m">98105</code> <code class="m">98106</code> <code class="m">98107</code> <code class="m">98108</code> <code class="m">98109</code> <code class="m">98112</code> <code class="m">98113</code> <code class="m">98115</code> <code class="m">98116</code>
  <code class="m">289</code>   <code class="m">106</code>   <code class="m">671</code>   <code class="m">313</code>   <code class="m">361</code>   <code class="m">296</code>   <code class="m">155</code>   <code class="m">149</code>   <code class="m">357</code>     <code class="m">1</code>   <code class="m">620</code>   <code class="m">364</code>
<code class="m">98117</code> <code class="m">98118</code> <code class="m">98119</code> <code class="m">98122</code> <code class="m">98125</code> <code class="m">98126</code> <code class="m">98133</code> <code class="m">98136</code> <code class="m">98144</code> <code class="m">98146</code> <code class="m">98148</code> <code class="m">98155</code>
  <code class="m">619</code>   <code class="m">492</code>   <code class="m">260</code>   <code class="m">380</code>   <code class="m">409</code>   <code class="m">473</code>   <code class="m">465</code>   <code class="m">310</code>   <code class="m">332</code>   <code class="m">287</code>    <code class="m">40</code>   <code class="m">358</code>
<code class="m">98166</code> <code class="m">98168</code> <code class="m">98177</code> <code class="m">98178</code> <code class="m">98188</code> <code class="m">98198</code> <code class="m">98199</code> <code class="m">98224</code> <code class="m">98288</code> <code class="m">98354</code>
  <code class="m">193</code>   <code class="m">332</code>   <code class="m">216</code>   <code class="m">266</code>   <code class="m">101</code>   <code class="m">225</code>   <code class="m">393</code>     <code class="m">3</code>     <code class="m">4</code>     <code class="m">9</code></pre>

<p><code>ZipCode</code> is  an important variable, since it is a proxy for the effect of location on the value of a house.
Including all levels requires 81 coefficients corresponding to 81 degrees of freedom.
The original model <code>house_lm</code> has only 5 degress of freedom; see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#RMSE">“Assessing the Model”</a>.
Moreover,  several zip codes have only one sale.
In some problems, you can consolidate a zip code using the first two or three digits, corresponding to a submetropolitan geographic region.
For King County, almost all of the sales occur in 980xx or 981xx, so this doesn’t help.</p>

<p>An alternative approach is to group the zip codes according to another variable, such as sale price.
Even better is to form zip code groups using the residuals from an initial model.
The following <code>dplyr</code> code consolidates the 82 zip codes into five groups based on the median of the residual from the  <code>house_lm</code> regression:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">zip_groups</code> <code class="o">&lt;-</code> <code class="n">house</code> <code class="o">%&gt;%</code>
  <code class="nf">mutate</code><code class="p">(</code><code class="n">resid</code> <code class="o">=</code> <code class="nf">residuals</code><code class="p">(</code><code class="n">house_lm</code><code class="p">))</code> <code class="o">%&gt;%</code>
  <code class="nf">group_by</code><code class="p">(</code><code class="n">ZipCode</code><code class="p">)</code> <code class="o">%&gt;%</code>
  <code class="nf">summarize</code><code class="p">(</code><code class="n">med_resid</code> <code class="o">=</code> <code class="nf">median</code><code class="p">(</code><code class="n">resid</code><code class="p">),</code>
            <code class="n">cnt</code> <code class="o">=</code> <code class="nf">n</code><code class="p">())</code> <code class="o">%&gt;%</code>
  <code class="nf">arrange</code><code class="p">(</code><code class="n">med_resid</code><code class="p">)</code> <code class="o">%&gt;%</code>
  <code class="nf">mutate</code><code class="p">(</code><code class="n">cum_cnt</code> <code class="o">=</code> <code class="nf">cumsum</code><code class="p">(</code><code class="n">cnt</code><code class="p">),</code>
         <code class="n">ZipGroup</code> <code class="o">=</code> <code class="nf">ntile</code><code class="p">(</code><code class="n">cum_cnt</code><code class="p">,</code> <code class="m">5</code><code class="p">))</code>
<code class="n">house</code> <code class="o">&lt;-</code> <code class="n">house</code> <code class="o">%&gt;%</code>
  <code class="nf">left_join</code><code class="p">(</code><code class="nf">select</code><code class="p">(</code><code class="n">zip_groups</code><code class="p">,</code> <code class="n">ZipCode</code><code class="p">,</code> <code class="n">ZipGroup</code><code class="p">),</code> <code class="n">by</code><code class="o">=</code><code class="s">'ZipCode'</code><code class="p">)</code></pre>

<p>The median residual is computed for each zip and the <code>ntile</code> function is used to split the zip codes, sorted by the median, into five groups. See <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#ConfoundingVariables">“Confounding Variables”</a> for an example of how this is used as a term in a regression improving upon the original fit.</p>

<p>The concept of using the residuals to help guide the regression fitting is a fundamental step in the modeling process; see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#RegressionDiagnostics">“Testing the Assumptions: Regression Diagnostics”</a>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Ordered Factor Variables"><div class="sect2" id="OrderedFactorsRegression">
<h2>Ordered Factor Variables</h2>

<p>Some factor variables reflect levels of a factor; these are termed <em>ordered factor variables</em> or <em>ordered categorical variables</em>.<a data-type="indexterm" data-primary="regression" data-secondary="factor variables in" data-tertiary="ordered factor variables" id="idm45909261007592"></a><a data-type="indexterm" data-primary="ordered factor variables" id="idm45909261006376"></a><a data-type="indexterm" data-primary="factor variables" data-secondary="ordered" id="idm45909261176936"></a>
For example, the loan grade could be A, B, C, and so on—each grade carries more risk than the prior grade.
Ordered factor variables can typically be converted to numerical values and used as is.
For example,
the variable <code>BldgGrade</code> is an ordered factor variable.
Several of the types of grades are shown in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#BldgGrade">Table&nbsp;4-1</a>.
While the grades have specific meaning,
the numeric value is ordered from low to high, corresponding to higher-grade homes.
With the regression model <code>house_lm</code>,
fit in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#MultipleLinearRegression">“Multiple Linear Regression”</a>,
<code>BldgGrade</code> was treated as a numeric variable.</p>
<table id="BldgGrade">
<caption><span class="label">Table 4-1. </span>A typical data format</caption>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>1</p></td>
<td><p>Cabin</p></td>
</tr>
<tr>
<td><p>2</p></td>
<td><p>Substandard</p></td>
</tr>
<tr>
<td><p>5</p></td>
<td><p>Fair</p></td>
</tr>
<tr>
<td><p>10</p></td>
<td><p>Very good</p></td>
</tr>
<tr>
<td><p>12</p></td>
<td><p>Luxury</p></td>
</tr>
<tr>
<td><p>13</p></td>
<td><p>Mansion</p></td>
</tr>
</tbody>
</table>

<p>Treating ordered factors as a numeric variable preserves the information contained in the ordering that would be lost if it were  converted to a factor.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909261158904">
<h5>Key Ideas</h5>
<ul>
<li>
<p>Factor variables need to be converted into numeric variables for use in a regression.</p>
</li>
<li>
<p>The most common method to encode a factor variable with P distinct values is to represent them using P-1 dummy variables.</p>
</li>
<li>
<p>A factor variable with many levels, even in very big data sets, may need to be consolidated into a variable with fewer levels.</p>
</li>
<li>
<p>Some factors have levels that are ordered and can be represented as a single numeric variable.<a data-type="indexterm" data-primary="factor variables" data-startref="ix_factorvar" id="idm45909261153944"></a><a data-type="indexterm" data-primary="regression" data-secondary="factor variables in" data-startref="ix_regrfactor" id="idm45909261152968"></a></p>
</li>
</ul>
</div></aside>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Interpreting the Regression Equation"><div class="sect1" id="InterpretingRegression">
<h1>Interpreting the Regression Equation</h1>

<p>In data science, the most important use of regression is to predict some dependent (outcome) variable.<a data-type="indexterm" data-primary="regression" data-secondary="interpreting the regression equation" id="ix_regrequat"></a>
In some cases, however, gaining insight from the equation itself to understand the nature of the relationship between the predictors and the outcome can be of value.
This section provides guidance on examining the regression equation and interpreting it.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909261147672">
<h5>Key Terms for Interpreting the Regression Equation</h5><dl>
<dt class="horizontal"><strong><em>Correlated variables</em></strong></dt>
<dd>
<p>When the predictor variables are highly correlated, it is difficult to interpret the individual coefficients.<a data-type="indexterm" data-primary="correlated variables" id="idm45909261144472"></a></p>
</dd>
<dt class="horizontal"><strong><em>Multicollinearity</em></strong></dt>
<dd>
<p>When the predictor variables have perfect, or near-perfect, correlation, the regression can be unstable or impossible to compute.<a data-type="indexterm" data-primary="multicollinearity" id="idm45909261141816"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>collinearity</p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Confounding variables</em></strong></dt>
<dd>
<p>An important predictor that, when omitted, leads to spurious relationships in a regression equation.<a data-type="indexterm" data-primary="confounding variables" id="idm45909261137400"></a></p>
</dd>
<dt class="horizontal"><strong><em>Main effects</em></strong></dt>
<dd>
<p>The relationship between a predictor and the outcome variable, independent from other variables.<a data-type="indexterm" data-primary="main effects" id="idm45909261134776"></a></p>
</dd>
<dt class="horizontal"><strong><em>Interactions</em></strong></dt>
<dd>
<p>An interdependent relationship between two or more predictors and the response.<a data-type="indexterm" data-primary="interactions" id="idm45909261132264"></a></p>
</dd>
</dl>
</div></aside>








<section data-type="sect2" data-pdf-bookmark="Correlated Predictors"><div class="sect2" id="CorrelatedPredictors">
<h2>Correlated Predictors</h2>

<p>In multiple regression, the predictor variables are often correlated with each other.<a data-type="indexterm" data-primary="regression" data-secondary="interpreting the regression equation" data-tertiary="correlated predictors" id="idm45909261129496"></a><a data-type="indexterm" data-primary="predictor variables" data-secondary="correlated" id="idm45909261128280"></a><a data-type="indexterm" data-primary="correlated variables" data-secondary="predictor variables" id="idm45909261127336"></a>
As an example,
examine the regression coefficients for the model <code>step_lm</code>, fit in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#StepwiseRegression">“Model Selection and Stepwise Regression”</a>:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">step_lm</code><code class="o">$</code><code class="nf">coefficients</code>
<code class="nf">              </code><code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>             <code class="n">SqFtTotLiving</code>
             <code class="m">6.227632e+06</code>              <code class="m">1.865012e+02</code>
                <code class="n">Bathrooms</code>                  <code class="n">Bedrooms</code>
             <code class="m">4.472172e+04</code>             <code class="m">-4.980718e+04</code>
                <code class="n">BldgGrade</code> <code class="n">PropertyTypeSingle</code> <code class="n">Family</code>
             <code class="m">1.391792e+05</code>              <code class="m">2.332869e+04</code>
    <code class="n">PropertyTypeTownhouse</code>           <code class="n">SqFtFinBasement</code>
             <code class="m">9.221625e+04</code>              <code class="m">9.039911e+00</code>
                  <code class="n">YrBuilt</code>
            <code class="m">-3.592468e+03</code></pre>

<p>The coefficient for  <code>Bedrooms</code> is  negative!
This implies that adding a bedroom to a house will reduce its value.
How can this be?
This is because the predictor variables are correlated: larger houses tend to have more bedrooms, and it is the size that drives house value, not the number of bedrooms.
Consider two homes of the exact same size:
it is reasonable to expect that a home with more, but smaller, bedrooms would be considered less desirable.</p>

<p>Having correlated predictors can make it difficult to interpret the sign and value of regression coefficients (and can inflate the standard error of the estimates).  The variables for bedrooms, house size, and number of bathrooms are all correlated.
This is illustrated by the following example, which fits another regression removing the variables <code>SqFtTotLiving</code>, <code>SqFtFinBasement</code>, and <code>Bathrooms</code> from the equation:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">update</code><code class="p">(</code><code class="n">step_lm</code><code class="p">,</code> <code class="n">. </code><code class="o">~</code> <code class="n">. </code><code class="o">-</code><code class="n">SqFtTotLiving</code> <code class="o">-</code> <code class="n">SqFtFinBasement</code> <code class="o">-</code> <code class="n">Bathrooms</code><code class="p">)</code>

<code class="n">Call</code><code class="o">:</code>
<code class="nf">lm</code><code class="p">(</code><code class="n">formula</code> <code class="o">=</code> <code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code> <code class="o">+</code> <code class="n">PropertyType</code> <code class="o">+</code>
    <code class="n">YrBuilt</code><code class="p">,</code> <code class="n">data</code> <code class="o">=</code> <code class="n">house0</code><code class="p">,</code> <code class="n">na.action</code> <code class="o">=</code> <code class="n">na.omit</code><code class="p">)</code>

<code class="n">Coefficients</code><code class="o">:</code>
              <code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>                   <code class="n">Bedrooms</code>
                  <code class="m">4834680</code>                      <code class="m">27657</code>
                <code class="n">BldgGrade</code>  <code class="n">PropertyTypeSingle</code> <code class="n">Family</code>
                   <code class="m">245709</code>                     <code class="m">-17604</code>
    <code class="n">PropertyTypeTownhouse</code>                    <code class="n">YrBuilt</code>
                   <code class="m">-47477</code>                      <code class="m">-3161</code></pre>

<p>The <code>update</code> function can be used to add or remove variables from a model. Now the coefficient for bedrooms is positive—in line with what we would expect (though it is really acting as a proxy for house size, now that those variables have been removed).</p>

<p>Correlated variables are only one issue with interpreting regression coefficients.
In <code>house_lm</code>, there is no variable to account for the location of the home,
and the model is mixing together very different types of regions.
Location may be a <em>confounding</em> variable;
see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#ConfoundingVariables">“Confounding Variables”</a> for further discussion.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Multicollinearity"><div class="sect2" id="Multicollinearity">
<h2>Multicollinearity</h2>

<p>An extreme case of correlated variables produces multicollinearity—a condition in which there is redundance among the predictor variables.<a data-type="indexterm" data-primary="correlated variables" data-secondary="multicollinearity" id="idm45909260883656"></a><a data-type="indexterm" data-primary="regression" data-secondary="interpreting the regression equation" data-tertiary="multicollinearity" id="idm45909260882680"></a><a data-type="indexterm" data-primary="multicollinearity" id="idm45909260881496"></a>
Perfect multicollinearity occurs when one predictor variable can be expressed as a linear combination of others.
Multicollinearity occurs when:</p>

<ul>
<li>
<p>A variable is included multiple times by error.</p>
</li>
<li>
<p><em>P</em> dummies, instead of <em>P</em> – 1 dummies, are created from a factor variable (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#FactorsRegression">“Factor Variables in Regression”</a>).</p>
</li>
<li>
<p>Two variables are nearly perfectly correlated with one another.</p>
</li>
</ul>

<p>Multicollinearity in regression must be addressed—variables should be removed until the multicollinearity is gone.
A regression does not have a well-defined solution in the presence of perfect multicollinearity.
Many software packages, including R,
automatically handle certain types of multicolliearity.
For example, if <code>SqFtTotLiving</code> is included twice in the regression of the <code>house</code> data, the results are the same as for the <code>house_lm</code> model.
In the  case of nonperfect multicollinearity, the software may obtain a solution but the results may be unstable.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Multicollinearity is not such a problem for nonregression methods like trees, clustering, and nearest-neighbors, and in such methods it may be advisable to retain <em>P</em> dummies (instead of <em>P</em> – 1).
That said, even in those methods, nonredundancy in predictor variables is still a virtue.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Confounding Variables"><div class="sect2" id="ConfoundingVariables">
<h2>Confounding Variables</h2>

<p>With correlated variables, the problem is one of commission:
including different variables that have a similar predictive relationship with the response.<a data-type="indexterm" data-primary="confounding variables" id="idm45909260869256"></a><a data-type="indexterm" data-primary="regression" data-secondary="interpreting the regression equation" data-tertiary="confounding variables" id="idm45909260868552"></a>
With <em>confounding variables</em>, the problem is one of omission:
an important variable is not included in the regression equation.
Naive interpretation of the equation coefficients can lead to invalid conclusions.</p>

<p>Take, for example, the King County regression equation <code>house_lm</code> from <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#KingCountyHousingData">“Example: King County Housing Data”</a>.
The regression coefficients of <code>SqFtLot</code>, <code>Bathrooms</code>, and <code>Bedrooms</code> are all negative.
The original regression model does not contain a variable to represent location—a very important predictor of house price.
To model location, include a variable <code>ZipGroup</code> that categorizes the zip code into one of five groups, from least expensive (1) to most expensive (5).<sup><a data-type="noteref" id="idm45909260862712-marker" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909260862712">5</a></sup></p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code>  <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code>
     <code class="n">Bathrooms</code> <code class="o">+</code> <code class="n">Bedrooms</code> <code class="o">+</code>
     <code class="n">BldgGrade</code> <code class="o">+</code> <code class="n">PropertyType</code> <code class="o">+</code> <code class="n">ZipGroup</code><code class="p">,</code>
   <code class="n">data</code><code class="o">=</code><code class="n">house</code><code class="p">,</code> <code class="n">na.action</code><code class="o">=</code><code class="n">na.omit</code><code class="p">)</code>

<code class="n">Coefficients</code><code class="o">:</code>
              <code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>              <code class="n">SqFtTotLiving</code>
               <code class="m">-6.709e+05</code>                  <code class="m">2.112e+02</code>
                  <code class="n">SqFtLot</code>                  <code class="n">Bathrooms</code>
                <code class="m">4.692e-01</code>                  <code class="m">5.537e+03</code>
                 <code class="n">Bedrooms</code>                  <code class="n">BldgGrade</code>
               <code class="m">-4.139e+04</code>                  <code class="m">9.893e+04</code>
<code class="n">PropertyTypeSingle</code> <code class="n">Family</code>      <code class="n">PropertyTypeTownhouse</code>
                <code class="m">2.113e+04</code>                 <code class="m">-7.741e+04</code>
                <code class="n">ZipGroup2</code>                  <code class="n">ZipGroup3</code>
                <code class="m">5.169e+04</code>                  <code class="m">1.142e+05</code>
                <code class="n">ZipGroup4</code>                  <code class="n">ZipGroup5</code>
                <code class="m">1.783e+05</code>                  <code class="m">3.391e+05</code></pre>

<p><code>ZipGroup</code> is clearly an important variable:
a home in the most expensive zip code group is estimated to have a higher sales price by almost $340,000.
The coefficients of <code>SqFtLot</code> and <code>Bathrooms</code> are now positive and
adding a bathroom increases the sale price by $5,537.</p>

<p>The coefficient for <code>Bedrooms</code> is still negative.
While this is unintuitive, this is a well-known phenomenon in real estate.
For homes of the same livable area and number of bathrooms,
having more, and therefore smaller, bedrooms is associated with less valuable homes.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Interactions and Main Effects"><div class="sect2" id="Interactions">
<h2>Interactions and Main Effects</h2>

<p>Statisticians like to distinguish between <em>main effects</em>,
or independent variables,
and the <em>interactions</em> between the main effects.<a data-type="indexterm" data-primary="independent variables" data-secondary="main effects" id="idm45909260750664"></a><a data-type="indexterm" data-primary="regression" data-secondary="interpreting the regression equation" data-tertiary="interactions and main effects" id="idm45909260749688"></a><a data-type="indexterm" data-primary="main effects" data-secondary="interactions and" id="idm45909260748392"></a><a data-type="indexterm" data-primary="interactions" data-secondary="and main effects" id="idm45909260747448"></a>
Main effects are what are often referred to as the <em>predictor variables</em> in the regression equation.<a data-type="indexterm" data-primary="predictor variables" data-secondary="main effects" id="idm45909260745992"></a>
An implicit assumption when only main effects are used in a model is that the relationship between a predictor variable and the response is independent of the other predictor variables.
This is often not the case.</p>

<p>For example, the model fit to the King County Housing Data in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#ConfoundingVariables">“Confounding Variables”</a> includes several variables as main effects,
including <code>ZipCode</code>.
Location in real estate is everything, and it is natural to presume that the relationship between, say, house size and the sale price depends on location.
A big house built in a low-rent district is not going to retain the same value as a big house built in an expensive area.
You include interactions between variables in R using the <code>*</code> operator.
For the King County data, the following fits an interaction between <code>SqFtTotLiving</code> and <code>ZipGroup</code>:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code>  <code class="n">SqFtTotLiving</code><code class="o">*</code><code class="n">ZipGroup</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code>
     <code class="n">Bathrooms</code> <code class="o">+</code> <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code> <code class="o">+</code> <code class="n">PropertyType</code><code class="p">,</code>
   <code class="n">data</code><code class="o">=</code><code class="n">house</code><code class="p">,</code> <code class="n">na.action</code><code class="o">=</code><code class="n">na.omit</code><code class="p">)</code>

 <code class="n">Coefficients</code><code class="o">:</code>
              <code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>              <code class="n">SqFtTotLiving</code>
               <code class="m">-4.919e+05</code>                  <code class="m">1.176e+02</code>
                <code class="n">ZipGroup2</code>                  <code class="n">ZipGroup3</code>
               <code class="m">-1.342e+04</code>                  <code class="m">2.254e+04</code>
                <code class="n">ZipGroup4</code>                  <code class="n">ZipGroup5</code>
                <code class="m">1.776e+04</code>                 <code class="m">-1.555e+05</code>
                  <code class="n">SqFtLot</code>                  <code class="n">Bathrooms</code>
                <code class="m">7.176e-01</code>                 <code class="m">-5.130e+03</code>
                 <code class="n">Bedrooms</code>                  <code class="n">BldgGrade</code>
               <code class="m">-4.181e+04</code>                  <code class="m">1.053e+05</code>
<code class="n">PropertyTypeSingle</code> <code class="n">Family</code>      <code class="n">PropertyTypeTownhouse</code>
                <code class="m">1.603e+04</code>                 <code class="m">-5.629e+04</code>
  <code class="n">SqFtTotLiving</code><code class="o">:</code><code class="n">ZipGroup2</code>    <code class="n">SqFtTotLiving</code><code class="o">:</code><code class="n">ZipGroup3</code>
                <code class="m">3.165e+01</code>                  <code class="m">3.893e+01</code>
  <code class="n">SqFtTotLiving</code><code class="o">:</code><code class="n">ZipGroup4</code>    <code class="n">SqFtTotLiving</code><code class="o">:</code><code class="n">ZipGroup5</code>
                <code class="m">7.051e+01</code>                  <code class="m">2.298e+02</code></pre>

<p>The resulting model has four new terms:
<code>SqFtTotLiving:ZipGroup2</code>, <code>SqFtTotLiving:ZipGroup3</code>, and so on.</p>

<p>Location and house size appear to have a strong interaction.
For a home in the lowest <code>ZipGroup</code>,
the slope is the same as the slope for the main effect <code>SqFtTotLiving</code>,
which is $118 per square foot (this is because R uses <em>reference</em> coding for factor variables; see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#FactorsRegression">“Factor Variables in Regression”</a>).<a data-type="indexterm" data-primary="factor variables" data-secondary="reference coding" id="idm45909260650872"></a><a data-type="indexterm" data-primary="reference coding" id="idm45909260649896"></a>
For a home in the highest <code>ZipGroup</code>,
the slope is the sum of the main effect plus <code>SqFtTotLiving:ZipGroup5</code>,
or $118 + $230 = $348 per square foot.
In other words,
adding a square foot in the most expensive zip code group boosts the predicted sale price by a factor of almost 2.9, compared to the boost in the least expensive zip code group.</p>
<div data-type="tip"><h1>Model Selection with Interaction Terms</h1>
<p>In problems involving many variables,
it can be challenging to decide which interaction terms should be included in the model.<a data-type="indexterm" data-primary="interactions" data-secondary="deciding which interaction terms to include in the model" id="idm45909260646696"></a>
Several different approaches are commonly taken:</p>

<ul>
<li>
<p>In some problems,
prior knowledge and intuition can guide the choice of which interaction terms to include in the model.</p>
</li>
<li>
<p>Stepwise selection (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#StepwiseRegression">“Model Selection and Stepwise Regression”</a>) can be used to sift through the various models.</p>
</li>
<li>
<p>Penalized regression can automatically fit to a large set of possible interaction terms.<a data-type="indexterm" data-primary="tree models" id="idm45909260641640"></a><a data-type="indexterm" data-primary="random forests" id="idm45909260640936"></a></p>
</li>
<li>
<p>Perhaps the most common approach is the use <em>tree models</em>,
as well as their descendents, <em>random forest</em> and <em>gradient boosted trees</em>.<a data-type="indexterm" data-primary="gradient boosted trees" id="idm45909260637960"></a>
This class of models automatically searches for optimal interaction terms; see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch06.html#TreeModels">“Tree Models”</a>.</p>
</li>
</ul>
</div>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909260635912">
<h5>Key Ideas</h5>
<ul>
<li>
<p>Because of correlation between predictors, care must be taken in the interpretation of the coefficients in multiple linear regression.</p>
</li>
<li>
<p>Multicollinearity can cause numerical instability in fitting the regression equation.</p>
</li>
<li>
<p>A confounding variable is an important predictor that is omitted from a model and can lead to a regression equation with spurious relationships.</p>
</li>
<li>
<p>An interaction term between two variables is needed if the relationship between the variables and the response is interdependent.<a data-type="indexterm" data-primary="regression" data-secondary="interpreting the regression equation" data-startref="ix_regrequat" id="idm45909260630808"></a></p>
</li>
</ul>
</div></aside>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Testing the Assumptions: Regression Diagnostics"><div class="sect1" id="RegressionDiagnostics">
<h1>Testing the Assumptions: Regression Diagnostics</h1>

<p>In explanatory modeling (i.e., in a research context), various steps, in addition to the metrics mentioned previously (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#RMSE">“Assessing the Model”</a>), are taken to assess how well the model fits the data.<a data-type="indexterm" data-primary="regression" data-secondary="diagnostics" id="ix_regrdiag"></a>
Most are based on analysis of the residuals, which can test the assumptions underlying the model.
These steps do not directly address predictive accuracy, but they can provide useful insight in a predictive setting.</p>
<aside data-type="sidebar" epub:type="sidebar" class="pagebreak-before"><div class="sidebar" id="idm45909260624568">
<h5>Key Terms for Regression Diagnostics</h5><dl>
<dt class="horizontal"><strong><em>Standardized residuals</em></strong></dt>
<dd>
<p>Residuals divided by the standard error of the residuals.<a data-type="indexterm" data-primary="residuals" data-secondary="standardized" id="idm45909260621192"></a><a data-type="indexterm" data-primary="standardized residuals" id="idm45909260620136"></a></p>
</dd>
<dt class="horizontal"><strong><em>Outliers</em></strong></dt>
<dd>
<p>Records (or outcome values) that <a data-type="indexterm" data-primary="outliers" id="idm45909260617656"></a>are distant from the rest of the data (or the predicted outcome).</p>
</dd>
<dt class="horizontal"><strong><em>Influential value</em></strong></dt>
<dd>
<p>A value or record whose presence or absence makes a big difference in the regression equation.<a data-type="indexterm" data-primary="influential values" id="idm45909260614824"></a></p>
</dd>
<dt class="horizontal"><strong><em>Leverage</em></strong></dt>
<dd>
<p>The degree of influence that a single record has on a regression equation.<a data-type="indexterm" data-primary="leverage" id="idm45909260612312"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>hat-value<a data-type="indexterm" data-primary="hat-value" id="idm45909260609944"></a></p>
</dd>
</dl>
</dd>
<dt class="horizontal"><strong><em>Non-normal residuals</em></strong></dt>
<dd>
<p>Non-normally distributed residuals can invalidate some technical requirements of regression, but are usually not a concern in data science.<a data-type="indexterm" data-primary="non-normal residuals" id="idm45909260606984"></a></p>
</dd>
<dt class="horizontal"><strong><em>Heteroskedasticity</em></strong></dt>
<dd>
<p>When some ranges of the<a data-type="indexterm" data-primary="heteroskedasticity" id="idm45909260604472"></a> outcome experience residuals with higher variance (may indicate a predictor missing from the equation).</p>
</dd>
<dt class="horizontal"><strong><em>Partial residual plots</em></strong></dt>
<dd>
<p>A diagnostic plot to illuminate the relationship between the outcome variable and a single predictor.<a data-type="indexterm" data-primary="partial residual plots" id="idm45909260601560"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>added variables plot</p>
</dd>
</dl>
</dd>
</dl>
</div></aside>








<section data-type="sect2" data-pdf-bookmark="Outliers"><div class="sect2" id="regression_outliers">
<h2>Outliers</h2>

<p>Generally speaking, an extreme value, also called an <em>outlier</em>, is one that is distant from most of the other observations.<a data-type="indexterm" data-primary="outliers" data-secondary="in regression" id="idm45909260596328"></a><a data-type="indexterm" data-primary="regression" data-secondary="diagnostics" data-tertiary="outliers" id="idm45909260595272"></a>
Just as outliers need to be handled for estimates of location and variability
(see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch01.html#Location">“Estimates of Location”</a> and <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch01.html#Variability">“Estimates of Variability”</a>),
outliers can cause problems with regression models.
In regression, an outlier is a record whose actual <em>y</em> value is distant from the predicted value.
You can detect outliers by examining the <em>standardized residual</em>, which is the residual divided by the standard error of the residuals.<a data-type="indexterm" data-primary="standardized residuals" data-secondary="examining to detect outliers" id="idm45909260591368"></a></p>

<p>There is no statistical theory that separates outliers from nonoutliers.  Rather, there are (arbitrary) rules of thumb for how distant from the bulk of the data an observation needs to be in order to be called an outlier.
For example,
with the boxplot,<a data-type="indexterm" data-primary="boxplots" data-secondary="outliers in" id="idm45909260589816"></a> outliers are those data points that are too far above or below the box boundaries (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch01.html#Boxplots">“Percentiles and Boxplots”</a>), where “too far” = “more than 1.5 times the inter-quartile range.”
In regression, the standardized residual is the metric that is typically used to determine whether a record is classified as an outlier.
Standardized residuals can be interpreted as “the number of standard errors away from the regression line.”</p>

<p>Let’s fit a regression to the King County house sales data for all sales in zip code 98105:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">house_98105</code> <code class="o">&lt;-</code> <code class="n">house</code><code class="p">[</code><code class="n">house</code><code class="o">$</code><code class="n">ZipCode</code> <code class="o">==</code> <code class="m">98105</code><code class="p">,]</code>
<code class="n">lm_98105</code> <code class="o">&lt;-</code> <code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="n">SqFtTotLiving</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code>
                 <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code><code class="p">,</code> <code class="n">data</code><code class="o">=</code><code class="n">house_98105</code><code class="p">)</code></pre>

<p>We extract the standardized residuals using the <code>rstandard</code> function and obtain the index of the smallest residual using the <code>order</code> function:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">sresid</code> <code class="o">&lt;-</code> <code class="nf">rstandard</code><code class="p">(</code><code class="n">lm_98105</code><code class="p">)</code>
<code class="n">idx</code> <code class="o">&lt;-</code> <code class="nf">order</code><code class="p">(</code><code class="n">sresid</code><code class="p">)</code>
<code class="n">sresid</code><code class="p">[</code><code class="n">idx</code><code class="p">[</code><code class="m">1</code><code class="p">]]</code>
    <code class="m">20431</code>
<code class="m">-4.326732</code></pre>

<p>The biggest overestimate from the model is more than four standard errors above the regression line, corresponding to an overestimate of $757,753.
The original data record corresponding to this outlier is as follows:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">house_98105</code><code class="p">[</code><code class="n">idx</code><code class="p">[</code><code class="m">1</code><code class="p">],</code> <code class="nf">c</code><code class="p">(</code><code class="s">'AdjSalePrice'</code><code class="p">,</code> <code class="s">'SqFtTotLiving'</code><code class="p">,</code> <code class="s">'SqFtLot'</code><code class="p">,</code>
              <code class="s">'Bathrooms'</code><code class="p">,</code> <code class="s">'Bedrooms'</code><code class="p">,</code> <code class="s">'BldgGrade'</code><code class="p">)]</code>

<code class="n">AdjSalePrice</code> <code class="n">SqFtTotLiving</code> <code class="n">SqFtLot</code> <code class="n">Bathrooms</code> <code class="n">Bedrooms</code> <code class="nf">BldgGrade</code>
<code class="nf">         </code><code class="p">(</code><code class="n">dbl</code><code class="p">)</code>         <code class="p">(</code><code class="n">int</code><code class="p">)</code>   <code class="p">(</code><code class="n">int</code><code class="p">)</code>     <code class="p">(</code><code class="n">dbl</code><code class="p">)</code>    <code class="p">(</code><code class="n">int</code><code class="p">)</code>     <code class="p">(</code><code class="n">int</code><code class="p">)</code>
<code class="m">1</code>       <code class="m">119748</code>          <code class="m">2900</code>    <code class="m">7276</code>         <code class="m">3</code>        <code class="m">6</code>         <code class="m">7</code></pre>

<p>In this case, it appears that there is something wrong with the record:
a house of that size typically sells for much more than $119,748 in that zip code.
<a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#StatutoryDeed">Figure&nbsp;4-4</a> shows an excerpt from the statutory deed from this sale: it is clear that the sale involved only partial interest in the property.
In this case, the outlier corresponds to a sale that is anomalous and should not be included in the regression.
Outliers could also be the result of other problems,
such as a “fat-finger” data entry or a mismatch of units (e.g., reporting a sale in thousands of dollars versus simply dollars).</p>

<figure><div id="StatutoryDeed" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0404.png" alt="Statutory warrant of deed for the largest negative residual" width="1075" height="236">
<h6><span class="label">Figure 4-4. </span>Statutory warrant of deed for the largest negative residual</h6>
</div></figure>

<p>For big data problems, outliers are generally not a problem in fitting the regression to be used in predicting new data.<a data-type="indexterm" data-primary="big data" data-secondary="and outliers in regression" id="idm45909260348584"></a>
However, outliers are central to anomaly detection, where finding outliers is the whole point.
The outlier could also correspond to a case of fraud or an accidental action.
In any case, detecting  outliers can be a critical business need.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Influential Values"><div class="sect2" id="idm45909260598344">
<h2>Influential Values</h2>

<p>A value whose absence would significantly change the regression equation is termed an <em>infuential observation</em>.<a data-type="indexterm" data-primary="influential values" id="idm45909260344920"></a><a data-type="indexterm" data-primary="regression" data-secondary="diagnostics" data-tertiary="influential values" id="idm45909260344184"></a>
In regression,
such a value need not be associated with a large residual.
As an example,
consider the regression lines in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#InfluenceExample">Figure&nbsp;4-5</a>.
The solid line corresponds to the regression with all the data, while the dashed line corresonds to the regression with the point in the upper-right removed.
Clearly, that data value has a huge influence on the regression even though it is not associated with a large outlier (from the full regression).
This data value is considered to have high <em>leverage</em> on the regression.<a data-type="indexterm" data-primary="leverage" data-secondary="influential values in regression" id="idm45909260341144"></a></p>

<p>In addition to standardized residuals (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#regression_outliers">“Outliers”</a>),
statisticians have developed several metrics to determine the influence of a single record on a regression.
A common measure<a data-type="indexterm" data-primary="hat-value" id="idm45909260338936"></a> of leverage is the <em>hat-value</em>;
values above <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mrow>
    <mn>2</mn>
    <mo>(</mo>
    <mi>P</mi>
    <mo>+</mo>
    <mn>1</mn>
    <mo>)</mo>
    <mo>/</mo>
    <mi>n</mi>
  </mrow>
</math> indicate a high-leverage data value.<sup><a data-type="noteref" id="idm45909260333080-marker" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909260333080">6</a></sup></p>

<figure><div id="InfluenceExample" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0405.png" alt="An example of an influential data point in regression" width="1118" height="1119">
<h6><span class="label">Figure 4-5. </span>An example of an influential data point in regression</h6>
</div></figure>

<p>Another metric is <em>Cook’s distance</em>, which defines influence as a combination of leverage and residual size.<a data-type="indexterm" data-primary="Cook&#39;s distance" id="idm45909260323560"></a>
A rule of thumb is that an observation has high influence if Cook’s distance exceeds <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mrow>
    <mn>4</mn>
    <mo>/</mo>
    <mo>(</mo>
    <mi>n</mi>
    <mo>-</mo>
    <mi>P</mi>
    <mo>-</mo>
    <mn>1</mn>
    <mo>)</mo>
  </mrow>
</math>.</p>

<p>An <em>influence plot</em> or <em>bubble plot</em> combines standardized residuals, the hat-value, and Cook’s distance in a single plot.<a data-type="indexterm" data-primary="bubble plots" id="idm45909260316088"></a><a data-type="indexterm" data-primary="influence plots" id="idm45909260315384"></a>
<a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#InfluencePlot">Figure&nbsp;4-6</a> shows the influence plot for the King County house data,
and can be created by the following R code.</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">std_resid</code> <code class="o">&lt;-</code> <code class="nf">rstandard</code><code class="p">(</code><code class="n">lm_98105</code><code class="p">)</code>
<code class="n">cooks_D</code> <code class="o">&lt;-</code> <code class="nf">cooks.distance</code><code class="p">(</code><code class="n">lm_98105</code><code class="p">)</code>
<code class="n">hat_values</code> <code class="o">&lt;-</code> <code class="nf">hatvalues</code><code class="p">(</code><code class="n">lm_98105</code><code class="p">)</code>
<code class="nf">plot</code><code class="p">(</code><code class="n">hat_values</code><code class="p">,</code> <code class="n">std_resid</code><code class="p">,</code> <code class="n">cex</code><code class="o">=</code><code class="m">10</code><code class="o">*</code><code class="nf">sqrt</code><code class="p">(</code><code class="n">cooks_D</code><code class="p">))</code>
<code class="nf">abline</code><code class="p">(</code><code class="n">h</code><code class="o">=</code><code class="nf">c</code><code class="p">(</code><code class="m">-2.5</code><code class="p">,</code> <code class="m">2.5</code><code class="p">),</code> <code class="n">lty</code><code class="o">=</code><code class="m">2</code><code class="p">)</code></pre>

<p>There are apparently several data points that exhibit large influence in the regression. Cook’s distance can be computed using the function <code>cooks.distance</code>, and you can use <code>hatvalues</code> to compute the diagnostics. The hat values are plotted on the x-axis, the residuals are plotted on the y-axis, and the size of the points is related to the value of Cook’s distance.</p>

<figure><div id="InfluencePlot" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0406.png" alt="A plot to determine which observations have high influence" width="1178" height="1188">
<h6><span class="label">Figure 4-6. </span>A plot to determine which observations have high influence</h6>
</div></figure>

<p><a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#InfluenceTable">Table&nbsp;4-2</a> compares the regression with the full data set and with highly influential data points removed.
The regression coefficient for <code>Bathrooms</code> changes quite dramatically.<sup><a data-type="noteref" id="idm45909260255592-marker" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909260255592">7</a></sup></p>
<table id="InfluenceTable">
<caption><span class="label">Table 4-2. </span>Comparison of regression coefficients with the full data and with influential data removed</caption>
<thead>
<tr>
<th></th>
<th>Original</th>
<th>Influential removed</th>
</tr>
</thead>
<tbody>
<tr>
<td><p>(Intercept)</p></td>
<td><p>–772550</p></td>
<td><p>–647137</p></td>
</tr>
<tr>
<td><p>SqFtTotLiving</p></td>
<td><p>210</p></td>
<td><p>230</p></td>
</tr>
<tr>
<td><p>SqFtLot</p></td>
<td><p>39</p></td>
<td><p>33</p></td>
</tr>
<tr>
<td><p>Bathrooms</p></td>
<td><p>2282</p></td>
<td><p>–16132</p></td>
</tr>
<tr>
<td><p>Bedrooms</p></td>
<td><p>–26320</p></td>
<td><p>–22888</p></td>
</tr>
<tr>
<td><p>BldgGrade</p></td>
<td><p>130000</p></td>
<td><p>114871</p></td>
</tr>
</tbody>
</table>

<p>For purposes of fitting a regression that reliably predicts future data, identifying influential observations is only useful in smaller data sets.
For regressions involving  many records,
it is unlikely that  any one observation will carry sufficient weight to cause extreme influence on the fitted equation
(although the regression may still have big outliers).
For purposes of anomaly detection, though, identifying influential observations can be very useful.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Heteroskedasticity, Non-Normality and Correlated Errors"><div class="sect2" id="idm45909260346664">
<h2>Heteroskedasticity, Non-Normality and Correlated Errors</h2>

<p>Statisticians pay considerable attention to the distribution of the residuals.
It turns out that ordinary least squares (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#OLS">“Least Squares”</a>) are unbiased, and in some cases the “optimal” estimator,
under a wide range of  distributional assumptions.<a data-type="indexterm" data-primary="regression" data-secondary="diagnostics" data-tertiary="heteroskedasticity, non-normality, and correlated errors" id="idm45909260233048"></a><a data-type="indexterm" data-primary="residuals" data-secondary="distribution of" id="idm45909260231864"></a><a data-type="indexterm" data-primary="ordinary least squares (OLS)" id="idm45909260230920"></a>
This means that in most problems, data scientists do not need to be too concerned with the distribution of the residuals.</p>

<p>The distribution of the residuals is relevant mainly for the validity of formal statistical inference (hypothesis tests and p-values), which is of minimal importance to data scientists concerned mainly with predictive accuracy.
For formal inference to be fully valid, the residuals are assumed to be normally distributed, have the same variance, and be independent.
One area where this may be of concern to data scientists is the standard calculation of confidence intervals for predicted values,
which are based upon the assumptions about the residuals (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#RegressionCIs">“Confidence and Prediction Intervals”</a>).</p>

<p><em>Heteroskedasticity</em> is the lack of constant residual variance across the range of the predicted values.<a data-type="indexterm" data-primary="heteroskedasticity" id="idm45909260227512"></a>
In other words, errors are greater for some portions of the range than for others.
The <code>ggplot2</code> package has some convenient tools to analyze residuals.</p>

<p>The following code plots the absolute residuals versus the predicted values for the <code>lm_98105</code> regression fit in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#regression_outliers">“Outliers”</a>.</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">df</code> <code class="o">&lt;-</code> <code class="nf">data.frame</code><code class="p">(</code>
  <code class="n">resid</code> <code class="o">=</code> <code class="nf">residuals</code><code class="p">(</code><code class="n">lm_98105</code><code class="p">),</code>
  <code class="n">pred</code> <code class="o">=</code> <code class="nf">predict</code><code class="p">(</code><code class="n">lm_98105</code><code class="p">))</code>
<code class="nf">ggplot</code><code class="p">(</code><code class="n">df</code><code class="p">,</code> <code class="nf">aes</code><code class="p">(</code><code class="n">pred</code><code class="p">,</code> <code class="nf">abs</code><code class="p">(</code><code class="n">resid</code><code class="p">)))</code> <code class="o">+</code>
  <code class="nf">geom_point</code><code class="p">()</code> <code class="o">+</code>
  <code class="nf">geom_smooth</code><code class="p">()</code></pre>

<p><a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#HouseHetero">Figure&nbsp;4-7</a> shows the resulting plot.
Using <code>geom_smooth</code>, it is easy to superpose a smooth of the absolute residuals.  The function calls the <code>loess</code> method to produce a visual smooth to estimate the relationship between the variables on the x-axis and y-axis in a scatterplot (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#ScatterplotSmoothers">Scatterplot Smoothers</a>).</p>

<figure class="width-75"><div id="HouseHetero" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0407.png" alt="A plot of the absolute value of the residuals versus the predicted values" width="1157" height="1167">
<h6><span class="label">Figure 4-7. </span>A plot of the absolute value of the residuals versus the predicted values</h6>
</div></figure>

<p>Evidently, the variance of the residuals tends to increase for higher-valued homes, but is also large for lower-valued homes.<a data-type="indexterm" data-primary="heteroskedastic errors" id="idm45909260145864"></a>
This plot indicates that <code>lm_98105</code> has <em>heteroskedastic</em> errors.</p>
<div data-type="tip"><h1>Why Would a Data Scientist Care about Heteroskedasticity?</h1>
<p>Heteroskedasticity indicates that prediction errors differ for different ranges of the predicted value, and may suggest an incomplete model.  For example, the heteroskedasticity in <code>lm_98105</code> may indicate that the regression has left something unaccounted for in high- and low-range homes.</p>
</div>

<p><a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#HistRegression">Figure&nbsp;4-8</a> is a histogram of the standarized residuals for the <code>lm_98105</code> regression.
The distribution has decidely longer tails than the normal distribution, and exhibits mild skewness toward larger residuals.</p>

<figure class="width-75"><div id="HistRegression" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0408.png" alt="A histogram of the residuals from the regression of the housing data" width="1152" height="1178">
<h6><span class="label">Figure 4-8. </span>A histogram of the residuals from the regression of the housing data</h6>
</div></figure>

<p>Statisticians may also check the assumption that the errors are independent.
This is particularly true for data that is collected over time.
The <em>Durbin-Watson</em> statistic can be used to detect if there is significant autocorrelation in a regression involving time series data.<a data-type="indexterm" data-primary="Durbin-Watson statistic" id="idm45909260137064"></a></p>

<p>Even though a regression may violate one of the distributional assumptions, should we care?
Most often in data science, the interest is primarily in predictive accuracy, so some review of heteroskedasticity may be in order.  You may discover that there is some signal in the data that your model has not captured. Satisfying distributional assumptions simply for the sake of validating formal statistical inference (p-values, F-statistics, etc.), however, is not that important for the data scientist.</p>
<div data-type="note" epub:type="note" id="ScatterplotSmoothers"><h1>Scatterplot Smoothers</h1>
<p>Regression is about modeling the relationship between the response and predictor variables.<a data-type="indexterm" data-primary="regression" data-secondary="diagnostics" data-tertiary="using scatterplot smoothers" id="idm45909260133784"></a><a data-type="indexterm" data-primary="scatterplot smoothers" id="idm45909260132568"></a>
In evaluating a regression model, it is useful to use a <em>scatterplot smoother</em> to visually highlight relationships between two variables.</p>

<p>For example, in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#HouseHetero">Figure&nbsp;4-7</a>, a smooth of the relationship between the absolute residuals and the predicted value shows that the variance of the residuals depends on the value of the residual.
In this case, the <code>loess</code> function was used; <code>loess</code> works by repeatedly fitting a series of local regressions to contiguous subsets to come up with a smooth.
While <code>loess</code> is probably the most commonly used smoother,
other scatterplot smoothers are available in R, such as super smooth (<code>supsmu</code>) and kernel smoothing (<code>ksmooth</code>).
For the purposes of evaluating a regression model, there is typically no need to worry about the details of these scatterplot smooths.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Partial Residual Plots and Nonlinearity"><div class="sect2" id="PartialResidualPlots">
<h2>Partial Residual Plots and Nonlinearity</h2>

<p><em>Partial residual plots</em> are a way to visualize how well the estimated fit explains the relationship between a predictor and the outcome.<a data-type="indexterm" data-primary="regression" data-secondary="diagnostics" data-tertiary="parial residual plots and nonlinearity" id="idm45909260124616"></a><a data-type="indexterm" data-primary="partial residual plots" id="idm45909260123352"></a>
Along with detection of outliers,
this is probably the most important diagnostic for data scientists.
The basic idea of a partial residual plot is to isolate the relationship between a predictor variable and the response, <em>taking into account all of the other predictor variables</em>.<a data-type="indexterm" data-primary="predictor variables" data-secondary="relationship between response and" id="idm45909260121928"></a><a data-type="indexterm" data-primary="response" data-secondary="relationship between predictor variable and" id="idm45909260120856"></a>
A partial residual might be thought of as a “synthetic outcome” value, combining the prediction based on a single predictor with the actual residual from the full regression equation.
A partial residual for predictor <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>X</mi> <mi>i</mi> </msub>
</math> is the ordinary residual plus the regression term associated with <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>X</mi> <mi>i</mi> </msub>
</math>:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block" alttext="Partial residual equals Residual plus ModifyingAbove b With caret Subscript i Baseline upper X Subscript i Baseline">
  <mrow>
    <mtext>Partial</mtext>
    <mspace width="4.pt"></mspace>
    <mtext>residual</mtext>
    <mo>=</mo>
    <mtext>Residual</mtext>
    <mo>+</mo>
    <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
    <msub><mi>X</mi> <mi>i</mi> </msub>
  </mrow>
</math>
</div>

<p>where <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
</math> is the estimated regression coefficient.
The <code>predict</code> function in R has an option to return the individual regression terms <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mrow>
    <msub><mover accent="true"><mi>b</mi> <mo>^</mo></mover> <mi>i</mi> </msub>
    <msub><mi>X</mi> <mi>i</mi> </msub>
  </mrow>
</math>:</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">terms</code> <code class="o">&lt;-</code> <code class="nf">predict</code><code class="p">(</code><code class="n">lm_98105</code><code class="p">,</code> <code class="n">type</code><code class="o">=</code><code class="s">'terms'</code><code class="p">)</code>
<code class="n">partial_resid</code> <code class="o">&lt;-</code> <code class="nf">resid</code><code class="p">(</code><code class="n">lm_98105</code><code class="p">)</code> <code class="o">+</code> <code class="n">terms</code></pre>

<p>The partial residual plot displays the <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub><mi>X</mi> <mi>i</mi> </msub>
</math> on the x-axis and the partial residuals on the y-axis.
Using <code>ggplot2</code> makes it easy to superpose a smooth of the partial residuals.</p>

<pre data-type="programlisting" data-code-language="r"><code class="n">df</code> <code class="o">&lt;-</code> <code class="nf">data.frame</code><code class="p">(</code><code class="n">SqFtTotLiving</code> <code class="o">=</code> <code class="n">house_98105</code><code class="p">[,</code> <code class="s">'SqFtTotLiving'</code><code class="p">],</code>
                 <code class="n">Terms</code> <code class="o">=</code> <code class="n">terms</code><code class="p">[,</code> <code class="s">'SqFtTotLiving'</code><code class="p">],</code>
                 <code class="n">PartialResid</code> <code class="o">=</code> <code class="n">partial_resid</code><code class="p">[,</code> <code class="s">'SqFtTotLiving'</code><code class="p">])</code>
<code class="nf">ggplot</code><code class="p">(</code><code class="n">df</code><code class="p">,</code> <code class="nf">aes</code><code class="p">(</code><code class="n">SqFtTotLiving</code><code class="p">,</code> <code class="n">PartialResid</code><code class="p">))</code> <code class="o">+</code>
  <code class="nf">geom_point</code><code class="p">(</code><code class="n">shape</code><code class="o">=</code><code class="m">1</code><code class="p">)</code> <code class="o">+</code> <code class="nf">scale_shape</code><code class="p">(</code><code class="n">solid</code> <code class="o">=</code> <code class="kc">FALSE</code><code class="p">)</code> <code class="o">+</code>
  <code class="nf">geom_smooth</code><code class="p">(</code><code class="n">linetype</code><code class="o">=</code><code class="m">2</code><code class="p">)</code> <code class="o">+</code>
  <code class="nf">geom_line</code><code class="p">(</code><code class="nf">aes</code><code class="p">(</code><code class="n">SqFtTotLiving</code><code class="p">,</code> <code class="n">Terms</code><code class="p">))</code></pre>

<p>The resulting plot is shown in <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#HousePartialResid">Figure&nbsp;4-9</a>.
The partial residual is an estimate of the contribution that <code>SqFtTotLiving</code> adds to the sales price.
The relationship between <code>SqFtTotLiving</code> and the sales price is evidently nonlinear.
The regression line underestimates the sales price for homes less than 1,000 square feet and overestimates the price for homes between 2,000 and 3,000 square feet.
There are too few data points above 4,000 square feet to draw conclusions for those homes.</p>

<figure class="width-75"><div id="HousePartialResid" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0409.png" alt="A partial residual plot of for the variable SqFtTotLiving" width="1156" height="1155">
<h6><span class="label">Figure 4-9. </span>A partial residual plot for the variable SqFtTotLiving</h6>
</div></figure>

<p>This nonlinearity makes sense in this case: adding 500 feet in a small home makes a much bigger difference than adding 500 feet in a large home. This suggests that, instead of a simple linear term for <code>SqFtTotLiving</code>, a nonlinear term should be considered (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#NonlinearTerms">“Polynomial and Spline Regression”</a>).</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909259941240">
<h5>Key Ideas</h5>
<ul>
<li>
<p>While outliers can cause problems for small data sets, the primary interest with outliers is to identify problems with the data, or locate anomalies.</p>
</li>
<li>
<p>Single records (including regression outliers) can have a big influence on a regression equation with small data, but this effect washes out in big data.</p>
</li>
<li>
<p>If the regression model is used for formal inference (p-values and the like), then certain assumptions about the distribution of the residuals should be checked.
In general, however, the distribution of residuals is not critical in data science.</p>
</li>
<li>
<p>The partial residuals plot can be used to qualitatively assess the fit for each regression term, possibly leading to alternative model specification.</p>
</li>
</ul>
</div></aside>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Polynomial and Spline Regression"><div class="sect1" id="NonlinearTerms">
<h1>Polynomial and Spline Regression</h1>

<p>The relationship between the response and a predictor variable is not necessarily linear.<a data-type="indexterm" data-primary="nonlinear regression" id="ix_nonlin"></a><a data-type="indexterm" data-primary="regression" data-secondary="diagnostics" data-startref="ix_regrdiag" id="idm45909259932680"></a>
The response to the dose of a drug is often nonlinear: doubling the dosage generally doesn’t lead to a doubled response.<a data-type="indexterm" data-primary="regression" data-secondary="polynomial and spline regression" id="ix_regrpolyspli"></a>
The demand for a product is not a linear function of marketing dollars spent since, at some point, demand is likely to be saturated.
There are several ways that regression can be extended to capture these nonlinear effects.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909259929512">
<h5>Key Terms for Nonlinear Regression</h5><dl>
<dt class="horizontal"><strong><em>Polynomial regression</em></strong></dt>
<dd>
<p>Adds polynomial terms (squares, cubes, etc.) to a regression.<a data-type="indexterm" data-primary="polynomial regression" id="idm45909259926568"></a></p>
</dd>
<dt class="horizontal"><strong><em>Spline regression</em></strong></dt>
<dd>
<p>Fitting a smooth curve with a series of polynomial segments.<a data-type="indexterm" data-primary="spline regression" id="idm45909259924056"></a></p>
</dd>
<dt class="horizontal"><strong><em>Knots</em></strong></dt>
<dd>
<p>Values that separate spline segments.<a data-type="indexterm" data-primary="knots" id="idm45909259921464"></a></p>
</dd>
<dt class="horizontal"><strong><em>Generalized additive models</em></strong></dt>
<dd>
<p>Spline models with automated selection of knots.<a data-type="indexterm" data-primary="generalized additive models" id="idm45909259918984"></a></p>
<dl>
<dt>Synonyms</dt>
<dd>
<p>GAM</p>
</dd>
</dl>
</dd>
</dl>
</div></aside>
<div data-type="tip"><h1>Nonlinear Regression</h1>
<p>When statisticians talk about <em>nonlinear regression</em>,
they are referring to models that can’t be fit using least squares.
What kind of models are nonlinear?<a data-type="indexterm" data-primary="nonlinear regression" data-secondary="definition of" id="idm45909259914456"></a>
Essentially all models where the response cannot be expressed as a linear combination of the predictors or some transform of the predictors.
Nonlinear regression models are  harder and computationally more intensive to fit, since they require numerical optimization.
For this reason, it is generally preferred to use a linear model if possible.</p>
</div>








<section data-type="sect2" data-pdf-bookmark="Polynomial"><div class="sect2" id="Polynomial">
<h2>Polynomial</h2>

<p><em>Polynomial regression</em> involves including polynomial terms to a regression equation.<a data-type="indexterm" data-primary="regression" data-secondary="polynomial and spline regression" data-tertiary="polynomial regression" id="idm45909259910632"></a><a data-type="indexterm" data-primary="polynomial regression" id="idm45909259909288"></a>
The use of polynomial regression dates back almost to the development of regression itself with a paper by Gergonne in 1815.
For example, a quadratic regression between the response <em>Y</em> and the predictor <em>X</em> would take the form:</p>
<div data-type="equation">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mrow>
    <mi>Y</mi>
    <mo>=</mo>
    <msub><mi>b</mi> <mn>0</mn> </msub>
    <mo>+</mo>
    <msub><mi>b</mi> <mn>1</mn> </msub>
    <mi>X</mi>
    <mo>+</mo>
    <msub><mi>b</mi> <mn>2</mn> </msub>
    <msup><mi>X</mi> <mn>2</mn> </msup>
    <mo>+</mo>
    <mi>e</mi>
  </mrow>
</math>
</div>

<p>Polynomial regression can be fit in R through the <code>poly</code> function.
For example, the following fits a quadratic polynomial for <code>SqFtTotLiving</code> with the King County housing data:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code>  <code class="nf">poly</code><code class="p">(</code><code class="n">SqFtTotLiving</code><code class="p">,</code> <code class="m">2</code><code class="p">)</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code>
                <code class="n">BldgGrade</code> <code class="o">+</code>  <code class="n">Bathrooms</code> <code class="o">+</code>  <code class="n">Bedrooms</code><code class="p">,</code>
                    <code class="n">data</code><code class="o">=</code><code class="n">house_98105</code><code class="p">)</code>

<code class="n">Call</code><code class="o">:</code>
<code class="nf">lm</code><code class="p">(</code><code class="n">formula</code> <code class="o">=</code> <code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="nf">poly</code><code class="p">(</code><code class="n">SqFtTotLiving</code><code class="p">,</code> <code class="m">2</code><code class="p">)</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code>
    <code class="n">BldgGrade</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code> <code class="n">Bedrooms</code><code class="p">,</code> <code class="n">data</code> <code class="o">=</code> <code class="n">house_98105</code><code class="p">)</code>

<code class="n">Coefficients</code><code class="o">:</code>
            <code class="p">(</code><code class="n">Intercept</code><code class="p">)</code>  <code class="nf">poly</code><code class="p">(</code><code class="n">SqFtTotLiving</code><code class="p">,</code> <code class="m">2</code><code class="p">)</code><code class="m">1</code>
             <code class="m">-402530.47</code>               <code class="m">3271519.49</code>
<code class="nf">poly</code><code class="p">(</code><code class="n">SqFtTotLiving</code><code class="p">,</code> <code class="m">2</code><code class="p">)</code><code class="m">2</code>                  <code class="n">SqFtLot</code>
              <code class="m">776934.02</code>                    <code class="m">32.56</code>
              <code class="n">BldgGrade</code>                <code class="n">Bathrooms</code>
              <code class="m">135717.06</code>                 <code class="m">-1435.12</code>
               <code class="n">Bedrooms</code>
               <code class="m">-9191.94</code></pre>

<p>There are now two coefficients associated with <code>SqFtTotLiving</code>:
one for the linear term and one for the quadratic term.</p>

<p>The partial residual plot (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#PartialResidualPlots">“Partial Residual Plots and Nonlinearity”</a>) indicates some curvature in the regression equation associated with <code>SqFtTotLiving</code>.
The fitted line more closely matches the smooth (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#Splines">“Splines”</a>) of the partial residuals as compared to a linear fit (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#PolynomialRegressionPlot">Figure&nbsp;4-10</a>).</p>

<figure class="width-75"><div id="PolynomialRegressionPlot" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0410.png" alt="A polynomial regression fit for the variable SqFtTotLiving (solid line) versus a smooth (dashed line)" width="1156" height="1155">
<h6><span class="label">Figure 4-10. </span>A polynomial regression fit for the variable SqFtTotLiving (solid line) versus a smooth (dashed line; see the following section about splines)</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Splines"><div class="sect2" id="Splines">
<h2>Splines</h2>

<p>Polynomial regression only captures a certain amount of curvature in a nonlinear relationship.<a data-type="indexterm" data-primary="regression" data-secondary="polynomial and spline regression" data-tertiary="splines" id="idm45909259787640"></a><a data-type="indexterm" data-primary="spline regression" id="idm45909259786424"></a>
Adding in higher-order terms, such as a cubic quartic polynomial, often leads to undesirable “wiggliness” in the regression equation.
An alternative, and often superior, approach to modeling nonlinear relationships is to use <em>splines</em>.<a data-type="indexterm" data-primary="splines" id="idm45909259785000"></a>
<em>Splines</em> provide a way to smoothly interpolate between fixed points.
Splines were originally used by draftsmen to draw a smooth curve, particularly in ship and aircraft building.</p>

<p>The splines were created by bending a thin piece of wood using weights, referred to as “ducks”; see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#SplineDucks">Figure&nbsp;4-11</a>.</p>

<figure><div id="SplineDucks" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0411.png" alt="Splines were originally created using bendable wood and ``ducks,&#39;&#39; and were used as a draftsman tool to fit curves. Photo courtesy Bob Perry." width="295" height="243">
<h6><span class="label">Figure 4-11. </span>Splines were originally created using bendable wood and “ducks,” and were used as a draftsman tool to fit curves. Photo courtesy Bob Perry.</h6>
</div></figure>

<p>The technical definition of a spline is a series of piecewise continuous polynomials.  They were first developed during World War II at the US Aberdeen Proving Grounds by I. J. Schoenberg, a Romanian mathematician.
The polynomial pieces are smoothly connected at a series of fixed points in a predictor variable, referred to as <em>knots</em>.<a data-type="indexterm" data-primary="knots" id="idm45909259778488"></a>
Formulation of splines is much more complicated than polynomial regression;
statistical software usually handles the details of fitting a spline.
The R package <code>splines</code> includes the function <code>bs</code> to create a <em>b-spline</em> term in a regression model.
For example, the following adds a b-spline term to the house regression model:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">library</code><code class="p">(</code><code class="n">splines</code><code class="p">)</code>
<code class="n">knots</code> <code class="o">&lt;-</code> <code class="nf">quantile</code><code class="p">(</code><code class="n">house_98105</code><code class="o">$</code><code class="n">SqFtTotLiving</code><code class="p">,</code> <code class="n">p</code><code class="o">=</code><code class="nf">c</code><code class="p">(</code><code class="m">.25</code><code class="p">,</code> <code class="m">.5</code><code class="p">,</code> <code class="m">.75</code><code class="p">))</code>
<code class="n">lm_spline</code> <code class="o">&lt;-</code> <code class="nf">lm</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="nf">bs</code><code class="p">(</code><code class="n">SqFtTotLiving</code><code class="p">,</code> <code class="n">knots</code><code class="o">=</code><code class="n">knots</code><code class="p">,</code> <code class="n">degree</code><code class="o">=</code><code class="m">3</code><code class="p">)</code> <code class="o">+</code>
  <code class="n">SqFtLot</code> <code class="o">+</code> <code class="n">Bathrooms</code> <code class="o">+</code> <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code><code class="p">,</code>  <code class="n">data</code><code class="o">=</code><code class="n">house_98105</code><code class="p">)</code></pre>

<p>Two parameters need to be specified: the degree of the polynomial and the location of the knots.
In this case, the predictor <code>SqFtTotLiving</code> is included in the model using a cubic spline (<code>degree=3</code>).
By default, <code>bs</code> places knots at the boundaries;
in addition, knots were also placed at the lower quartile, the median quartile, and the upper quartile.</p>

<p>In contrast to a linear term, for which the coefficient has a direct meaning, the coefficients for a spline term are not interpretable.
Instead, it is more useful to use the visual display to reveal the nature of the spline fit.
<a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#SplineRegressionPlot">Figure&nbsp;4-12</a> displays the partial residual plot from the regression.
In contrast to the polynomial model,
the spline model more closely matches the smooth,
demonstrating the greater flexibility of splines.
In this case, the line more closely fits the data.
Does this mean the spline regression is a better model?
Not necessarily: it doesn’t make economic sense that very small homes (less than 1,000 square feet) would have higher value than slightly larger homes. This is possibly an artifact of a confounding variable; see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#ConfoundingVariables">“Confounding Variables”</a>.</p>

<figure class="width-75"><div id="SplineRegressionPlot" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0412.png" alt="A spline regression fit for the variable SqFtTotLiving (solid line) compared to a smooth (dashed line)" width="1156" height="1155">
<h6><span class="label">Figure 4-12. </span>A spline regression fit for the variable SqFtTotLiving (solid line) compared to a smooth (dashed line)</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Generalized Additive Models"><div class="sect2" id="GAMS">
<h2>Generalized Additive Models</h2>

<p>Suppose you suspect a nonlinear relationship between the response and a predictor variable,
either by a priori knowledge or by examining the regression diagnostics.<a data-type="indexterm" data-primary="regression" data-secondary="polynomial and spline regression" data-tertiary="generalized additive models" id="idm45909259671784"></a><a data-type="indexterm" data-primary="generalized additive models" id="idm45909259670600"></a>
Polynomial terms may not be flexible enough to capture the relationship, and spline terms require specifying the knots.
<em>Generalized additive models</em>, or <em>GAM</em>, are a technique to automatically fit a spline regression.<a data-type="indexterm" data-primary="GAM" data-see="generalized additive models" id="idm45909259668888"></a>
The <code>gam</code> package in R can be used to fit a GAM model to the housing data:</p>

<pre data-type="programlisting" data-code-language="r"><code class="nf">library</code><code class="p">(</code><code class="n">mgcv</code><code class="p">)</code>
<code class="n">lm_gam</code> <code class="o">&lt;-</code> <code class="nf">gam</code><code class="p">(</code><code class="n">AdjSalePrice</code> <code class="o">~</code> <code class="nf">s</code><code class="p">(</code><code class="n">SqFtTotLiving</code><code class="p">)</code> <code class="o">+</code> <code class="n">SqFtLot</code> <code class="o">+</code>
                      <code class="n">Bathrooms</code> <code class="o">+</code>  <code class="n">Bedrooms</code> <code class="o">+</code> <code class="n">BldgGrade</code><code class="p">,</code>
                    <code class="n">data</code><code class="o">=</code><code class="n">house_98105</code><code class="p">)</code></pre>

<p>The term <code>s(SqFtTotLiving)</code> tells the <code>gam</code> function to find the “best” knots for a spline term (see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#GAMPlot">Figure&nbsp;4-13</a>).</p>

<figure class="width-75"><div id="GAMPlot" class="figure">
<img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/psds_0413.png" alt="A GAM regression fit for the variable SqFtTotLiving (solid line) compared to a smooth (dashed line)" width="1156" height="1155">
<h6><span class="label">Figure 4-13. </span>A GAM regression fit for the variable SqFtTotLiving (solid line) compared to a smooth (dashed line)</h6>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45909259650488">
<h5>Key Ideas</h5>
<ul>
<li>
<p>Outliers in a regression are records with a large residual.</p>
</li>
<li>
<p>Multicollinearity can cause numerical instability in fitting the regression equation.</p>
</li>
<li>
<p>A confounding variable is an important predictor that is omitted from a model and can lead to a regression equation with spurious relationships.</p>
</li>
<li>
<p>An interaction term between two variables is needed if the effect of one variable depends on the <em>level</em> of the other.</p>
</li>
<li>
<p>Polynomial regression can fit nonlinear relationships between predictors and the outcome variable.</p>
</li>
<li>
<p>Splines are series of polynomial segments strung together, joining at knots.</p>
</li>
<li>
<p>Generalized additive models (GAM) automate the process of specifying the knots in splines.</p>
</li>
</ul>
</div></aside>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Further Reading"><div class="sect2" id="idm45909259592360">
<h2>Further Reading</h2>

<p>For more on spline models and GAMS, see <em>The Elements of Statistical Learning</em> by Trevor Hastie, Robert Tibshirani, and Jerome Friedman, and its shorter cousin based on R, <em>An Introduction to Statistical Learning</em> by Gareth James, Daniela Witten, Trevor Hastie, and Robert Tibshirani; both are Springer books.<a data-type="indexterm" data-primary="nonlinear regression" data-startref="ix_nonlin" id="idm45909259590008"></a></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Summary"><div class="sect1" id="idm45909259588808">
<h1>Summary</h1>

<p>Perhaps no other statistical method has seen greater use over the years than  regression—the process of establishing<a data-type="indexterm" data-primary="regression" data-secondary="polynomial and spline regression" data-startref="ix_regrpolyspli" id="idm45909259587384"></a> a relationship between multiple predictor variables and an outcome variable. The fundamental form is linear: each predictor variable has a coefficient that describes a linear relationship between the predictor and the outcome.  More advanced forms of regression, such as polynomial and spline regression, permit the relationship to be nonlinear.  In classical statistics, the emphasis is on finding a good fit to the observed data to explain or describe some phenomenon, and the strength of this fit is how traditional  (“in-sample”) metrics are used to assess the model.  In data science, by contrast, the goal is typically to predict values for new data, so metrics based on predictive accuracy for out-of-sample data are used.  Variable selection methods are used to reduce dimensionality and create more compact  <span class="keep-together">models</span>.<a data-type="indexterm" data-primary="regression" data-startref="ix_regr" id="idm45909259584552"></a></p>
</div></section>







<div data-type="footnotes"><p data-type="footnote" id="idm45909264518120"><sup><a href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909264518120-marker">1</a></sup> This and subsequent sections in this chapter © 2017 Datastats, LLC, Peter Bruce and Andrew Bruce, used by permission.</p><p data-type="footnote" id="idm45909264276232"><sup><a href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909264276232-marker">2</a></sup> In Bayesian statistics, the true value is assumed to be a random variable with a specified distribution. In the Bayesian context, instead of estimates of unknown parameters, there are posterior and prior distributions.</p><p data-type="footnote" id="idm45909261697000"><sup><a href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909261697000-marker">3</a></sup> The <code>-1</code> argument in the <code>model.matrix</code> produces one hot encoding representation (by removing the intercept, hence the “-”).  Otherwise, the default in R is to produce a matrix with <em>P</em> – 1 columns with the first factor level as a reference.</p><p data-type="footnote" id="idm45909261494968"><sup><a href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909261494968-marker">4</a></sup> This is unintuitive, but can be explained by the impact of location as a confounding variable; see <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#ConfoundingVariables">“Confounding Variables”</a>.</p><p data-type="footnote" id="idm45909260862712"><sup><a href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909260862712-marker">5</a></sup> There are 82 zip codes in King County, several with just a handful of sales. An alternative to directly using zip code as a factor variable, <code>ZipGroup</code> clusters similar zip codes into a single group. See <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#FactorVariablesManyLevels">“Factor Variables with Many Levels”</a> for details.</p><p data-type="footnote" id="idm45909260333080"><sup><a href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909260333080-marker">6</a></sup> The term <em>hat-value</em> comes from the notion of the hat matrix in regression. Multiple linear regression can be expressed by the formula <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mrow>
    <mover accent="true"><mi>Y</mi> <mo>^</mo></mover>
    <mo>=</mo>
    <mi>H</mi>
    <mi>Y</mi>
  </mrow>
</math> where <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>H</mi>
</math> is the hat matrix. The hat-values correspond to the diagonal of <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>H</mi>
</math>.</p><p data-type="footnote" id="idm45909260255592"><sup><a href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#idm45909260255592-marker">7</a></sup> The coefficient for <code>Bathrooms</code> becomes negative, which is unintuitive. Location has not been taken into account and the zip code 98105 contains areas of disparate types of homes. See <a data-type="xref" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/ch04.html#ConfoundingVariables">“Confounding Variables”</a> for a discussion of confounding variables.</p></div></div></section></div>
    </div>
    
    <section class="t-bottom-cta bottom-cta bottom-cta-book free-chapter">
  <p>Get <em>Practical Statistics for Data Scientists</em> now with O’Reilly <span class="nowrap">online learning.</span></p>
  <p>O’Reilly members experience live online training, plus books, videos, and digital content from <span class="nowrap">200+ publishers.</span></p>

  <div class="controls">
      <a href="https://learning.oreilly.com/register/" class="button-primary" data-ga-label="Bottom CTA" onmousedown="dataLayer.push({&#39;event&#39;: &#39;eventTracker&#39;, &#39;eventCat&#39;: &#39;Outbound Links&#39;, &#39;eventAct&#39;:&#39;Oreilly&#39;, &#39;eventLbl&#39;: &#39;learning.oreilly.com/register/&#39;, &#39;eventVal&#39;: 0, &#39;nonInteraction&#39;: 0});">Start your free trial</a>
  </div>
</section>

</div>


</section>



  </div>
</main>


  <footer id="footer" class="footer">
  <div class="content">
    <div class="footer-main" aria-label="company info">
      <div class="footer-mainLeft">
        <div class="footer-mainLeftOne">
          <div class="footer-approach">
            <h2 class="footer-header"><a href="https://www.oreilly.com/about/approach.html">The O'Reilly Approach</a></h2>
            <ul class="footer-links">
              <li><a href="https://www.oreilly.com/about/">Our Company</a></li>
              <li><a href="https://www.oreilly.com/work-with-us.html">Teach/Write/Train</a></li>
              <li><a href="https://www.oreilly.com/careers/">Careers</a></li>
              <li><a href="https://www.oreilly.com/partner/signup.csp">Community Partners</a></li>
              <li><a href="https://www.oreilly.com/diversity/">Diversity</a></li>
            </ul>
          </div>
        </div>
        <div class="footer-mainLeftTwo">
          <div class="footer-solutions">
            <h2 class="footer-header">Solutions</h2>
            <ul class="footer-links">
              <li><a href="https://www.oreilly.com/online-learning/teams.html">For Teams</a></li>
              <li><a href="https://www.oreilly.com/online-learning/enterprise.html">For Enterprise</a></li>
              <li><a href="https://www.oreilly.com/online-learning/individuals.html">For Individuals</a></li>
              <li><a href="https://www.oreilly.com/online-learning/government.html">For Government</a></li>
              <li><a href="https://www.oreilly.com/online-learning/academic.html">For Education</a></li>
              <li><a href="https://www.oreilly.com/content-marketing-solutions.html">Marketing Solutions</a></li>
            </ul>
          </div>
          
          <div class="footer-contact">
            <h2 class="footer-header"><a href="https://www.oreilly.com/online-learning/support/">Support</a></h2>

            <ul class="footer-links">
              <li><a href="https://www.oreilly.com/about/contact.html">Contact Us</a></li>
              <li><a href="https://www.oreilly.com/privacy.html">Privacy Policy</a></li>
            </ul>
          
            <a href="https://twitter.com/oreillymedia" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 400 400" style="enable-background:new 0 0 400 400;" xml:space="preserve"><style type="text/css">.st0{fill:#ee0000;}.st1{fill:#FFFFFF;}</style><g id="Red"><circle class="st0" cx="200" cy="200" r="200"></circle></g><g id="Logo__x2014__FIXED"><path class="st1" d="M163.4,305.5c88.7,0,137.2-73.5,137.2-137.2c0-2.1,0-4.2-0.1-6.2c9.4-6.8,17.6-15.3,24.1-25 c-8.6,3.8-17.9,6.4-27.7,7.6c10-6,17.6-15.4,21.2-26.7c-9.3,5.5-19.6,9.5-30.6,11.7c-8.8-9.4-21.3-15.2-35.2-15.2 c-26.6,0-48.2,21.6-48.2,48.2c0,3.8,0.4,7.5,1.3,11c-40.1-2-75.6-21.2-99.4-50.4c-4.1,7.1-6.5,15.4-6.5,24.2 c0,16.7,8.5,31.5,21.5,40.1c-7.9-0.2-15.3-2.4-21.8-6c0,0.2,0,0.4,0,0.6c0,23.4,16.6,42.8,38.7,47.3c-4,1.1-8.3,1.7-12.7,1.7 c-3.1,0-6.1-0.3-9.1-0.9c6.1,19.2,23.9,33.1,45,33.5c-16.5,12.9-37.3,20.6-59.9,20.6c-3.9,0-7.7-0.2-11.5-0.7 C110.8,297.5,136.2,305.5,163.4,305.5"></path></g></svg></a>
            <a href="https://www.facebook.com/OReilly/" target="_blank"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.25 32.25"><defs><style>.cls-1{fill:#E00;fill-rule:evenodd;}</style></defs><title>facebook-logo</title><path class="cls-1" d="M16.13,0A16.13,16.13,0,1,0,32.25,16.12,16.13,16.13,0,0,0,16.13,0Zm5.12,9.54H19.57a1.52,1.52,0,0,0-1.51,1.51v1.14h3.19v3.42H18.06V26.12H13.57V15.61H10.69V12.19h2.88v-2a4,4,0,0,1,4-4h3.65Z"></path></svg></a>
            <a href="https://www.linkedin.com/company/oreilly-media" target="_blank"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.25 32.25"><defs><style>.cls-1{fill:#E00;fill-rule:evenodd;}</style></defs><title>linkedin-logo</title><path class="cls-1" d="M17.43,13.53v0l0,0ZM16.12,0A16.13,16.13,0,1,0,32.25,16.12,16.12,16.12,0,0,0,16.12,0ZM11.77,22.92H8.12v-11h3.65ZM9.94,10.44h0a1.89,1.89,0,0,1-2-1.89A1.91,1.91,0,0,1,10,6.65a1.9,1.9,0,1,1,0,3.79Zm15,12.48H21.28V17.05c0-1.48-.53-2.49-1.85-2.49a2,2,0,0,0-1.88,1.34,2.63,2.63,0,0,0-.12.89v6.13H13.79s.05-10,0-11h3.64V13.5a3.63,3.63,0,0,1,3.29-1.82c2.4,0,4.21,1.57,4.21,4.95Z"></path></svg></a>
            <a href="https://www.youtube.com/user/OreillyMedia" target="_blank"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.25 32.25"><defs><style>.cls-1{fill:#E00;fill-rule:evenodd;}</style></defs><title>youtube-logo</title><path class="cls-1" d="M18.35,18.68a.89.89,0,0,0-.86.63V16.94h-1v7.59h1v-.59a.92.92,0,0,0,.89.74c.52,0,.86-.36,1-1.07a8.56,8.56,0,0,0,.14-1.9,10.47,10.47,0,0,0-.12-1.93C19.21,19.05,18.87,18.68,18.35,18.68Zm.09,4.14c-.05.52-.2.77-.45.77s-.43-.21-.49-.63a7.22,7.22,0,0,1,0-1c0-.72,0-1.14,0-1.26.07-.58.23-.88.51-.88s.4.27.46.79c0,.09,0,.47,0,1.13S18.46,22.71,18.44,22.82ZM8.61,18.19H9.86v6.34H11V18.19H12.2V16.94H8.61Zm7.71-6.12c.27,0,.43-.22.49-.66,0-.09,0-.45,0-1.07V9.78c0-.58,0-.93,0-1-.07-.43-.23-.65-.48-.65s-.41.19-.48.57a8.79,8.79,0,0,0,0,1v.53c0,.71,0,1.09,0,1.16C15.88,11.82,16.05,12.07,16.32,12.07Zm-1.74,10.4a2.92,2.92,0,0,1-.06.71c-.07.25-.2.37-.4.37s-.32-.11-.38-.34a2.63,2.63,0,0,1-.05-.66V18.83h-1v4.48c0,.91.33,1.37,1,1.37A1,1,0,0,0,14.6,24v.57h1v-5.7h-1Zm7.1-3.79a1.35,1.35,0,0,0-1.22.59,2.48,2.48,0,0,0-.3,1.07c0,.23,0,.61,0,1.16s0,1.13,0,1.37a2.93,2.93,0,0,0,.35,1.27,1.25,1.25,0,0,0,1.14.54,1.36,1.36,0,0,0,1.13-.45,2.29,2.29,0,0,0,.37-1.43s0-.07,0-.11v-.12h-1c0,.75-.17,1.12-.51,1.12s-.38-.18-.45-.56a4.68,4.68,0,0,1-.06-.9c0-.18,0-.31,0-.37h2v-.43a4.86,4.86,0,0,0-.3-2.11A1.28,1.28,0,0,0,21.68,18.68ZM22.15,21h-1c0-.05,0-.11,0-.16v-.08a1.64,1.64,0,0,1,.11-.8.39.39,0,0,1,.38-.23.42.42,0,0,1,.43.33,2.32,2.32,0,0,1,.07.7Zm-6-21A16.13,16.13,0,1,0,32.25,16.12,16.12,16.12,0,0,0,16.12,0Zm2.51,7.2h1V11a2.52,2.52,0,0,0,.06.66c.06.23.18.34.38.34s.34-.12.41-.37a3.76,3.76,0,0,0,.05-.71V7.2h1v5.74h-1v-.57a1,1,0,0,1-.93.72c-.66,0-1-.46-1-1.38ZM15,8a1.29,1.29,0,0,1,1.33-.92A1.3,1.3,0,0,1,17.65,8a6.77,6.77,0,0,1,.23,2.1,6.77,6.77,0,0,1-.23,2.1,1.3,1.3,0,0,1-1.32.92A1.29,1.29,0,0,1,15,12.17a6.77,6.77,0,0,1-.23-2.1A6.86,6.86,0,0,1,15,8ZM11.45,5.3l.89,2.87.88-2.87H14.4L12.88,9.7v3.24h-1.1V9.7L10.24,5.3ZM24.93,23.91a3,3,0,0,1-3,3h-12a3,3,0,0,1-3-3V18.05a3,3,0,0,1,3-3h12a3,3,0,0,1,3,3Z"></path></svg></a>
            <a href="https://www.oreilly.com/emails/newsletters/" target="_blank"><svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32.33 32.33"><defs><style>.cls-1{fill:#E00;}.cls-2{fill:#f0f1f1;}</style></defs><title>email-logo</title><circle class="cls-1" cx="16.17" cy="16.17" r="16.17"></circle><path class="cls-2" d="M6.66,13.32l.2.14c2.2,1.5,4.41,3,6.74,4.29.6.34,1.22.62,1.84.92a1.72,1.72,0,0,0,1.44,0,21,21,0,0,0,2.71-1.4c2-1.21,4-2.53,5.91-3.87l.18-.12v.21c0,2.77,0,5.54,0,8.31A1.51,1.51,0,0,1,24,23.33c-5.24,0-10.48,0-15.72,0a1.57,1.57,0,0,1-1.62-1.08,1.23,1.23,0,0,1,0-.19V13.47A.86.86,0,0,1,6.66,13.32Z"></path><path class="cls-2" d="M16.15,9h7.9a1.5,1.5,0,0,1,1.56,1,4.81,4.81,0,0,1,.06,1.07s0,.08-.08.1a77.16,77.16,0,0,1-7.49,4.9c-.42.24-.87.43-1.31.63a1.41,1.41,0,0,1-1.28,0c-.65-.33-1.32-.64-1.95-1-2.37-1.4-4.59-3-6.81-4.55a.35.35,0,0,1-.1-.2c0-.2,0-.4,0-.6A1.45,1.45,0,0,1,8.05,9h8.1Z"></path></svg></a>
          </div>
        </div>
      </div>

      <div class="footer-download" id="download-info">
        <h2 class="footer-header">Download the O’Reilly App</h2>

        <div class="footer-downloadLinks">
          <a href="https://itunes.apple.com/us/app/safari-to-go/id881697395"><img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/app-store-logo.png" alt="Apple app store"></a>
          <a href="https://play.google.com/store/apps/details?id=com.safariflow.queue"><img src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/google-play-logo.png" alt="Google play store"></a>
        </div>

        <p>Take O’Reilly online learning with you and learn anywhere, anytime on your phone or tablet. Download the app <span class="nowrap">today and:</span></p>

        <ul>
          <li>Get unlimited access to books, videos, and <span class="nowrap">live training</span></li>
          <li>Never lose your place—all your devices are synced</li>
          <li>Learn during your commute with online and <span class="nowrap">offline access</span></li>
        </ul>
      </div>
    </div>

    <div class="footer-subfooter">

      <a href="https://www.oreilly.com/" title="home page" aria-current="page">
        <img class="footer-subfooterLogo" id="footer-subfooterLogo" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/oreilly_logo_mark_red.svg" onerror="this.src=&#39;https://cdn.oreillystatic.com/images/sitewide-headers/oreilly_logo_mark_red_@2x.png&#39;; this.onerror=null;" alt="O&#39;Reilly home">
      </a>

      <p>© 2020, O’Reilly Media, Inc.  All trademarks and registered trademarks appearing on oreilly.com are the property of their respective owners.</p>
      <p><a href="https://www.oreilly.com/terms/">Terms of Service</a> • <a href="https://www.oreilly.com/privacy.html">Privacy Policy</a> • <a href="https://www.oreilly.com/about/editorial_independence.html">Editorial Independence</a></p>
    </div>

  </div>
</footer>


<!--
<footer class="anybird-footer">
    <nav class="grid">
        <ul class="footer-nav col">
            <li><a href="https://learning.oreilly.com/explore/"><span>Explore</span></a></li>
            <li><a href="https://learning.oreilly.com/our-library/"><span>Tour</span></a></li>
            <li><a href="https://learning.oreilly.com/pricing/"><span>Pricing</span></a></li>
            <li><a href="https://learning.oreilly.com/enterprise/"><span>Enterprise</span></a></li>
            <li><a href="https://learning.oreilly.com/government/"><span>Government</span></a></li>
            <li><a href="https://learning.oreilly.com/academic-public-library/"><span>Education</span></a></li>
            <li><a href="https://learning.oreilly.com/your-experience/#queue"><span>Queue App</span></a></li>
        </ul>
        <ul class="footer-contact col">
            <li><a href="https://learning.oreilly.com/learn/"><span>Learn</span></a></li>
            <li><a href="https://learning.oreilly.com/blog/"><span>Blog</span></a></li>
            <li><a href="https://learning.oreilly.com/contact/"><span>Contact</span></a></li>
            <li><a href="https://learning.oreilly.com/careers/"><span>Careers</span></a></li>
            <li><a href="https://learning.oreilly.com/press-resources/"><span>Press Resources</span></a></li>
            <li><a href="https://www.oreilly.com/online-learning/support/"><span>Support</span></a></li>
        </ul>
        <ul class="footer-social col">
            <li id="footer-twitter"><a href="https://twitter.com/safari"><span>Twitter</span></a></li>
            <li id="footer-github"><a href="https://github.com/oreillymedia"><span>GitHub</span></a></li>
            <li id="footer-facebook"><a href="http://www.facebook.com/safaribooksonline"><span>Facebook</span></a></li>
            <li id="footer-linkedin"><a
                    href="https://www.linkedin.com/company/safari-books-online"><span>LinkedIn</span></a></li>
        </ul>
        <ul class="footer-legal col">
            <li><a href="https://learning.oreilly.com/terms/"><span>Terms of Service</span></a></li>
            <li><a href="https://learning.oreilly.com/membership-agreement/"><span>Membership Agreement</span></a></li>
            <li><a href="https://learning.oreilly.com/privacy/"><span>Privacy Policy</span></a></li>
        </ul>
    </nav>
    <div class="footer-copyright">
        Copyright &copy; 2020 Safari Books Online.
    </div>
</footer>
-->




<script>
  var g = {
    
    position_cache: {},
    title: "Practical Statistics for Data Scientists",
    author_list: "Peter Bruce, Andrew Bruce",
    format: "book",
    source: "application/epub+zip",
    is_system_book: true,
    is_public: true,
    loaded_from_server: true,
    allow_scripts: false,
    has_mathml: true
    
  };
</script>
<script>
  window.dataLayer = window.dataLayer || [];
  window.dataLayer.push({
    'product.title': "Practical Statistics for Data Scientists",
    'product.type': "book",
    'product.identifier': "9781491952955",
    'content.identifier': "9781491952955/ch04.html",
    'content.publisher': "O'Reilly Media, Inc.",
    'content.free': "no",
    'content.subdirectory': "none",
    'content.subTopic': "none",
    'content.parentTopic': "none",
    'content.formatType': "book-chapter",
    'content.author': "Peter Bruce, Andrew Bruce",
    'content.releaseDate': "2017-05-18",
    'content.title': "4. Regression and Prediction",
  });
</script>



<script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/output.d1c80552da2d.js.download"></script>


<noscript> 
  <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z"
          height="0" width="0"
          style="display:none;visibility:hidden">
  </iframe>
</noscript>


<script async="" defer="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/pageview.js.download"></script>

<script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/jquery.min.js.download"></script>

<script>
  jQuery(document).ready(function($) {
    //Toggle isActive and mobileHidden classes for mobileNavButton
    $('nav #mobileNavButton').on('click', function() {
      var expanded = $(this).attr('aria-expanded') === 'true' || false;
      $(this).attr('aria-expanded', !expanded);
      $(this).toggleClass("isActive");
      $(this).next().toggleClass("mobileHidden");
    });

    //Toggle isFocused class for keyboard navigation of submenus
    $('nav #menuList .menuList-subItem a').each(function(navItem) {
      $(this).on('focus', function() {
        $(this).parent().parent().toggleClass('isFocused');
      });
      $(this).on('blur', function() {
        $(this).parent().parent().toggleClass('isFocused');
      });
    });

    //Toggle mobileHidden class accordian elements
    $('.mobileAccordian').each(function() {
      var $btn = $(this).find('button');
      var $target =  $(this).next();
      $btn.on('click', function() {
        var expanded = $btn.attr('aria-expanded') === 'true' || false;

        $btn.attr('aria-expanded', !expanded);
        $target.toggleClass("mobileHidden");
      });
    });


    //Hide title page's long description behind disclosure button
    var titleDescriptionExtra = $('.title-description p:first-of-type').nextAll(':nth-child(3)').nextAll();
    titleDescriptionExtra.wrapAll('<div id="titleDescriptionExtra" />');
    if (titleDescriptionExtra.length > 0) {
      $('#titleDescriptionExtra').toggle();
      $('#showMoreDescription').removeClass('hidden');
      $('#showMoreDescription button').on('click', function() {
        $(this).toggleClass('more');
        $('#titleDescriptionExtra').slideToggle();
      });
    }

    //Hide title page's long TOC behind disclosure button
    var titleTOCShort = $('.sbo-reader-title .detail-toc').find('li').slice(0,4);
    var titleTOCExtra = $('.sbo-reader-title .detail-toc').find('li').not(titleTOCShort);
    if (titleTOCExtra.length > 0) {
      titleTOCExtra.toggle();
      $('#showMoreTOC').removeClass('hidden');
      $('#showMoreTOC button').on('click', function() {
        $(this).toggleClass('more');
        titleTOCExtra.toggle();
      });
    }

    //Hide product information on page load
    $('#product-information').toggle();
    $('#title-tabs button').on('click', function() {
      var $thisTab = $(this);
      if (!$thisTab.hasClass('title-tab-active')) {
        var lastTabTarget = $('#title-tabs .title-tab-active').removeClass('title-tab-active').attr('data-target');
        $('#' + lastTabTarget).toggle();

        $thisTab.addClass('title-tab-active');
        var $tabTarget = $(this).attr('data-target');
        $('#' + $tabTarget).toggle();
      }
    });

  });

</script>



<!-- MARC Intercept Support -->

<script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/thiss.js.download"></script>

<script src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/output.8bff54f150f1.js.download"></script><div id="academic-modal"><!-- react-empty: 1 --></div>




<div class="annotator-notice"></div>
<script type="text/javascript" id="">(function(){function b(){!1===c&&(c=!0,Munchkin.init("107-FMS-070"))}var c=!1,a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="//munchkin.marketo.net/munchkin.js";a.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||b()};a.onload=b;document.getElementsByTagName("head")[0].appendChild(a)})();</script><script type="text/javascript" id="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/digitalpi-utm-tracker-oreilly.com.js.download"></script><script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","1732687426968531");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1732687426968531&amp;ev=PageView&amp;noscript=1"></noscript><script type="text/javascript" id="">(function(){window.medalliaUserIdentifier=document.documentElement.dataset.userUuid;window.medalliaUserName=document.documentElement.dataset.username})();</script>
<script type="text/javascript" id="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/embed.js.download"></script>
<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","443792972845831");fbq("set","agent","tmgoogletagmanager","443792972845831");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=443792972845831&amp;ev=PageView&amp;noscript=1"></noscript>

<script type="text/javascript" id="">!function(b,e,f,g,a,c,d){b.fbq||(a=b.fbq=function(){a.callMethod?a.callMethod.apply(a,arguments):a.queue.push(arguments)},b._fbq||(b._fbq=a),a.push=a,a.loaded=!0,a.version="2.0",a.queue=[],c=e.createElement(f),c.async=!0,c.src=g,d=e.getElementsByTagName(f)[0],d.parentNode.insertBefore(c,d))}(window,document,"script","https://connect.facebook.net/en_US/fbevents.js");fbq("init","443792972845831");fbq("track","PageView");</script>
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=443792972845831&amp;ev=PageView&amp;noscript=1"></noscript>
<script type="text/javascript" id="">var domains_to_track,docHost=document.location.hostname;
if("conferences.oreilly.com"==docHost.toLowerCase()||"ai.oreilly.com.cn"==docHost.toLowerCase()){domains_to_track=["conference.oreilly.com"];var folders_to_track=google_tag_manager["GTM-5P4V6Z"].macro(12).split("/")[1]}else if("shop.oreilly.com"==docHost.toLowerCase())domains_to_track=["shop.oreilly.com"],folders_to_track=google_tag_manager["GTM-5P4V6Z"].macro(13).split("/")[1];else if("oreilly.com"==docHost.toLowerCase()||"www.oreilly.com"==docHost.toLowerCase())domains_to_track=["www.oreilly.com"],folders_to_track="";
var extDoc=".doc .docx .xls .xlsx .xlsm .ppt .pptx .exe .zip .pdf .js .txt .csv".split(" "),socSites="",isSubDomainTracker=!0,isSeparateDomainTracker=!0,isGTM=!0,eValues={downloads:{category:"Assets",action:"Download",label:"",value:0,nonInteraction:0},outbound_downloads:{category:"Outbound Assets",action:"Download",label:"",value:0,nonInteraction:0},outbounds_oreilly:{category:"Outbound Links",action:"Oreilly",label:"",value:0,nonInteraction:0},outbounds:{category:"Outbound Links",action:"Non-Oreilly",
label:"",value:0,nonInteraction:0},email:{category:"Email Clicks",action:"Click",label:"",value:0,nonInteraction:0},outbound_email:{category:"Outbound Email Clicks",action:"Click",label:"",value:0,nonInteraction:0},telephone:{category:"Telephone Clicks",action:"Click",label:"",value:0,nonInteraction:0},social:{category:"Social Profiles",action:"Click",label:"",value:0,nonInteraction:0}},mainDomain=document.location.hostname.match(/(([^.\/]+\.[^.\/]{2,3}\.[^.\/]{2})|(([^.\/]+\.)[^.\/]{2,4}))(\/.*)?$/)[1];
mainDomain=mainDomain.toLowerCase();1==isSubDomainTracker&&(mainDomain=document.location.hostname.replace("www.","").toLowerCase());var arr=document.getElementsByTagName("a");
for(i=0;i<arr.length;i++){var flag=0;if(!isExcluded(arr[i])){var mDownAtt=arr[i].getAttribute("onmousedown"),doname="",linkType="",mailPattern=/^mailto:[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/i,urlPattern=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/i,telPattern=/^tel:(.*)([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/i,internalDomain=/(.*)(oreilly.com|safaribooksonline.com)(.*)/i;if(mailPattern.test(arr[i].href)||urlPattern.test(arr[i].href)||telPattern.test(arr[i].href)){try{!urlPattern.test(arr[i].href)||
mailPattern.test(arr[i].href)||telPattern.test(arr[i].href)?!mailPattern.test(arr[i].href)||telPattern.test(arr[i].href)||urlPattern.test(arr[i].href)?!telPattern.test(arr[i].href)||urlPattern.test(arr[i].href)||mailPattern.test(arr[i].href)||(doname=arr[i].href.toLowerCase(),linkType="tel"):(doname=arr[i].href.toLowerCase().split("@")[1],linkType="mail"):(doname=arr[i].hostname.toLowerCase().replace("www.",""),linkType="url")}catch(a){continue}if(null!=mDownAtt&&(mDownAtt=String(mDownAtt),-1<mDownAtt.indexOf("dataLayer.push")||
-1<mDownAtt.indexOf("('send'")))continue;var condition=!1;if(condition=isSeparateDomainTracker?doname==mainDomain:-1!=doname.indexOf(mainDomain))"mail"===linkType?(eValues.email.label=arr[i].href.toLowerCase().match(/[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/i),_tagLinks(arr[i],eValues.email.category,eValues.email.action,eValues.email.label,eValues.email.value,eValues.email.nonInteraction,mDownAtt)):"url"===linkType&&(""==folders_to_track||_isInternalFolder(arr[i].href)?_isDownload(arr[i].href)&&
(_setDownloadData(arr[i].href,doname),_tagLinks(arr[i],eValues.downloads.category,eValues.downloads.action,eValues.downloads.label,eValues.downloads.value,eValues.downloads.nonInteraction,mDownAtt)):_isDownload(arr[i].href)?(_setDownloadData(arr[i].href,doname),_tagLinks(arr[i],eValues.outbound_downloads.category,eValues.outbound_downloads.action,eValues.outbound_downloads.label,eValues.outbound_downloads.value,eValues.outbound_downloads.nonInteraction,mDownAtt)):internalDomain.test(arr[i].href)?
(eValues.outbounds_oreilly.label=arr[i].href.replace("www.","").split("//")[1],_tagLinks(arr[i],eValues.outbounds_oreilly.category,eValues.outbounds_oreilly.action,eValues.outbounds_oreilly.label,eValues.outbounds_oreilly.value,eValues.outbounds_oreilly.nonInteraction,mDownAtt)):(eValues.outbounds.label=arr[i].href.toLowerCase().replace("www.","").split("//")[1],_tagLinks(arr[i],eValues.outbounds.category,eValues.outbounds.action,eValues.outbounds.label,eValues.outbounds.value,eValues.outbounds.nonInteraction,
mDownAtt)));else for(var k=0;k<domains_to_track.length;k++){var condition1=!1;condition1=isSeparateDomainTracker?doname==domains_to_track[k]:-1!=doname.indexOf(domains_to_track[k]);condition1?"mail"===linkType?(eValues.email.label=arr[i].href.toLowerCase().match(/[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/i),_tagLinks(arr[i],eValues.email.category,eValues.email.action,eValues.email.label,eValues.email.value,eValues.email.nonInteraction,mDownAtt)):"url"===linkType&&(""==folders_to_track||_isInternalFolder(arr[i].href)?
_isDownload(arr[i].href)&&(_setDownloadData(arr[i].href,doname),_tagLinks(arr[i],eValues.downloads.category,eValues.downloads.action,eValues.downloads.label,eValues.downloads.value,eValues.downloads.nonInteraction,mDownAtt)):_isDownload(arr[i].href)?(_setDownloadData(arr[i].href,doname),_tagLinks(arr[i],eValues.outbound_downloads.category,eValues.outbound_downloads.action,eValues.outbound_downloads.label,eValues.outbound_downloads.value,eValues.outbound_downloads.nonInteraction,mDownAtt)):internalDomain.test(arr[i].href)?
(eValues.outbounds_oreilly.label=arr[i].href.replace("www.","").split("//")[1],_tagLinks(arr[i],eValues.outbounds_oreilly.category,eValues.outbounds_oreilly.action,eValues.outbounds_oreilly.label,eValues.outbounds_oreilly.value,eValues.outbounds_oreilly.nonInteraction,mDownAtt)):(eValues.outbounds.label=arr[i].href.replace("www.","").split("//")[1],_tagLinks(arr[i],eValues.outbounds.category,eValues.outbounds.action,eValues.outbounds.label,eValues.outbounds.value,eValues.outbounds.nonInteraction,
mDownAtt))):(flag++,flag==domains_to_track.length&&("mail"===linkType&&(eValues.outbound_email.label=arr[i].href.toLowerCase().match(/[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}/),_tagLinks(arr[i],eValues.outbound_email.category,eValues.outbound_email.action,eValues.outbound_email.label,eValues.outbound_email.value,eValues.outbound_email.nonInteraction,mDownAtt)),"tel"===linkType&&(eValues.telephone.label=arr[i].href.toLowerCase().split("tel:")[1],_tagLinks(arr[i],eValues.telephone.category,eValues.telephone.action,
eValues.telephone.label,eValues.telephone.value,eValues.telephone.nonInteraction,mDownAtt)),"url"===linkType&&(_isDownload(arr[i].href)?(_setDownloadData(arr[i].href,doname),_tagLinks(arr[i],eValues.outbound_downloads.category,eValues.outbound_downloads.action,eValues.outbound_downloads.label,eValues.outbound_downloads.value,eValues.outbound_downloads.nonInteraction,mDownAtt)):_isSocial(arr[i].href)?(eValues.social.label=arr[i].href.toLowerCase().replace("www.","").split("//")[1],eValues.social.action=
eValues.social.label.split(".")[0],_tagLinks(arr[i],eValues.social.category,eValues.social.action,eValues.social.label,eValues.social.value,eValues.social.nonInteraction,mDownAtt)):internalDomain.test(arr[i].href)?(eValues.outbounds_oreilly.label=arr[i].href.replace("www.","").split("//")[1],_tagLinks(arr[i],eValues.outbounds_oreilly.category,eValues.outbounds_oreilly.action,eValues.outbounds_oreilly.label,eValues.outbounds_oreilly.value,eValues.outbounds_oreilly.nonInteraction,mDownAtt)):(eValues.outbounds.label=
arr[i].href.toLowerCase().replace("www.","").split("//")[1],_tagLinks(arr[i],eValues.outbounds.category,eValues.outbounds.action,eValues.outbounds.label,eValues.outbounds.value,eValues.outbounds.nonInteraction,mDownAtt)))))}}}}function _isSocial(a){return""!=socSites?null!=a.toLowerCase().replace(/[+#]/,"").match(new RegExp("^(.*)("+socSites.toLowerCase()+")(.*)$"))?!0:!1:!1}
function _isInternalFolder(a){return""!=folders_to_track?null!=a.toLowerCase().match(new RegExp("^(.*)("+folders_to_track+")(.*)$"))?!0:!1:!1}function _isDownload(a){for(var c=0,b=0;b<extDoc.length;b++){var d=a.split(".");d=d[d.length-1].split(/[#?&?]/);if("."+d[0].toLowerCase()==extDoc[b])return!0;c++;if(c==extDoc.length)return!1}}
function _setDownloadData(a,c){var b=a.toLowerCase().split(".");b=b[b.length-1].split(/[#?&?]/);a=a.toLowerCase().split(c);a=a[1].split(/[#?&?]/);eValues.downloads.action=eValues.outbound_downloads.action=b;eValues.downloads.label=eValues.outbound_downloads.label=a}
function _tagLinks(a,c,b,d,g,e,f){isGTM?a.setAttribute("onmousedown",(null!=f?f+"; ":"")+"dataLayer.push({'event': 'eventTracker', 'eventCat': '"+c+"', 'eventAct':'"+b+"', 'eventLbl': '"+d+"', 'eventVal': "+g+", 'nonInteraction': "+e+"});"):(e=0==e?!1:!0,a.setAttribute("onmousedown",(null!=f?f+"; ":"")+"ga('send', 'event', '"+c+"', '"+b+"', '"+d+"', "+g+", { nonInteraction: "+e+"});"))}
function isExcluded(a){var c=document.getElementsByTagName("footer")[0];1<document.getElementsByTagName("footer").length&&(c=document.getElementsByTagName("footer")[document.getElementsByTagName("footer").length-1]);for(var b=a.parentNode;null!=b;){if(b==c)return!0;b=b.parentNode}c=/(.*)(conferences.oreilly.com|www.safaribooksonline.com|learning.oreilly.com|shop.oreilly.com)(.*)/i;b=/((.*)oreilly.com\/(learning|radar|idea)(.*))/i;return c.test(a.href)&&b.test(document.location.href)&&jQuery&&(jQuery(a).parents(".article-body").length||
jQuery(a).parents(".block-product").length||jQuery(this).closest("[data-type \x3d 'note']").length)?!0:!1};</script><div style="display: none; visibility: hidden;"><script>(function(){if(null!==document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]')&&void 0!==document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]')){var a=!1;window.addEventListener("blur",function(){a&&dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"facebook",eventVal:0,nonInteraction:0})});document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]').addEventListener("mouseover",function(){window.focus();
a=!0});document.querySelector('iframe[title\x3d"fb:share_button Facebook Social Plugin"]').addEventListener("mouseout",function(){a=!1})}if(null!==document.querySelector("iframe.twitter-share-button")&&void 0!==document.querySelector("iframe.twitter-share-button")){var b=!1;window.addEventListener("blur",function(){b&&dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"twitter",eventVal:0,nonInteraction:0})});document.querySelector("iframe.twitter-share-button").addEventListener("mouseover",
function(){window.focus();b=!0});document.querySelector("iframe.twitter-share-button").addEventListener("mouseout",function(){b=!1})}try{window.twttr=function(a,b,d){var c,e=a.getElementsByTagName(b)[0];if(!a.getElementById(d))return a=a.createElement(b),a.id=d,a.src="//platform.twitter.com/widgets.js",e.parentNode.insertBefore(a,e),window.twttr||(c={_e:[],ready:function(a){c._e.push(a)}})}(document,"script","twitter-wjs"),twttr.ready(function(a){a.events.bind("tweet",trackTwitter)})}catch(c){}})();
null!==document.querySelector(".IN-widget")&&void 0!==document.querySelector(".IN-widget")&&document.querySelector(".IN-widget").addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"linkedin",eventVal:0,nonInteraction:0})});
function trackTwitter(a){a&&(a.target&&"IFRAME"==a.target.nodeName&&(opt_target=extractParamFromUri(a.target.src,"url")),dataLayer.push({event:"eventTracker",eventCat:"social",eventAct:"share",eventLbl:"twitter",eventVal:0,nonInteraction:0}))}function extractParamFromUri(a,b){if(a&&(b=new RegExp("[\\?\x26#]"+b+"\x3d([^\x26#]*)"),a=b.exec(a),null!=a))return unescape(a[1])};</script></div><script type="text/javascript" id="">function forceInputUppercase(a){var b=a.target.selectionStart,c=a.target.selectionEnd;a.target.value=a.target.value.toUpperCase();a.target.setSelectionRange(b,c)}void 0!=document.getElementById("id_promotion")&&null!=document.getElementById("id_promotion")&&document.getElementById("id_promotion").addEventListener("keyup",forceInputUppercase,!1);
void 0!=document.getElementsByName("promotionCode")[0]&&null!=document.getElementsByName("promotionCode")[0]&&document.getElementsByName("promotionCode")[0].addEventListener("keyup",forceInputUppercase,!1);</script><script type="text/javascript" id="">var nonwExpandable=document.querySelectorAll(".orm-ff-NavigationSubnav-headerListItem a, .orm-ff-NavigationView-headerListItem a");nonwExpandable.forEach(function(a,b){b+1!=nonwExpandable.length?a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.childNodes[1].textContent})}):b+1==nonwExpandable.length&&a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"user login",eventAct:"logout",eventLbl:"global nav | unified"})})});
var nonwExpandableFo=document.querySelectorAll(".drop-content li:not(.flyout-parent) a");
nonwExpandableFo.forEach(function(a,b){"drop-content"==a.parentNode.parentNode.parentNode.className&&b+1!=nonwExpandableFo.length?a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.childNodes[1].textContent})}):"drop-content"==a.parentNode.parentNode.parentNode.className&&b+1==nonwExpandableFo.length&&a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"user login",eventAct:"logout",eventLbl:"global nav | unified"})})});
var expandable=document.querySelectorAll(".orm-ff-NavigationSubnav-toggleControls a, .orm-ff-NavigationView-toggleControls a");expandable.forEach(function(a){a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.parentNode.parentNode.parentNode.querySelectorAll(".orm-Button-btnContentWrap span")[0].childNodes[1].textContent+" | "+a.textContent})})});var flyoutLinks=document.querySelectorAll(".flyout a");
flyoutLinks.forEach(function(a){a.addEventListener("click",function(){dataLayer.push({event:"eventTracker",eventCat:"global nav",eventAct:"navigation",eventLbl:a.closest("li.flyout-parent").getElementsByTagName("a")[0].textContent+" | "+a.textContent})})});</script><iframe src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/pixel.html" style="display: none;"></iframe><div style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.35330676889205437"><img style="width:0px; height:0px; display:none; visibility:hidden;" id="batBeacon0.8015913356870488" width="0" height="0" alt="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/0"></div><script type="text/javascript" async="" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/generic1593731586534.js.download" charset="UTF-8"></script><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./4. Regression and Prediction - Practical Statistics for Data Scientists [Book]_files/widget_iframe.c4b33f07650267db9f8a72eaac551cac.html" title="Twitter settings iframe" style="display: none;"></iframe><span></span></body></html>